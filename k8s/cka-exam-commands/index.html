
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A personal blog by Amarjit Singh Dhillon">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-8.2.7">
    
    
      
        <title>CKA exam commands - Amar Dhillon's Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cka-exam-commands" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Amar Dhillon&#39;s Blog" class="md-header__button md-logo" aria-label="Amar Dhillon's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amar Dhillon's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CKA exam commands
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69z"/></svg>
            </label>
          
        
      </form>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../sys_design/concepts/consistentHashing/" class="md-tabs__link">
        System design
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../technical_stuff/linux/linuxCommands/" class="md-tabs__link">
        Linux
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../aws/concepts/" class="md-tabs__link">
        AWS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../azure/concepts/" class="md-tabs__link">
        Azure
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../commands/" class="md-tabs__link md-tabs__link--active">
        Kubernetes
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../technical_stuff/databricks/databricks_basics/" class="md-tabs__link">
        Technical Stuff
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../AI/intro_to_stat/" class="md-tabs__link">
        AI/ML
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        About me
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Amar Dhillon&#39;s Blog" class="md-nav__button md-logo" aria-label="Amar Dhillon's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Amar Dhillon's Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          System design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="System design" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          System design
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Concepts" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/consistentHashing/" class="md-nav__link">
        Consistent Hashing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/dataPartitioning/" class="md-nav__link">
        Data Partitioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/graphql/" class="md-nav__link">
        GraphQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/microservices/" class="md-nav__link">
        Micro Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/jwt/" class="md-nav__link">
        JWT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/websockets/" class="md-nav__link">
        Web Sockets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/webhook/" class="md-nav__link">
        WebHook
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/protobuf/" class="md-nav__link">
        Protobuf
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Design Patterns
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Design Patterns" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Design Patterns
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/bff/" class="md-nav__link">
        BFF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/cdn/" class="md-nav__link">
        CDN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/choreography/" class="md-nav__link">
        Choreography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/cqrs/" class="md-nav__link">
        CQRS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/materializedView/" class="md-nav__link">
        Materialized View
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/priority_queue/" class="md-nav__link">
        Priority Queue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/saga/" class="md-nav__link">
        Saga
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/serviceRegistry/" class="md-nav__link">
        Service Registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/durableFunctions/" class="md-nav__link">
        Durable functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/sidecar/" class="md-nav__link">
        Sidecar
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/linux/linuxCommands/" class="md-nav__link">
        Commands 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/grepContent/" class="md-nav__link">
        Grep content
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/updatePaths/" class="md-nav__link">
        Update Paths
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          AWS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="AWS" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          AWS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/concepts/" class="md-nav__link">
        Basic Concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Auth
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Auth" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Auth
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/api_gw/" class="md-nav__link">
        API Gateway 🌉
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Compute
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compute" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Compute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/athnea/" class="md-nav__link">
        Athnea
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/appsync/" class="md-nav__link">
        App Sync ♻️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/ec2/" class="md-nav__link">
        EC2 🖥
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/eks/" class="md-nav__link">
        EKS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/lambda/" class="md-nav__link">
        Lambda ⨐
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/stepfunctions/" class="md-nav__link">
        Step Functions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Infrastructure
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Infrastructure" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Infrastructure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/iam/" class="md-nav__link">
        IAM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_5">
          Caching
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Caching" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Caching
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/cloudfront/" class="md-nav__link">
        CloudFront 🌧
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/elasticache/" class="md-nav__link">
        Elasti Cache
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_6" type="checkbox" id="__nav_4_6" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_6">
          Database
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Database" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Database
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/dynamo/" class="md-nav__link">
        Dynamo DB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/rds/" class="md-nav__link">
        RDS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_7" type="checkbox" id="__nav_4_7" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_7">
          ETL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ETL" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_7">
          <span class="md-nav__icon md-icon"></span>
          ETL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/glue/" class="md-nav__link">
        Glue
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_8" type="checkbox" id="__nav_4_8" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_8">
          Storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Storage" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_8">
          <span class="md-nav__icon md-icon"></span>
          Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/glacier/" class="md-nav__link">
        Glacier 🗻
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/ebs/" class="md-nav__link">
        EBS ▣
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/efs/" class="md-nav__link">
        EFS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/s3/" class="md-nav__link">
        S3 🪣
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/snowball/" class="md-nav__link">
        Snow Ball ❄️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/storagegw/" class="md-nav__link">
        Storage Gateway ⻔
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9" type="checkbox" id="__nav_4_9" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_9">
          Network
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Network" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_9">
          <span class="md-nav__icon md-icon"></span>
          Network
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/subnet/" class="md-nav__link">
        101 Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/acl/" class="md-nav__link">
        ACL ⛔️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/elasticip/" class="md-nav__link">
        Elastic IP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/eni/" class="md-nav__link">
        ENI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/lb/" class="md-nav__link">
        Load Balancers ⚖️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/natgw/" class="md-nav__link">
        NAT GW
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/natinstance/" class="md-nav__link">
        NAT Instance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/route53/" class="md-nav__link">
        Route 53 🛣
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/sg/" class="md-nav__link">
        Security Group 🔐
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/vpc/" class="md-nav__link">
        VPC
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_10">
          Monitoring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Monitoring" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          Monitoring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/cloudwatch/" class="md-nav__link">
        Cloud Watch ⏱
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/cloudwatch/" class="md-nav__link">
        Cloud Trail
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_11">
          Misc Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Misc Services" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          Misc Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/macie/" class="md-nav__link">
        Macie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/orgs/" class="md-nav__link">
        Orgs 🏛
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_12">
          Supporting Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Supporting Services" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Supporting Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/autoScaling/" class="md-nav__link">
        Auto Scaling 📏
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/sqs/" class="md-nav__link">
        SQS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_13">
          NFRs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="NFRs" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          NFRs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/failover/" class="md-nav__link">
        Failover
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/readReplica/" class="md-nav__link">
        Read Replics
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          Azure
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Azure" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Azure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/concepts/" class="md-nav__link">
        Az Concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/az_commands/" class="md-nav__link">
        Az Commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_3">
          Compute
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compute" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Compute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/appservice/" class="md-nav__link">
        App Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/serviceFabric/" class="md-nav__link">
        Service Fabric
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/azvm/" class="md-nav__link">
        VM 🖥
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/aci/" class="md-nav__link">
        ACI 🗳
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/aks/" class="md-nav__link">
        AKS ⎈
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4" type="checkbox" id="__nav_5_4" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_4">
          ETL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ETL" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          ETL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/adf/" class="md-nav__link">
        Data Factory 🏭
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5" type="checkbox" id="__nav_5_5" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_5">
          Event based
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Event based" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_5">
          <span class="md-nav__icon md-icon"></span>
          Event based
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/event_hub/" class="md-nav__link">
        Event Hub ☄️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/event_grid/" class="md-nav__link">
        Event Grid ⛭
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/service_bus/" class="md-nav__link">
        Service Bus 🚌️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/grid-hub-bus/" class="md-nav__link">
        Service Bus vs Event Grid/Hub️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/azure_function/" class="md-nav__link">
        Function ⚡️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/logicApp/" class="md-nav__link">
        Logic App 🪄
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_6" type="checkbox" id="__nav_5_6" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_6">
          Misc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Misc" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_6">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/devopsatt.md" class="md-nav__link">
        Devops
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/az-monitor/" class="md-nav__link">
        Monitor 🔭
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/office365/" class="md-nav__link">
        Office 365 📝
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/arm/" class="md-nav__link">
        ARM 🦾
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_7" type="checkbox" id="__nav_5_7" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_7">
          Load Balancer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Load Balancer" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_7">
          <span class="md-nav__icon md-icon"></span>
          Load Balancer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/app-gw/" class="md-nav__link">
        App Gateway (L7)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/azlb/" class="md-nav__link">
        Load Balancer (L4) ⚖️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/front-door/" class="md-nav__link">
        Front Door 🚪
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/atm/" class="md-nav__link">
        Traffic Manager 🚦
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_8" type="checkbox" id="__nav_5_8" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_8">
          Network
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Network" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_8">
          <span class="md-nav__icon md-icon"></span>
          Network
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/api_gateway/" class="md-nav__link">
        APIM Gateway ⾨
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/dns/" class="md-nav__link">
        DNS ☎️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/networkingInfra/" class="md-nav__link">
        Networking Infrastructure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/vpn_gw/" class="md-nav__link">
        VPN Gateway
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/vnet/" class="md-nav__link">
        VNet 🕸
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_9" type="checkbox" id="__nav_5_9" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_9">
          Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Security" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_9">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/aad/" class="md-nav__link">
        Active Directory 🔐
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/keyVault/" class="md-nav__link">
        Key Vault 🔑
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/waf/" class="md-nav__link">
        WAF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/entra/" class="md-nav__link">
        Entra
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_10" type="checkbox" id="__nav_5_10" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_10">
          Storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Storage" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_10">
          <span class="md-nav__icon md-icon"></span>
          Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/storage/" class="md-nav__link">
        Storage Account 🗄
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/acr/" class="md-nav__link">
        Container Registry 📖
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/snowflake/" class="md-nav__link">
        Snowflake ❄️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/blob/" class="md-nav__link">
        Blob
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/adsl/" class="md-nav__link">
        ADLS-Gen2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6">
          Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kubernetes" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../commands/" class="md-nav__link">
        Commands
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          CKA exam commands
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        CKA exam commands
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scheduling" class="md-nav__link">
    Scheduling
  </a>
  
    <nav class="md-nav" aria-label="Scheduling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#node-affinity" class="md-nav__link">
    Node Affinity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-scheduling" class="md-nav__link">
    Manual Scheduling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labels-and-selectors" class="md-nav__link">
    Labels and Selectors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#taints-and-tolerations" class="md-nav__link">
    Taints and Tolerations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-limits" class="md-nav__link">
    Resource Limits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deamonsets" class="md-nav__link">
    DeamonSets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-pods" class="md-nav__link">
    Static Pods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-and-monitoring" class="md-nav__link">
    Logging and Monitoring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appilcation-lifecycle-maintainance" class="md-nav__link">
    Appilcation Lifecycle Maintainance
  </a>
  
    <nav class="md-nav" aria-label="Appilcation Lifecycle Maintainance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#env-variables" class="md-nav__link">
    Env variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secrets" class="md-nav__link">
    Secrets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-container-pods" class="md-nav__link">
    Multi container pods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#init-containers" class="md-nav__link">
    Init Containers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-maintainance" class="md-nav__link">
    Cluster Maintainance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    Security
  </a>
  
    <nav class="md-nav" aria-label="Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#view-cert-details" class="md-nav__link">
    View Cert Details
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubeconfig" class="md-nav__link">
    Kubeconfig
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rbac" class="md-nav__link">
    RBAC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-accounts" class="md-nav__link">
    Service Accounts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image-security" class="md-nav__link">
    Image Security
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-contexts" class="md-nav__link">
    Security Contexts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-policies" class="md-nav__link">
    Network Policies
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage" class="md-nav__link">
    Storage
  </a>
  
    <nav class="md-nav" aria-label="Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pv-and-pvc" class="md-nav__link">
    PV and PVC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-class" class="md-nav__link">
    Storage Class
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#networking" class="md-nav__link">
    Networking
  </a>
  
    <nav class="md-nav" aria-label="Networking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cni" class="md-nav__link">
    CNI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubeadm" class="md-nav__link">
    Kubeadm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lightning-lab" class="md-nav__link">
    Lightning Lab
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mock-exam" class="md-nav__link">
    Mock Exam
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arch/docker/" class="md-nav__link">
        Docker 🐳
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_4" type="checkbox" id="__nav_6_4" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_4">
          Architecture
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Architecture" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          Architecture
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arch/apiserver/" class="md-nav__link">
        API Server 💻
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arch/arch/" class="md-nav__link">
        Cluster Architecutre
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arch/kubelet/" class="md-nav__link">
        Kubelet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arch/kubeproxy/" class="md-nav__link">
        Kube Proxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arch/scheduler/" class="md-nav__link">
        Scheduler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_5" type="checkbox" id="__nav_6_5" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_5">
          Admin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Admin" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_5">
          <span class="md-nav__icon md-icon"></span>
          Admin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../admin/scheduler/" class="md-nav__link">
        Scheduler ⚙️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../admin/monitoring/" class="md-nav__link">
        Monitoring 📈
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../admin/networking/" class="md-nav__link">
        Networking 🕸️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../admin/security/" class="md-nav__link">
        Security 🔐
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../admin/storage/" class="md-nav__link">
        Storage 📦
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_6" type="checkbox" id="__nav_6_6" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_6">
          Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Resources" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_6">
          <span class="md-nav__icon md-icon"></span>
          Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arch/controllermgr/" class="md-nav__link">
        Controller Manager 👮‍♀️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deployment_python/" class="md-nav__link">
        Deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ds/" class="md-nav__link">
        DeamonSet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arch/etcd/" class="md-nav__link">
        ETCD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ingress/" class="md-nav__link">
        Ingress
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rc/" class="md-nav__link">
        Replication Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ns/" class="md-nav__link">
        Namespace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../node-affinity/" class="md-nav__link">
        Node Affinity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pod/" class="md-nav__link">
        Pod
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../svc/" class="md-nav__link">
        Service
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_7" type="checkbox" id="__nav_6_7" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_7">
          Demo's
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Demo's" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_7">
          <span class="md-nav__icon md-icon"></span>
          Demo's
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../poc_minikube/" class="md-nav__link">
        Demo app in Minikube
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7">
          Technical Stuff
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Technical Stuff" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Technical Stuff
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Databricks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Databricks" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Databricks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/databricks/databricks_basics/" class="md-nav__link">
        Databricks 101 🧱
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/databricks/hive/" class="md-nav__link">
        Hive 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/databricks/ManipulatingTableswithDeltaLakeLab/" class="md-nav__link">
        Table Manipulation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2" type="checkbox" id="__nav_7_2" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_2">
          Data/Analytics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data/Analytics" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Data/Analytics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/sql_and_nosql/" class="md-nav__link">
        DB, DW and Data Lake 💾
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/snowflake/" class="md-nav__link">
        Snowflake ❄️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/powerbi/" class="md-nav__link">
        Power BI 📈
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" >
      
      
      
        
          
        
          
        
          
        
          
            
          
        
          
        
          
        
          
            
          
        
          
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../technical_stuff/maven/downgrade_maven/">Misc</a>
          
            <label for="__nav_7_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Misc" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/linux/android_device/" class="md-nav__link">
        Attach Android device 🤖
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/blogs/cpanel/gitAndCpanel/" class="md-nav__link">
        Cpanel settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/databricks/ManipulatingTableswithDeltaLakeLab/" class="md-nav__link">
        Delta Lake 🐟
      </a>
    </li>
  

            
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/installing_flink/flink/" class="md-nav__link">
        Flink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/wso2/h2/wso2/" class="md-nav__link">
        H2 Db in WSO2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/linux/java_home/" class="md-nav__link">
        Java home ☕️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/mysql/JdbcStatements/" class="md-nav__link">
        JDBC Statements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/wso2/jms/" class="md-nav__link">
        JMS Queue in WSO2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/mysql/mysql_basics/" class="md-nav__link">
        Mysql 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/wget/wget/" class="md-nav__link">
        Wget
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_4" type="checkbox" id="__nav_7_4" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4">
          Cloud Migration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cloud Migration" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_4">
          <span class="md-nav__icon md-icon"></span>
          Cloud Migration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/cloud_migration/6rs/" class="md-nav__link">
        6 R's
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8">
          AI/ML
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="AI/ML" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          AI/ML
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1" type="checkbox" id="__nav_8_1" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8_1">
          Basics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_1">
          <span class="md-nav__icon md-icon"></span>
          Basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/intro_to_stat/" class="md-nav__link">
        STAT 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/ai_basics/" class="md-nav__link">
        AI 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/mlops101/" class="md-nav__link">
        MLOps 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/feature_store/" class="md-nav__link">
        Feature Store
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_2" type="checkbox" id="__nav_8_2" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8_2">
          Azure
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Azure" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_2">
          <span class="md-nav__icon md-icon"></span>
          Azure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/azureml/" class="md-nav__link">
        Azure ML
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9">
          About me
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About me" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          About me
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        About me
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scheduling" class="md-nav__link">
    Scheduling
  </a>
  
    <nav class="md-nav" aria-label="Scheduling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#node-affinity" class="md-nav__link">
    Node Affinity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-scheduling" class="md-nav__link">
    Manual Scheduling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labels-and-selectors" class="md-nav__link">
    Labels and Selectors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#taints-and-tolerations" class="md-nav__link">
    Taints and Tolerations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-limits" class="md-nav__link">
    Resource Limits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deamonsets" class="md-nav__link">
    DeamonSets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-pods" class="md-nav__link">
    Static Pods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-and-monitoring" class="md-nav__link">
    Logging and Monitoring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appilcation-lifecycle-maintainance" class="md-nav__link">
    Appilcation Lifecycle Maintainance
  </a>
  
    <nav class="md-nav" aria-label="Appilcation Lifecycle Maintainance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#env-variables" class="md-nav__link">
    Env variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secrets" class="md-nav__link">
    Secrets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-container-pods" class="md-nav__link">
    Multi container pods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#init-containers" class="md-nav__link">
    Init Containers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-maintainance" class="md-nav__link">
    Cluster Maintainance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    Security
  </a>
  
    <nav class="md-nav" aria-label="Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#view-cert-details" class="md-nav__link">
    View Cert Details
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubeconfig" class="md-nav__link">
    Kubeconfig
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rbac" class="md-nav__link">
    RBAC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-accounts" class="md-nav__link">
    Service Accounts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image-security" class="md-nav__link">
    Image Security
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-contexts" class="md-nav__link">
    Security Contexts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-policies" class="md-nav__link">
    Network Policies
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage" class="md-nav__link">
    Storage
  </a>
  
    <nav class="md-nav" aria-label="Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pv-and-pvc" class="md-nav__link">
    PV and PVC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-class" class="md-nav__link">
    Storage Class
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#networking" class="md-nav__link">
    Networking
  </a>
  
    <nav class="md-nav" aria-label="Networking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cni" class="md-nav__link">
    CNI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubeadm" class="md-nav__link">
    Kubeadm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lightning-lab" class="md-nav__link">
    Lightning Lab
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mock-exam" class="md-nav__link">
    Mock Exam
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="cka-exam-commands">CKA Exam Commands<a class="headerlink" href="#cka-exam-commands" title="Permanent link">&para;</a></h1>
<h2 id="basics">Basics<a class="headerlink" href="#basics" title="Permanent link">&para;</a></h2>
<details class="info">
<summary>Create pod in finance namespace</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>run<span class="w"> </span>redis<span class="w"> </span>--image<span class="o">=</span>redis<span class="w"> </span>-n<span class="w"> </span>finance
</code></pre></div>
</details>
<hr />
<details class="quesiton">
<summary>Create a service and expose it on port 6379</summary>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-service</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app.kubernetes.io/name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MyApp</span>
<span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6379</span>
<span class="w">    </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6379</span>
</code></pre></div>
</details>
<hr />
<details class="remember">
<summary>Create a deployment named webapp using the image kodekloud/webapp-color with 3 replicas</summary>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webapp</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">    </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kodekloud/webapp-color</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">ports</span><span class="p p-Indicator">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Create a new pod called custom-nginx using the nginx image and expose it on container port 8080</summary>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom-nginx</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">ports</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
</code></pre></div>
<hr />
<p>Create a new namespace called dev-ns.</p>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>create<span class="w"> </span>ns<span class="w"> </span>dev-ns
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Create a pod called httpd using the image httpd:alpine in the default namespace. Next, create a service of type ClusterIP by the same name (httpd). The target port for the service should be 80</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>run<span class="w"> </span>httpd<span class="w"> </span>--image<span class="o">=</span>httpd:alpine<span class="w"> </span>--port<span class="o">=</span><span class="m">80</span><span class="w"> </span>--expose

service/httpd<span class="w"> </span>created
pod/httpd<span class="w"> </span>created
</code></pre></div>
</details>
<h2 id="scheduling">Scheduling<a class="headerlink" href="#scheduling" title="Permanent link">&para;</a></h2>
<h3 id="node-affinity">Node Affinity<a class="headerlink" href="#node-affinity" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># apply label</span>
k<span class="w"> </span>label<span class="w"> </span>nodes<span class="w"> </span>node01<span class="w"> </span><span class="nv">color</span><span class="o">=</span>blue

<span class="c1"># create a deployment </span>
k<span class="w"> </span>create<span class="w"> </span>deployment<span class="w"> </span>blue<span class="w"> </span>--replicas<span class="o">=</span><span class="m">3</span><span class="w"> </span>--image<span class="o">=</span>nginx

<span class="c1"># check the taints on the node</span>
kubectl<span class="w"> </span>describe<span class="w"> </span>node<span class="w"> </span>controlplane<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>taints<span class="w"> </span>
</code></pre></div>
<hr />
<details class="info">
<summary>Create a new deployment named red with the nginx image and 2 replicas, and ensure it gets placed on the controlplane node only. Use the label key <code>node-role.kubernetes.io/control-plane</code> which is already set on the controlplane node.</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># use the exists operator as shown below</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">    </span><span class="nt">affinity</span><span class="p">:</span>
<span class="w">        </span><span class="nt">nodeAffinity</span><span class="p">:</span>
<span class="w">        </span><span class="nt">requiredDuringSchedulingIgnoredDuringExecution</span><span class="p">:</span>
<span class="w">            </span><span class="nt">nodeSelectorTerms</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">matchExpressions</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">node-role.kubernetes.io/control-plane</span>
<span class="w">                </span><span class="l l-Scalar l-Scalar-Plain">operator</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exists</span>
</code></pre></div>
</details>
<h3 id="manual-scheduling">Manual Scheduling<a class="headerlink" href="#manual-scheduling" title="Permanent link">&para;</a></h3>
<details class="quesiton">
<summary>Manually schedule the pod on node01</summary>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">nodeName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">node01</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
</code></pre></div>
</details>
<h3 id="labels-and-selectors">Labels and Selectors<a class="headerlink" href="#labels-and-selectors" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># count the number of pods with env=dev label</span>
k<span class="w"> </span>get<span class="w"> </span>po<span class="w"> </span>-l<span class="w"> </span><span class="nv">env</span><span class="o">=</span>dev<span class="w"> </span>--show-labels<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc

<span class="c1"># Identify the POD which is part of the prod environment, the finance BU and of frontend tier?</span>
k<span class="w"> </span>get<span class="w"> </span>pod<span class="w">  </span>--selector<span class="w"> </span><span class="nv">env</span><span class="o">=</span>prod,bu<span class="o">=</span>finance,tier<span class="o">=</span>frontend<span class="w">  </span>--show-labels
</code></pre></div>
<h3 id="taints-and-tolerations">Taints and Tolerations<a class="headerlink" href="#taints-and-tolerations" title="Permanent link">&para;</a></h3>
<p>Node affinity is a property of Pods that attracts them to a set of nodes (either as a preference or a hard requirement). Taints are the opposite -- they allow a node to repel a set of pods.</p>
<p>Tolerations are applied to pods. Tolerations allow the scheduler to schedule pods with matching taints. Tolerations allow scheduling but don't guarantee scheduling: the scheduler also evaluates other parameters as part of its function.</p>
<p>Taints and tolerations work together to ensure that pods are not scheduled onto inappropriate nodes. One or more taints are applied to a node; this marks that the node should not accept any pods that do not tolerate the taints.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># You add a taint to a node using kubectl taint. For example,</span>
<span class="l l-Scalar l-Scalar-Plain">kubectl taint nodes node1 key1=value1:NoSchedule</span>


<span class="l l-Scalar l-Scalar-Plain"># To remove the taint added by the command above, you can run</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">kubectl taint nodes node1 key1=value1:NoSchedule-</span>

<span class="c1"># Specify a toleration for a pod in the PodSpec.</span>
<span class="nt">tolerations</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;key1&quot;</span>
<span class="w">  </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Equal&quot;</span>
<span class="w">  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value1&quot;</span>
<span class="w">  </span><span class="nt">effect</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NoSchedule&quot;</span>


<span class="nt">tolerations</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;key1&quot;</span>
<span class="w">  </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Exists&quot;</span>
<span class="w">  </span><span class="nt">effect</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NoSchedule&quot;</span>

<span class="c1"># Here&#39;s an example of a pod that uses tolerations:</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
<span class="w">  </span><span class="nt">tolerations</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-key&quot;</span>
<span class="w">    </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Exists&quot;</span>
<span class="w">    </span><span class="nt">effect</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NoSchedule&quot;</span>
</code></pre></div>
<hr />
<details class="info">
<summary>Check taints on the nodes</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>describe<span class="w">  </span>nodes<span class="w">  </span>node01<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>taint<span class="w"> </span><span class="c1"># use describe instead of get</span>
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Create a taint on node01 with key of spray, value of mortein and effect of NoSchedule</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>taint<span class="w"> </span>node<span class="w"> </span>node01<span class="w"> </span><span class="nv">spray</span><span class="o">=</span>mortain:NoSchedule
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>Create another pod named bee with the nginx image, which has a toleration set to the taint mortein.</summary>
<p>First do dry run using </p>
<p><code>k run bee --image=nginx --dry-run=client -o yaml &gt; test_pod.yaml</code></p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bee</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bee</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">tolerations</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;spray&quot;</span>
<span class="w">    </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Equal&quot;</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mortein&quot;</span>
<span class="w">    </span><span class="nt">effect</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NoSchedule&quot;</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bee</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterFirst</span>
<span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
</details>
<h3 id="resource-limits">Resource Limits<a class="headerlink" href="#resource-limits" title="Permanent link">&para;</a></h3>
<p>If the node where a Pod is running has enough of a resource available, it's possible (and allowed) for a container to use more resource than its request for that resource specifies. However, a container is not allowed to use more than its resource limit.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># replace the pod using the replace command</span>
k<span class="w"> </span>replace<span class="w"> </span>--force<span class="w">  </span>-f<span class="w"> </span>/tmp/kubectl-edit-2304618812.yaml

pod<span class="w"> </span><span class="s2">&quot;elephant&quot;</span><span class="w"> </span>deleted
pod/elephant<span class="w"> </span>replaced
</code></pre></div>
<h3 id="deamonsets">DeamonSets<a class="headerlink" href="#deamonsets" title="Permanent link">&para;</a></h3>
<p>A DaemonSet ensures that all (or some) Nodes run a copy of a Pod. As nodes are added to the cluster, Pods are added to them. As nodes are removed from the cluster, those Pods are garbage collected. Deleting a DaemonSet will clean up the Pods it created.</p>
<p>Some typical uses of a DaemonSet are:</p>
<div class="codehilite"><pre><span></span><code>running a cluster storage daemon on every node
running a logs collection daemon on every node
running a node monitoring daemon on every node
</code></pre></div>

<details class="question">
<summary>On how many nodes are the pods scheduled by the DaemonSet kube-proxy?</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span>describe<span class="w"> </span>ds<span class="w"> </span>kube-proxy<span class="w">  </span><span class="c1"># check the pod status</span>
</code></pre></div>
</details>
<p>Deploy a DaemonSet for FluentD Logging with Name: elasticsearch, Namespace: kube-system and Image: registry.k8s.io/fluentd-elasticsearch:1.20</p>
<div class="admonition remember">
<p class="admonition-title">How to create a DS ?</p>
<p>An easy way to create a DaemonSet is to first generate a YAML file for a Deployment with the command <code>kubectl create deployment elasticsearch --image=registry.k8s.io/fluentd-elasticsearch:1.20 -n kube-system --dry-run=client -o yaml &gt; fluentd.yaml</code>. Next, remove the replicas, strategy and status fields from the YAML file using a text editor. Also, change the kind from Deployment to DaemonSet. Finally, create the Daemonset by running <code>kubectl create -f fluentd.yaml</code></p>
</div>
<h3 id="static-pods">Static Pods<a class="headerlink" href="#static-pods" title="Permanent link">&para;</a></h3>
<details class="question">
<summary>How many static pods exist in this cluster in all namespaces?</summary>
<p>Run the command <code>kubectl get pods --all-namespaces</code> and look for those with <code>-controlplane</code> appended in the name</p>
</details>
<hr />
<details class="note">
<summary>What is the path of the directory holding the static pod definition files?</summary>
<p><code>/etc/kubernetes/manifests/</code></p>
</details>
<details class="qeestion">
<summary>Create a static pod named static-busybox that uses the busybox image and the command sleep 1000</summary>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>run<span class="w"> </span>--restart<span class="o">=</span>Never<span class="w"> </span>--image<span class="o">=</span>busybox<span class="w"> </span>static-busybox<span class="w"> </span>--dry-run<span class="o">=</span>client<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>--command<span class="w"> </span>--<span class="w"> </span>sleep<span class="w"> </span><span class="m">1000</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/kubernetes/manifests/static-busybox.yaml
</code></pre></div>
</details>
<details class="important">
<summary>The path need not be /etc/kubernetes/manifests. Make sure to check the path configured in the kubelet configuration file.</summary>
<div class="highlight"><pre><span></span><code>root@controlplane:~#<span class="w"> </span>ssh<span class="w"> </span>node01<span class="w"> </span>
root@node01:~#<span class="w"> </span>ps<span class="w"> </span>-ef<span class="w"> </span><span class="p">|</span><span class="w">  </span>grep<span class="w"> </span>/usr/bin/kubelet<span class="w"> </span>
root<span class="w">        </span><span class="m">4147</span><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">14</span>:05<span class="w"> </span>?<span class="w">        </span><span class="m">00</span>:00:00<span class="w"> </span>/usr/bin/kubelet<span class="w"> </span>--bootstrap-kubeconfig<span class="o">=</span>/etc/kubernetes/bootstrap-kubelet.conf<span class="w"> </span>--kubeconfig<span class="o">=</span>/etc/kubernetes/kubelet.conf<span class="w"> </span>--config<span class="o">=</span>/var/lib/kubelet/config.yaml<span class="w"> </span>--container-runtime-endpoint<span class="o">=</span>unix:///var/run/containerd/containerd.sock<span class="w"> </span>--pod-infra-container-image<span class="o">=</span>registry.k8s.io/pause:3.9
root<span class="w">        </span><span class="m">4773</span><span class="w">    </span><span class="m">4733</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">14</span>:05<span class="w"> </span>pts/0<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>grep<span class="w"> </span>/usr/bin/kubelet

root@node01:~#<span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>staticpod<span class="w"> </span>/var/lib/kubelet/config.yaml
staticPodPath:<span class="w"> </span>/etc/just-to-mess-with-you
</code></pre></div>
</details>
<h2 id="logging-and-monitoring">Logging and Monitoring<a class="headerlink" href="#logging-and-monitoring" title="Permanent link">&para;</a></h2>
<details class="info">
<summary>Identify the POD that consumes the most Memory(bytes) in default namespace.</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>top<span class="w"> </span>pod
NAME<span class="w">       </span>CPU<span class="o">(</span>cores<span class="o">)</span><span class="w">   </span>MEMORY<span class="o">(</span>bytes<span class="o">)</span><span class="w">   </span>
elephant<span class="w">   </span>19m<span class="w">          </span>32Mi<span class="w">            </span>
lion<span class="w">       </span>1m<span class="w">           </span>18Mi<span class="w">            </span>
rabbit<span class="w">     </span>129m<span class="w">         </span>252Mi<span class="w">    </span>
</code></pre></div>
</details>
<hr />
<h2 id="appilcation-lifecycle-maintainance">Appilcation Lifecycle Maintainance<a class="headerlink" href="#appilcation-lifecycle-maintainance" title="Permanent link">&para;</a></h2>
<details class="info">
<summary>What command is run at container startup?</summary>
<div class="highlight"><pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="s">python:3.6-alpine</span>

<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>flask

<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/opt/

<span class="k">EXPOSE</span><span class="w"> </span><span class="s">8080</span>

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/opt</span>

<span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;app.py&quot;</span><span class="p">]</span>
</code></pre></div>
<p>Ans is <code>app.py</code></p>
<hr />
<div class="highlight"><pre><span></span><code><span class="c"># Another question</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">python:3.6-alpine</span>

<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>flask

<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/opt/

<span class="k">EXPOSE</span><span class="w"> </span><span class="s">8080</span>

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/opt</span>

<span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;app.py&quot;</span><span class="p">]</span>

<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;--color&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;red&quot;</span><span class="p">]</span>
</code></pre></div>
<p>Ans is <code>python app.py --color red</code></p>
<hr />
<div class="highlight"><pre><span></span><code><span class="c1"># Question 3</span>

<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span><span class="w"> </span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span><span class="w"> </span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webapp-green</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webapp-green</span><span class="w"> </span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">simple-webapp</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kodekloud/webapp-color</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;--color&quot;</span><span class="p p-Indicator">,</span><span class="s">&quot;green&quot;</span><span class="p p-Indicator">]</span>

<span class="nn">---</span>

<span class="l l-Scalar l-Scalar-Plain">FROM python:3.6-alpine</span>

<span class="l l-Scalar l-Scalar-Plain">RUN pip install flask</span>

<span class="l l-Scalar l-Scalar-Plain">COPY . /opt/</span>

<span class="l l-Scalar l-Scalar-Plain">EXPOSE 8080</span>

<span class="l l-Scalar l-Scalar-Plain">WORKDIR /opt</span>

<span class="l l-Scalar l-Scalar-Plain">ENTRYPOINT [&quot;python&quot;, &quot;app.py&quot;]</span>

<span class="l l-Scalar l-Scalar-Plain">CMD [&quot;--color&quot;, &quot;red&quot;]</span><span class="w">    </span>
</code></pre></div>
<p>Ans is <code>--color green</code></p>
</details>
<hr />
<details class="info">
<summary>What command is run at container startup? Assume the image was created from the Dockerfile in this directory</summary>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">FROM python:3.6-alpine</span>

<span class="l l-Scalar l-Scalar-Plain">RUN pip install flask</span>

<span class="l l-Scalar l-Scalar-Plain">COPY . /opt/</span>

<span class="l l-Scalar l-Scalar-Plain">EXPOSE 8080</span>

<span class="l l-Scalar l-Scalar-Plain">WORKDIR /opt</span>

<span class="l l-Scalar l-Scalar-Plain">ENTRYPOINT [&quot;python&quot;, &quot;app.py&quot;]</span>

<span class="l l-Scalar l-Scalar-Plain">CMD [&quot;--color&quot;, &quot;red&quot;]</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span><span class="w"> </span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span><span class="w"> </span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webapp-green</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webapp-green</span><span class="w"> </span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">simple-webapp</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kodekloud/webapp-color</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;python&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app.py&quot;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;--color&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;pink&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>Ans is <code>python app.py --color pink</code></p>
</details>
<hr />
<details class="question">
<summary>#Create a pod with the given specifications. By default it displays a blue background. Set the given command line arguments to change it to green. <code>Command line arguments: --color=green</code></summary>
<div class="highlight"><pre><span></span><code>apiVersion:<span class="w"> </span>v1
kind:<span class="w"> </span>Pod
metadata:
creationTimestamp:<span class="w"> </span>null
labels:
<span class="w">    </span>run:<span class="w"> </span>webapp-green
name:<span class="w"> </span>webapp-green
spec:
containers:
-<span class="w"> </span>image:<span class="w"> </span>kodekloud/webapp-color
<span class="w">    </span>args:<span class="w"> </span><span class="o">[</span><span class="s2">&quot;--color&quot;</span>,<span class="s2">&quot;green&quot;</span><span class="o">]</span>
<span class="w">    </span>name:<span class="w"> </span>webapp-green
<span class="w">    </span>resources:<span class="w"> </span><span class="o">{}</span>
dnsPolicy:<span class="w"> </span>ClusterFirst
restartPolicy:<span class="w"> </span>Always
status:<span class="w"> </span><span class="o">{}</span>
</code></pre></div>
</details>
<h3 id="env-variables">Env variables<a class="headerlink" href="#env-variables" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># create a cm with 2 params as shown below</span>
k<span class="w"> </span>create<span class="w"> </span>cm<span class="w"> </span>webapp-config-map<span class="w"> </span>--from-literal<span class="w"> </span><span class="nv">APP_COLOR</span><span class="o">=</span>darkblue<span class="w">  </span>--from-literal<span class="w"> </span><span class="nv">APP_OTHER</span><span class="o">=</span>disregard

<span class="c1"># Update the environment variable on the POD to use only the APP_COLOR key from the newly created ConfigMap. </span>
apiVersion:<span class="w"> </span>v1
kind:<span class="w"> </span>Pod
metadata:
<span class="w">  </span>labels:
<span class="w">    </span>name:<span class="w"> </span>webapp-color
<span class="w">  </span>name:<span class="w"> </span>webapp-color
<span class="w">  </span>namespace:<span class="w"> </span>default
spec:
<span class="w">  </span>containers:
<span class="w">    </span>-<span class="w"> </span>name:<span class="w"> </span>webapp-color
<span class="w">      </span>image:<span class="w"> </span>kodekloud/webapp-color
<span class="w">      </span>env:
<span class="w">      </span>-<span class="w"> </span>name:<span class="w"> </span>APP_COLOR
<span class="w">        </span>valueFrom:
<span class="w">          </span>configMapKeyRef:
<span class="w">            </span>name:<span class="w"> </span>webapp-config-map
<span class="w">            </span>key:<span class="w"> </span>APP_COLOR
</code></pre></div>
<h3 id="secrets">Secrets<a class="headerlink" href="#secrets" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># The reason the application is failed is because we have not created the secrets yet. Create a new secret named db-secret with the data given below.</span>
k<span class="w"> </span>create<span class="w"> </span>secret<span class="w"> </span>generic<span class="w"> </span>db-secret<span class="w"> </span>--from-literal<span class="w"> </span><span class="nv">DB_Host</span><span class="o">=</span>sql01<span class="w"> </span>--from-literal<span class="w"> </span><span class="nv">DB_User</span><span class="o">=</span>root<span class="w"> </span>--from-literal<span class="w"> </span><span class="nv">DB_Password</span><span class="o">=</span>password123
</code></pre></div>
<details class="info">
<summary>Configure webapp-pod to load environment variables from the newly created secret.</summary>
<div class="highlight"><pre><span></span><code>apiVersion:<span class="w"> </span>v1
kind:<span class="w"> </span>Pod
metadata:
creationTimestamp:<span class="w"> </span><span class="s2">&quot;2023-11-19T06:03:03Z&quot;</span>
labels:
<span class="w">    </span>name:<span class="w"> </span>webapp-pod
name:<span class="w"> </span>webapp-pod
namespace:<span class="w"> </span>default
spec:
containers:
-<span class="w"> </span>image:<span class="w"> </span>kodekloud/simple-webapp-mysql
<span class="w">    </span>imagePullPolicy:<span class="w"> </span>Always
<span class="w">    </span>name:<span class="w"> </span>webapp
<span class="w">    </span>envFrom:
<span class="w">    </span>-<span class="w"> </span>secretRef:
<span class="w">        </span>name:<span class="w"> </span>db-secret
</code></pre></div>
</details>
<h3 id="multi-container-pods">Multi container pods<a class="headerlink" href="#multi-container-pods" title="Permanent link">&para;</a></h3>
<details class="question">
<summary>Create a multi-container pod with 2 containers</summary>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yellow</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yellow</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lemon</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gold</span>
<span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterFirst</span>
<span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
</details>
<h2 id="init-containers">Init Containers<a class="headerlink" href="#init-containers" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Sample</span>
apiVersion:<span class="w"> </span>v1
kind:<span class="w"> </span>Pod
metadata:
<span class="w">  </span>name:<span class="w"> </span>myapp-pod
<span class="w">  </span>labels:
<span class="w">    </span>app.kubernetes.io/name:<span class="w"> </span>MyApp
spec:
<span class="w">  </span>containers:
<span class="w">  </span>-<span class="w"> </span>name:<span class="w"> </span>myapp-container
<span class="w">    </span>image:<span class="w"> </span>busybox:1.28
<span class="w">    </span>command:<span class="w"> </span><span class="o">[</span><span class="s1">&#39;sh&#39;</span>,<span class="w"> </span><span class="s1">&#39;-c&#39;</span>,<span class="w"> </span><span class="s1">&#39;echo The app is running! &amp;&amp; sleep 3600&#39;</span><span class="o">]</span>
<span class="w">  </span>initContainers:
<span class="w">  </span>-<span class="w"> </span>name:<span class="w"> </span>init-myservice
<span class="w">    </span>image:<span class="w"> </span>busybox:1.28
<span class="w">    </span>command:<span class="w"> </span><span class="o">[</span><span class="s1">&#39;sh&#39;</span>,<span class="w"> </span><span class="s1">&#39;-c&#39;</span>,<span class="w"> </span><span class="s2">&quot;until nslookup myservice.</span><span class="k">$(</span>cat<span class="w"> </span>/var/run/secrets/kubernetes.io/serviceaccount/namespace<span class="k">)</span><span class="s2">.svc.cluster.local; do echo waiting for myservice; sleep 2; done&quot;</span><span class="o">]</span>
<span class="w">  </span>-<span class="w"> </span>name:<span class="w"> </span>init-mydb
<span class="w">    </span>image:<span class="w"> </span>busybox:1.28
<span class="w">    </span>command:<span class="w"> </span><span class="o">[</span><span class="s1">&#39;sh&#39;</span>,<span class="w"> </span><span class="s1">&#39;-c&#39;</span>,<span class="w"> </span><span class="s2">&quot;until nslookup mydb.</span><span class="k">$(</span>cat<span class="w"> </span>/var/run/secrets/kubernetes.io/serviceaccount/namespace<span class="k">)</span><span class="s2">.svc.cluster.local; do echo waiting for mydb; sleep 2; done&quot;</span><span class="o">]</span>
</code></pre></div>
<h2 id="cluster-maintainance">Cluster Maintainance<a class="headerlink" href="#cluster-maintainance" title="Permanent link">&para;</a></h2>
<details class="quesiton">
<summary>We need to take node01 out for maintenance. Empty the node of all applications and mark it unschedulable.</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>drain<span class="w"> </span>node01<span class="w"> </span>--ignore-daemonsets<span class="w"> </span>

node/node01<span class="w"> </span>cordoned
Warning:<span class="w"> </span>ignoring<span class="w"> </span>DaemonSet-managed<span class="w"> </span>Pods:<span class="w"> </span>kube-flannel/kube-flannel-ds-f5ttj,<span class="w"> </span>kube-system/kube-proxy-vg6wp
evicting<span class="w"> </span>pod<span class="w"> </span>default/blue-6b478c8dbf-vrh86
evicting<span class="w"> </span>pod<span class="w"> </span>default/blue-6b478c8dbf-j7g8d
pod/blue-6b478c8dbf-j7g8d<span class="w"> </span>evicted
pod/blue-6b478c8dbf-vrh86<span class="w"> </span>evicted
node/node01<span class="w"> </span>drained
</code></pre></div>
</details>
<hr />
<details class="warning">
<summary>drain error due to no controller</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>drain<span class="w"> </span>node01<span class="w"> </span>--ignore-daemonsets<span class="w"> </span>
node/node01<span class="w"> </span>cordoned
error:<span class="w"> </span>unable<span class="w"> </span>to<span class="w"> </span>drain<span class="w"> </span>node<span class="w"> </span><span class="s2">&quot;node01&quot;</span><span class="w"> </span>due<span class="w"> </span>to<span class="w"> </span>error:cannot<span class="w"> </span>delete<span class="w"> </span>Pods<span class="w"> </span><span class="nb">declare</span><span class="w"> </span>no<span class="w"> </span>controller<span class="w"> </span><span class="o">(</span>use<span class="w"> </span>--force<span class="w"> </span>to<span class="w"> </span>override<span class="o">)</span>:<span class="w"> </span>default/hr-app,<span class="w"> </span>continuing<span class="w"> </span>command...
There<span class="w"> </span>are<span class="w"> </span>pending<span class="w"> </span>nodes<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>drained:
node01
cannot<span class="w"> </span>delete<span class="w"> </span>Pods<span class="w"> </span><span class="nb">declare</span><span class="w"> </span>no<span class="w"> </span>controller<span class="w"> </span><span class="o">(</span>use<span class="w"> </span>--force<span class="w"> </span>to<span class="w"> </span>override<span class="o">)</span>:<span class="w"> </span>default/hr-app
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>What is the current version of the cluster?</summary>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>and<span class="w"> </span>look<span class="w"> </span>at<span class="w"> </span>the<span class="w"> </span>VERSION
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>What is the latest stable version of Kubernetes as of today?</summary>
<div class="highlight"><pre><span></span><code>kubeadm<span class="w"> </span>upgrade<span class="w"> </span>plan
<span class="o">[</span>upgrade/config<span class="o">]</span><span class="w"> </span>Making<span class="w"> </span>sure<span class="w"> </span>the<span class="w"> </span>configuration<span class="w"> </span>is<span class="w"> </span>correct:
<span class="o">[</span>upgrade/config<span class="o">]</span><span class="w"> </span>Reading<span class="w"> </span>configuration<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>cluster...
<span class="o">[</span>upgrade/config<span class="o">]</span><span class="w"> </span>FYI:<span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>look<span class="w"> </span>at<span class="w"> </span>this<span class="w"> </span>config<span class="w"> </span>file<span class="w"> </span>with<span class="w"> </span><span class="s1">&#39;kubectl -n kube-system get cm kubeadm-config -o yaml&#39;</span>
<span class="o">[</span>preflight<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span>pre-flight<span class="w"> </span>checks.
<span class="o">[</span>upgrade<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span>cluster<span class="w"> </span>health<span class="w"> </span>checks
<span class="o">[</span>upgrade<span class="o">]</span><span class="w"> </span>Fetching<span class="w"> </span>available<span class="w"> </span>versions<span class="w"> </span>to<span class="w"> </span>upgrade<span class="w"> </span>to
<span class="o">[</span>upgrade/versions<span class="o">]</span><span class="w"> </span>Cluster<span class="w"> </span>version:<span class="w"> </span>v1.26.0
<span class="o">[</span>upgrade/versions<span class="o">]</span><span class="w"> </span>kubeadm<span class="w"> </span>version:<span class="w"> </span>v1.26.0
I1119<span class="w"> </span><span class="m">12</span>:04:28.812883<span class="w">   </span><span class="m">18925</span><span class="w"> </span>version.go:256<span class="o">]</span><span class="w"> </span>remote<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span>much<span class="w"> </span>newer:<span class="w"> </span>v1.28.4<span class="p">;</span><span class="w"> </span>falling<span class="w"> </span>back<span class="w"> </span>to:<span class="w"> </span>stable-1.26
<span class="o">[</span>upgrade/versions<span class="o">]</span><span class="w"> </span>Target<span class="w"> </span>version:<span class="w"> </span>v1.26.11
<span class="o">[</span>upgrade/versions<span class="o">]</span><span class="w"> </span>Latest<span class="w"> </span>version<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>v1.26<span class="w"> </span>series:<span class="w"> </span>v1.26.11

Components<span class="w"> </span>that<span class="w"> </span>must<span class="w"> </span>be<span class="w"> </span>upgraded<span class="w"> </span>manually<span class="w"> </span>after<span class="w"> </span>you<span class="w"> </span>have<span class="w"> </span>upgraded<span class="w"> </span>the<span class="w"> </span>control<span class="w"> </span>plane<span class="w"> </span>with<span class="w"> </span><span class="s1">&#39;kubeadm upgrade apply&#39;</span>:
COMPONENT<span class="w">   </span>CURRENT<span class="w">       </span>TARGET
kubelet<span class="w">     </span><span class="m">2</span><span class="w"> </span>x<span class="w"> </span>v1.26.0<span class="w">   </span>v1.26.11

Upgrade<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>latest<span class="w"> </span>version<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>v1.26<span class="w"> </span>series:

COMPONENT<span class="w">                 </span>CURRENT<span class="w">   </span>TARGET
kube-apiserver<span class="w">            </span>v1.26.0<span class="w">   </span>v1.26.11
kube-controller-manager<span class="w">   </span>v1.26.0<span class="w">   </span>v1.26.11
kube-scheduler<span class="w">            </span>v1.26.0<span class="w">   </span>v1.26.11
kube-proxy<span class="w">                </span>v1.26.0<span class="w">   </span>v1.26.11
CoreDNS<span class="w">                   </span>v1.9.3<span class="w">    </span>v1.9.3
etcd<span class="w">                      </span><span class="m">3</span>.5.6-0<span class="w">   </span><span class="m">3</span>.5.6-0
</code></pre></div>
<p>its <code>v1.28.4</code> as shown above</p>
</details>
<hr />
<details class="info">
<summary>Upgrade the controlplane components to exact version v1.27.0</summary>
<p>Upgrade the kubeadm tool (if not already), then the controlplane components, and finally the kubelet. Practice referring to the Kubernetes documentation page.</p>
<p>Note: While upgrading kubelet, if you hit dependency issues while running the apt-get upgrade kubelet command, use the <code>apt install kubelet=1.27</code>.0-00 command instead.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># On the node01 node, run the following commands:</span>
<span class="c1"># If you are on the controlplane node</span>
ssh<span class="w"> </span>node01<span class="w"> </span><span class="c1"># to log in to the node01.</span>
<span class="c1"># This will update the package lists from the software repository.</span>

apt-get<span class="w"> </span>update

<span class="c1">#  This will install the kubeadm version 1.27.0.</span>

apt-get<span class="w"> </span>install<span class="w"> </span><span class="nv">kubeadm</span><span class="o">=</span><span class="m">1</span>.27.0-00

<span class="c1">#  This will upgrade the node01 configuration.</span>

kubeadm<span class="w"> </span>upgrade<span class="w"> </span>node

<span class="c1">#  This will update the kubelet with the version 1.27.0.</span>

apt-get<span class="w"> </span>install<span class="w"> </span><span class="nv">kubelet</span><span class="o">=</span><span class="m">1</span>.27.0-00<span class="w"> </span>

<span class="c1">#  You may need to reload the daemon and restart the kubelet service after it has been upgraded.</span>

systemctl<span class="w"> </span>daemon-reload
systemctl<span class="w"> </span>restart<span class="w"> </span>kubelet
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>At what address can you reach the ETCD cluster from the controlplane node? </summary>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">k -n kube-system describe po etcd-controlplane</span><span class="w"> </span>
<span class="l l-Scalar l-Scalar-Plain">Name</span><span class="p p-Indicator">:</span><span class="w">                 </span><span class="l l-Scalar l-Scalar-Plain">etcd-controlplane</span>
<span class="nt">Namespace</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">kube-system</span>
<span class="nt">Priority</span><span class="p">:</span><span class="w">             </span><span class="l l-Scalar l-Scalar-Plain">2000001000</span>
<span class="nt">Priority Class Name</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">system-node-critical</span>
<span class="nt">Node</span><span class="p">:</span><span class="w">                 </span><span class="l l-Scalar l-Scalar-Plain">controlplane/192.25.158.9</span>
<span class="nt">Start Time</span><span class="p">:</span><span class="w">           </span><span class="l l-Scalar l-Scalar-Plain">Sun, 19 Nov 2023 12:39:56 -0500</span>
<span class="nt">Labels</span><span class="p">:</span><span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">component=etcd</span>
<span class="w">                    </span><span class="l l-Scalar l-Scalar-Plain">tier=control-plane</span>
<span class="nt">Annotations:          kubeadm.kubernetes.io/etcd.advertise-client-urls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://192.25.158.9:2379</span>
<span class="w">                    </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/config.hash</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">88719a0e6555d94fd96af8b6011a2af6</span>
<span class="w">                    </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/config.mirror</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">88719a0e6555d94fd96af8b6011a2af6</span>
<span class="w">                    </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/config.seen</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2023-11-19T12:39:38.200107235-05:00</span>
<span class="w">                    </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/config.source</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">file</span>
<span class="nt">Status</span><span class="p">:</span><span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">Running</span>
<span class="nt">SeccompProfile</span><span class="p">:</span><span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">RuntimeDefault</span>
<span class="nt">IP</span><span class="p">:</span><span class="w">                   </span><span class="l l-Scalar l-Scalar-Plain">192.25.158.9</span>
<span class="nt">IPs</span><span class="p">:</span>
<span class="nt">IP</span><span class="p">:</span><span class="w">           </span><span class="l l-Scalar l-Scalar-Plain">192.25.158.9</span>
<span class="nt">Controlled By</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">Node/controlplane</span>
<span class="nt">Containers</span><span class="p">:</span>
<span class="nt">etcd</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Container ID</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">containerd://f21102066ab677d48612ffc74802a43ae023daa92feeab805b0a80da2e53f495</span>
<span class="w">    </span><span class="nt">Image</span><span class="p">:</span><span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">registry.k8s.io/etcd:3.5.7-0</span>
<span class="w">    </span><span class="nt">Image ID</span><span class="p">:</span><span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">registry.k8s.io/etcd@sha256:51eae8381dcb1078289fa7b4f3df2630cdc18d09fb56f8e56b41c40e191d6c83</span>
<span class="w">    </span><span class="nt">Port</span><span class="p">:</span><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">&lt;none&gt;</span>
<span class="w">    </span><span class="nt">Host Port</span><span class="p">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">&lt;none&gt;</span>
<span class="w">    </span><span class="nt">Command</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">etcd</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--advertise-client-urls=https://192.25.158.9:2379</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--cert-file=/etc/kubernetes/pki/etcd/server.crt</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--client-cert-auth=true</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--data-dir=/var/lib/etcd</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--experimental-initial-corrupt-check=true</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--experimental-watch-progress-notify-interval=5s</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--initial-advertise-peer-urls=https://192.25.158.9:2380</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--initial-cluster=controlplane=https://192.25.158.9:2380</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--key-file=/etc/kubernetes/pki/etcd/server.key</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--listen-client-urls=https://127.0.0.1:2379,https://192.25.158.9:2379</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--listen-metrics-urls=http://127.0.0.1:2381</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--listen-peer-urls=https://192.25.158.9:2380</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--name=controlplane</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--peer-cert-file=/etc/kubernetes/pki/etcd/peer.crt</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--peer-client-cert-auth=true</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--peer-key-file=/etc/kubernetes/pki/etcd/peer.key</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--peer-trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--snapshot-count=10000</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--trusted-ca-file=/et</span>
</code></pre></div>
<p>check the <code>listen-client-urls</code> as shown above</p>
</details>
<hr />
<details class="question">
<summary>Backup the Etcd</summary>
<p>The master node in our cluster is planned for a regular maintenance reboot tonight. While we do not anticipate anything to go wrong, we are required to take the necessary backups. Take a snapshot of the ETCD database using the built-in snapshot functionality.</p>
<p>Store the backup file at location /opt/snapshot-pre-boot.db</p>
<div class="highlight"><pre><span></span><code><span class="nv">ETCDCTL_API</span><span class="o">=</span><span class="m">3</span><span class="w"> </span>etcdctl<span class="w"> </span>--endpoints<span class="o">=</span>https://<span class="o">[</span><span class="m">127</span>.0.0.1<span class="o">]</span>:2379<span class="w"> </span><span class="se">\</span>
--cacert<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt<span class="w"> </span><span class="se">\</span>
--cert<span class="o">=</span>/etc/kubernetes/pki/etcd/server.crt<span class="w"> </span><span class="se">\</span>
--key<span class="o">=</span>/etc/kubernetes/pki/etcd/server.key<span class="w"> </span><span class="se">\</span>
snapshot<span class="w"> </span>save<span class="w"> </span>/opt/snapshot-pre-boot.db
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>How many clusters are defined in the kubeconfig on the student-node?</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>config<span class="w"> </span>get-clusters<span class="w"> </span>

NAME
cluster2
cluster1
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>How to switch from one cluster to another?</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>config<span class="w"> </span>use-context<span class="w"> </span>cluster1
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#If you check out the pods running in the kube-system namespace in cluster1, you will notice that etcd is running as a pod:</span>

$<span class="w">  </span>kubectl<span class="w"> </span>config<span class="w"> </span>use-context<span class="w"> </span>cluster1
Switched<span class="w"> </span>to<span class="w"> </span>context<span class="w"> </span><span class="s2">&quot;cluster1&quot;</span>.

$<span class="w">  </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>etcd
etcd-cluster1-controlplane<span class="w">                      </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">              </span>9m26s


<span class="c1"># This means that ETCD is set up as a Stacked ETCD Topology where the distributed data storage cluster provided by etcd is stacked on top of the cluster formed by the nodes managed by kubeadm that run control plane components.</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Using the external etcd</span>

If<span class="w"> </span>you<span class="w"> </span>check<span class="w"> </span>out<span class="w"> </span>the<span class="w"> </span>pods<span class="w"> </span>running<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>kube-system<span class="w"> </span>namespace<span class="w"> </span><span class="k">in</span><span class="w"> </span>cluster2,<span class="w"> </span>you<span class="w"> </span>will<span class="w"> </span>notice<span class="w"> </span>that<span class="w"> </span>there<span class="w"> </span>are<span class="w"> </span>NO<span class="w"> </span>etcd<span class="w"> </span>pods<span class="w"> </span>running<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span>cluster!

student-node<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>kubectl<span class="w"> </span>config<span class="w"> </span>use-context<span class="w"> </span>cluster2
Switched<span class="w"> </span>to<span class="w"> </span>context<span class="w"> </span><span class="s2">&quot;cluster2&quot;</span>.

student-node<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w">  </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>etcd

student-node<span class="w"> </span>~<span class="w"> </span>✖<span class="w"> </span>

Also,<span class="w"> </span>there<span class="w"> </span>is<span class="w"> </span>NO<span class="w"> </span>static<span class="w"> </span>pod<span class="w"> </span>configuration<span class="w"> </span><span class="k">for</span><span class="w"> </span>etcd<span class="w"> </span>under<span class="w"> </span>the<span class="w"> </span>static<span class="w"> </span>pod<span class="w"> </span>path:

student-node<span class="w"> </span>~<span class="w"> </span>✖<span class="w"> </span>ssh<span class="w"> </span>cluster2-controlplane
Welcome<span class="w"> </span>to<span class="w"> </span>Ubuntu<span class="w"> </span><span class="m">18</span>.04.6<span class="w"> </span>LTS<span class="w"> </span><span class="o">(</span>GNU/Linux<span class="w"> </span><span class="m">5</span>.4.0-1086-gcp<span class="w"> </span>x86_64<span class="o">)</span>

*<span class="w"> </span>Documentation:<span class="w">  </span>https://help.ubuntu.com
*<span class="w"> </span>Management:<span class="w">     </span>https://landscape.canonical.com
*<span class="w"> </span>Support:<span class="w">        </span>https://ubuntu.com/advantage
This<span class="w"> </span>system<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>minimized<span class="w"> </span>by<span class="w"> </span>removing<span class="w"> </span>packages<span class="w"> </span>and<span class="w"> </span>content<span class="w"> </span>that<span class="w"> </span>are
not<span class="w"> </span>required<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>system<span class="w"> </span>that<span class="w"> </span>users<span class="w"> </span><span class="k">do</span><span class="w"> </span>not<span class="w"> </span>log<span class="w"> </span>into.

To<span class="w"> </span>restore<span class="w"> </span>this<span class="w"> </span>content,<span class="w"> </span>you<span class="w"> </span>can<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span><span class="s1">&#39;unminimize&#39;</span><span class="w"> </span>command.
Last<span class="w"> </span>login:<span class="w"> </span>Wed<span class="w"> </span>Aug<span class="w"> </span><span class="m">31</span><span class="w"> </span><span class="m">05</span>:05:04<span class="w"> </span><span class="m">2022</span><span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.1.127.14

cluster2-controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>ls<span class="w"> </span>/etc/kubernetes/manifests/<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>etcd

cluster2-controlplane<span class="w"> </span>~<span class="w"> </span>✖<span class="w"> </span>

However,<span class="w"> </span><span class="k">if</span><span class="w"> </span>you<span class="w"> </span>inspect<span class="w"> </span>the<span class="w"> </span>process<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>controlplane<span class="w"> </span><span class="k">for</span><span class="w"> </span>cluster2,<span class="w"> </span>you<span class="w"> </span>will<span class="w"> </span>see<span class="w"> </span>that<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>process<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>kube-apiserver<span class="w"> </span>is<span class="w"> </span>referencing<span class="w"> </span>an<span class="w"> </span>external<span class="w"> </span>etcd<span class="w"> </span>datastore:

cluster2-controlplane<span class="w"> </span>~<span class="w"> </span>✖<span class="w"> </span>ps<span class="w"> </span>-ef<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>etcd
root<span class="w">        </span><span class="m">1705</span><span class="w">    </span><span class="m">1320</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">05</span>:03<span class="w"> </span>?<span class="w">        </span><span class="m">00</span>:00:31<span class="w"> </span>kube-apiserver<span class="w"> </span>--advertise-address<span class="o">=</span><span class="m">10</span>.1.127.3<span class="w"> </span>--allow-privileged<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--authorization-mode<span class="o">=</span>Node,RBAC<span class="w"> </span>--client-ca-file<span class="o">=</span>/etc/kubernetes/pki/ca.crt<span class="w"> </span>--enable-admission-plugins<span class="o">=</span>NodeRestriction<span class="w"> </span>--enable-bootstrap-token-auth<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--etcd-cafile<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.pem<span class="w"> </span>--etcd-certfile<span class="o">=</span>/etc/kubernetes/pki/etcd/etcd.pem<span class="w"> </span>--etcd-keyfile<span class="o">=</span>/etc/kubernetes/pki/etcd/etcd-key.pem<span class="w"> </span>--etcd-servers<span class="o">=</span>https://10.1.127.10:2379<span class="w"> </span>--kubelet-client-certificate<span class="o">=</span>/etc/kubernetes/pki/apiserver-kubelet-client.crt<span class="w"> </span>--kubelet-client-key<span class="o">=</span>/etc/kubernetes/pki/apiserver-kubelet-client.key<span class="w"> </span>--kubelet-preferred-address-types<span class="o">=</span>InternalIP,ExternalIP,Hostname<span class="w"> </span>--proxy-client-cert-file<span class="o">=</span>/etc/kubernetes/pki/front-proxy-client.crt<span class="w"> </span>--proxy-client-key-file<span class="o">=</span>/etc/kubernetes/pki/front-proxy-client.key<span class="w"> </span>--requestheader-allowed-names<span class="o">=</span>front-proxy-client<span class="w"> </span>--requestheader-client-ca-file<span class="o">=</span>/etc/kubernetes/pki/front-proxy-ca.crt<span class="w"> </span>--requestheader-extra-headers-prefix<span class="o">=</span>X-Remote-Extra-<span class="w"> </span>--requestheader-group-headers<span class="o">=</span>X-Remote-Group<span class="w"> </span>--requestheader-username-headers<span class="o">=</span>X-Remote-User<span class="w"> </span>--secure-port<span class="o">=</span><span class="m">6443</span><span class="w"> </span>--service-account-issuer<span class="o">=</span>https://kubernetes.default.svc.cluster.local<span class="w"> </span>--service-account-key-file<span class="o">=</span>/etc/kubernetes/pki/sa.pub<span class="w"> </span>--service-account-signing-key-file<span class="o">=</span>/etc/kubernetes/pki/sa.key<span class="w"> </span>--service-cluster-ip-range<span class="o">=</span><span class="m">10</span>.96.0.0/12<span class="w"> </span>--tls-cert-file<span class="o">=</span>/etc/kubernetes/pki/apiserver.crt<span class="w"> </span>--tls-private-key-file<span class="o">=</span>/etc/kubernetes/pki/apiserver.key
root<span class="w">        </span><span class="m">5754</span><span class="w">    </span><span class="m">5601</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">05</span>:15<span class="w"> </span>pts/0<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>grep<span class="w"> </span>etcd

cluster2-controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>

<span class="c1"># You can see the same information by inspecting the kube-apiserver pod (which runs as a static pod in the kube-system namespace):</span>
</code></pre></div>
</details>
<hr />
<details class="warning">
<summary>What is the IP address of the External ETCD datastore used in cluster2?</summary>
<div class="highlight"><pre><span></span><code>ps<span class="w"> </span>-ef<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>etcd<span class="w"> </span><span class="c1"># after doing ssh to controlPlane</span>
root<span class="w">        </span><span class="m">1747</span><span class="w">    </span><span class="m">1383</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:07<span class="w"> </span>?<span class="w">        </span><span class="m">00</span>:05:56<span class="w"> </span>kube-apiserver<span class="w"> </span>--advertise-address<span class="o">=</span><span class="m">192</span>.28.229.12<span class="w"> </span>--allow-privileged<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--authorization-mode<span class="o">=</span>Node,RBAC<span class="w"> </span>--client-ca-file<span class="o">=</span>/etc/kubernetes/pki/ca.crt<span class="w"> </span>--enable-admission-plugins<span class="o">=</span>NodeRestriction<span class="w"> </span>--enable-bootstrap-token-auth<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--etcd-cafile<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.pem<span class="w"> </span>--etcd-certfile<span class="o">=</span>/etc/kubernetes/pki/etcd/etcd.pem<span class="w"> </span>--etcd-keyfile<span class="o">=</span>/etc/kubernetes/pki/etcd/etcd-key.pem<span class="w"> </span>--etcd-servers<span class="o">=</span>https://192.28.229.24:2379<span class="w"> </span>--kubelet-client-certificate<span class="o">=</span>/etc/kubernetes/pki/apiserver-kubelet-client.crt<span class="w"> </span>--kubelet-client-key<span class="o">=</span>/etc/kubernetes/pki/apiserver-kubelet-client.key<span class="w"> </span>--kubelet-preferred-address-types<span class="o">=</span>InternalIP,ExternalIP,Hostname<span class="w"> </span>--proxy-client-cert-file<span class="o">=</span>/etc/kubernetes/pki/front-proxy-client.crt<span class="w"> </span>--proxy-client-key-file<span class="o">=</span>/etc/kubernetes/pki/front-proxy-client.key<span class="w"> </span>--requestheader-allowed-names<span class="o">=</span>front-proxy-client<span class="w"> </span>--requestheader-client-ca-file<span class="o">=</span>/etc/kubernetes/pki/front-proxy-ca.crt<span class="w"> </span>--requestheader-extra-headers-prefix<span class="o">=</span>X-Remote-Extra-<span class="w"> </span>--requestheader-group-headers<span class="o">=</span>X-Remote-Group<span class="w"> </span>--requestheader-username-headers<span class="o">=</span>X-Remote-User<span class="w"> </span>--secure-port<span class="o">=</span><span class="m">6443</span><span class="w"> </span>--service-account-issuer<span class="o">=</span>https://kubernetes.default.svc.cluster.local<span class="w"> </span>--service-account-key-file<span class="o">=</span>/etc/kubernetes/pki/sa.pub<span class="w"> </span>--service-account-signing-key-file<span class="o">=</span>/etc/kubernetes/pki/sa.key<span class="w"> </span>--service-cluster-ip-range<span class="o">=</span><span class="m">10</span>.96.0.0/12<span class="w"> </span>--tls-cert-file<span class="o">=</span>/etc/kubernetes/pki/apiserver.crt<span class="w"> </span>--tls-private-key-file<span class="o">=</span>/etc/kubernetes/pki/apiserver.key
</code></pre></div>
<p>IP is <code>192.28.229.24</code></p>
</details>
<hr />
<details class="question">
<summary>What is the default data directory used the for ETCD datastore used in cluster1?</summary>
<div class="highlight"><pre><span></span><code>ps<span class="w"> </span>-ef<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>etcd
root<span class="w">        </span><span class="m">1867</span><span class="w">    </span><span class="m">1383</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:08<span class="w"> </span>?<span class="w">        </span><span class="m">00</span>:02:25<span class="w"> </span>etcd<span class="w"> </span>--advertise-client-urls<span class="o">=</span>https://192.28.229.9:2379<span class="w"> </span>--cert-file<span class="o">=</span>/etc/kubernetes/pki/etcd/server.crt<span class="w"> </span>--client-cert-auth<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--data-dir<span class="o">=</span>/var/lib/etcd<span class="w"> </span>--experimental-initial-corrupt-check<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--initial-advertise-peer-urls<span class="o">=</span>https://192.28.229.9:2380<span class="w"> </span>--initial-cluster<span class="o">=</span>cluster1-controlplane<span class="o">=</span>https://192.28.229.9:2380<span class="w"> </span>--key-file<span class="o">=</span>/etc/kubernetes/pki/etcd/server.key<span class="w"> </span>--listen-client-urls<span class="o">=</span>https://127.0.0.1:2379,https://192.28.229.9:2379<span class="w"> </span>--listen-metrics-urls<span class="o">=</span>http://127.0.0.1:2381<span class="w"> </span>--listen-peer-urls<span class="o">=</span>https://192.28.229.9:2380<span class="w"> </span>--name<span class="o">=</span>cluster1-controlplane<span class="w"> </span>--peer-cert-file<span class="o">=</span>/etc/kubernetes/pki/etcd/peer.crt<span class="w"> </span>--peer-client-cert-auth<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--peer-key-file<span class="o">=</span>/etc/kubernetes/pki/etcd/peer.key<span class="w"> </span>--peer-trusted-ca-file<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt<span class="w"> </span>--snapshot-count<span class="o">=</span><span class="m">10000</span><span class="w"> </span>--trusted-ca-file<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt
</code></pre></div>
<p>Ans is <code>var/lib/etcd</code></p>
</details>
<hr />
<details class="question">
<summary> --- </summary>
<div class="highlight"><pre><span></span><code><span class="c1"># First set the context to cluster1:</span>

$<span class="w">  </span>kubectl<span class="w"> </span>config<span class="w"> </span>use-context<span class="w"> </span>cluster1
Switched<span class="w"> </span>to<span class="w"> </span>context<span class="w"> </span><span class="s2">&quot;cluster1&quot;</span>.


<span class="c1"># Next, inspect the endpoints and certificates used by the etcd pod. We will make use of these to take the backup.</span>

$<span class="w"> </span>kubectl<span class="w"> </span>describe<span class="w">  </span>pods<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span>etcd-cluster1-controlplane<span class="w">  </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>advertise-client-urls

--advertise-client-urls<span class="o">=</span>https://10.1.218.16:2379

$<span class="w">  </span>kubectl<span class="w"> </span>describe<span class="w">  </span>pods<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span>etcd-cluster1-controlplane<span class="w">  </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>pki
<span class="w">    </span>--cert-file<span class="o">=</span>/etc/kubernetes/pki/etcd/server.crt
<span class="w">    </span>--key-file<span class="o">=</span>/etc/kubernetes/pki/etcd/server.key
<span class="w">    </span>--peer-cert-file<span class="o">=</span>/etc/kubernetes/pki/etcd/peer.crt
<span class="w">    </span>--peer-key-file<span class="o">=</span>/etc/kubernetes/pki/etcd/peer.key
<span class="w">    </span>--peer-trusted-ca-file<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt
<span class="w">    </span>--trusted-ca-file<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt
<span class="w">    </span>/etc/kubernetes/pki/etcd<span class="w"> </span>from<span class="w"> </span>etcd-certs<span class="w"> </span><span class="o">(</span>rw<span class="o">)</span>

<span class="w">    </span>Path:<span class="w">          </span>/etc/kubernetes/pki/etcd

<span class="c1"># SSH to the controlplane node of cluster1 and then take the backup using the endpoints and certificates we identified above:</span>

controlplane$<span class="w"> </span>
<span class="nv">ETCDCTL_API</span><span class="o">=</span><span class="m">3</span><span class="w"> </span>etcdctl<span class="w"> </span><span class="se">\</span>
--endpoints<span class="o">=</span>https://10.1.220.8:2379<span class="w"> </span>--cacert<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt<span class="w"> </span><span class="se">\</span>
--cert<span class="o">=</span>/etc/kubernetes/pki/etcd/server.crt<span class="w"> </span><span class="se">\</span>
--key<span class="o">=</span>/etc/kubernetes/pki/etcd/server.key<span class="w"> </span><span class="se">\</span>
snapshot<span class="w"> </span>save<span class="w"> </span>/opt/cluster1.db

Snapshot<span class="w"> </span>saved<span class="w"> </span>at<span class="w"> </span>/opt/cluster1.db


<span class="c1"># Finally, copy the backup to the student-node. To do this, go back to the student-node and use scp as shown below:</span>

$<span class="w">  </span>scp<span class="w"> </span>cluster1-controlplane:/opt/cluster1.db<span class="w"> </span>/opt<span class="w"> </span>
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>An ETCD backup for cluster2 is stored at <code>/opt/cluster2.db</code>. Use this snapshot file to carryout a restore on cluster2 to a new path <code>/var/lib/etcd-data-new</code></summary>
<div class="highlight"><pre><span></span><code><span class="c1"># Step 1. Copy the snapshot file from the student-node to the etcd-server. In the example below, we are copying it to the /root directory:</span>

student-node<span class="w"> </span>~<span class="w">  </span>scp<span class="w"> </span>/opt/cluster2.db<span class="w"> </span>etcd-server:/root
cluster2.db<span class="w">                                                                                                        </span><span class="m">100</span>%<span class="w"> </span>1108KB<span class="w"> </span><span class="m">178</span>.5MB/s<span class="w">   </span><span class="m">00</span>:00<span class="w">    </span>

student-node<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>

<span class="c1"># Step 2: Restore the snapshot on the cluster2. Since we are restoring directly on the etcd-server, we can use the endpoint https:/127.0.0.1. Use the same certificates that were identified earlier. Make sure to use the data-dir as /var/lib/etcd-data-new:</span>

etcd-server<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span><span class="nv">ETCDCTL_API</span><span class="o">=</span><span class="m">3</span><span class="w"> </span>etcdctl<span class="w"> </span>--endpoints<span class="o">=</span>https://127.0.0.1:2379<span class="w"> </span>--cacert<span class="o">=</span>/etc/etcd/pki/ca.pem<span class="w"> </span>--cert<span class="o">=</span>/etc/etcd/pki/etcd.pem<span class="w"> </span>--key<span class="o">=</span>/etc/etcd/pki/etcd-key.pem<span class="w"> </span>snapshot<span class="w"> </span>restore<span class="w"> </span>/root/cluster2.db<span class="w"> </span>--data-dir<span class="w"> </span>/var/lib/etcd-data-new

<span class="o">{</span><span class="s2">&quot;level&quot;</span>:<span class="s2">&quot;info&quot;</span>,<span class="s2">&quot;ts&quot;</span>:1662004927.2399247,<span class="s2">&quot;caller&quot;</span>:<span class="s2">&quot;snapshot/v3_snapshot.go:296&quot;</span>,<span class="s2">&quot;msg&quot;</span>:<span class="s2">&quot;restoring snapshot&quot;</span>,<span class="s2">&quot;path&quot;</span>:<span class="s2">&quot;/root/cluster2.db&quot;</span>,<span class="s2">&quot;wal-dir&quot;</span>:<span class="s2">&quot;/var/lib/etcd-data-new/member/wal&quot;</span>,<span class="s2">&quot;data-dir&quot;</span>:<span class="s2">&quot;/var/lib/etcd-data-new&quot;</span>,<span class="s2">&quot;snap-dir&quot;</span>:<span class="s2">&quot;/var/lib/etcd-data-new/member/snap&quot;</span><span class="o">}</span>
<span class="o">{</span><span class="s2">&quot;level&quot;</span>:<span class="s2">&quot;info&quot;</span>,<span class="s2">&quot;ts&quot;</span>:1662004927.2584803,<span class="s2">&quot;caller&quot;</span>:<span class="s2">&quot;membership/cluster.go:392&quot;</span>,<span class="s2">&quot;msg&quot;</span>:<span class="s2">&quot;added member&quot;</span>,<span class="s2">&quot;cluster-id&quot;</span>:<span class="s2">&quot;cdf818194e3a8c32&quot;</span>,<span class="s2">&quot;local-member-id&quot;</span>:<span class="s2">&quot;0&quot;</span>,<span class="s2">&quot;added-peer-id&quot;</span>:<span class="s2">&quot;8e9e05c52164694d&quot;</span>,<span class="s2">&quot;added-peer-peer-urls&quot;</span>:<span class="o">[</span><span class="s2">&quot;http://localhost:2380&quot;</span><span class="o">]}</span>
<span class="o">{</span><span class="s2">&quot;level&quot;</span>:<span class="s2">&quot;info&quot;</span>,<span class="s2">&quot;ts&quot;</span>:1662004927.264258,<span class="s2">&quot;caller&quot;</span>:<span class="s2">&quot;snapshot/v3_snapshot.go:309&quot;</span>,<span class="s2">&quot;msg&quot;</span>:<span class="s2">&quot;restored snapshot&quot;</span>,<span class="s2">&quot;path&quot;</span>:<span class="s2">&quot;/root/cluster2.db&quot;</span>,<span class="s2">&quot;wal-dir&quot;</span>:<span class="s2">&quot;/var/lib/etcd-data-new/member/wal&quot;</span>,<span class="s2">&quot;data-dir&quot;</span>:<span class="s2">&quot;/var/lib/etcd-data-new&quot;</span>,<span class="s2">&quot;snap-dir&quot;</span>:<span class="s2">&quot;/var/lib/etcd-data-new/member/snap&quot;</span><span class="o">}</span>

etcd-server<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>

<span class="c1"># Step 3: Update the systemd service unit file for etcdby running vi /etc/systemd/system/etcd.service and add the new value for data-dir:</span>

<span class="o">[</span>Unit<span class="o">]</span>
<span class="nv">Description</span><span class="o">=</span>etcd<span class="w"> </span>key-value<span class="w"> </span>store
<span class="nv">Documentation</span><span class="o">=</span>https://github.com/etcd-io/etcd
<span class="nv">After</span><span class="o">=</span>network.target

<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">User</span><span class="o">=</span>etcd
<span class="nv">Type</span><span class="o">=</span>notify
<span class="nv">ExecStart</span><span class="o">=</span>/usr/local/bin/etcd<span class="w"> </span><span class="se">\</span>
--name<span class="w"> </span>etcd-server<span class="w"> </span><span class="se">\</span>
--data-dir<span class="o">=</span>/var/lib/etcd-data-new<span class="w"> </span><span class="se">\</span>
---End<span class="w"> </span>of<span class="w"> </span>Snippet---


<span class="c1"># Step 4: make sure the permissions on the new directory is correct (should be owned by etcd user):</span>

etcd-server<span class="w"> </span>/var/lib<span class="w"> </span>➜<span class="w">  </span>chown<span class="w"> </span>-R<span class="w"> </span>etcd:etcd<span class="w"> </span>/var/lib/etcd-data-new

etcd-server<span class="w"> </span>/var/lib<span class="w"> </span>➜<span class="w"> </span>


etcd-server<span class="w"> </span>/var/lib<span class="w"> </span>➜<span class="w">  </span>ls<span class="w"> </span>-ld<span class="w"> </span>/var/lib/etcd-data-new/
drwx------<span class="w"> </span><span class="m">3</span><span class="w"> </span>etcd<span class="w"> </span>etcd<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Sep<span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">02</span>:41<span class="w"> </span>/var/lib/etcd-data-new/
etcd-server<span class="w"> </span>/var/lib<span class="w"> </span>➜<span class="w"> </span>

<span class="c1">#  Step 5: Finally, reload and restart the etcd service.</span>

etcd-server<span class="w"> </span>~/default.etcd<span class="w"> </span>➜<span class="w">  </span>systemctl<span class="w"> </span>daemon-reload<span class="w"> </span>
etcd-server<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>systemctl<span class="w"> </span>restart<span class="w"> </span>etcd


<span class="c1">#  Step 6 (optional): It is recommended to restart controlplane components (e.g. kube-scheduler, kube-controller-manager, kubelet) to ensure that they don&#39;t rely on some stale data. </span>
</code></pre></div>
</details>
<h2 id="security">Security<a class="headerlink" href="#security" title="Permanent link">&para;</a></h2>
<h3 id="view-cert-details">View Cert Details<a class="headerlink" href="#view-cert-details" title="Permanent link">&para;</a></h3>
<details class="ques">
<summary>Identify the certificate file used for the kube-api server and Identify the Certificate file used to authenticate kube-apiserver as a client to ETCD Server</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>/etc/kubernetes/pki<span class="w"> </span>➜<span class="w">  </span>ls<span class="w"> </span>/etc/kubernetes/pki/<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.crt
apiserver.crt
apiserver-etcd-client.crt
apiserver-kubelet-client.crt
ca.crt
front-proxy-ca.crt
front-proxy-client.crt
</code></pre></div>
<p>Ans is <code>apiserver.crt</code> for 1<sup>st</sup> question and <code>apiserver-etcd-client.crt</code> for 2<sup>nd</sup></p>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>/etc/kubernetes/pki<span class="w"> </span>➜<span class="w">  </span>ls<span class="w"> </span>/etc/kubernetes/pki/<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.key
apiserver-etcd-client.key
apiserver.key
apiserver-kubelet-client.key<span class="w"> </span><span class="c1"># key used to authenticate kubeapi-server to the kubelet server.</span>
ca.key
front-proxy-ca.key
front-proxy-client.key
sa.key<span class="w">  </span>
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>Identify the ETCD Server Certificate used to host ETCD server</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># TIP: Look for cert-file option in the file /etc/kubernetes/manifests/etcd.yaml.</span>
<span class="l l-Scalar l-Scalar-Plain">controlplane /etc/kubernetes/manifests ➜  cat etcd.yaml | grep -i .crt</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">- --cert-file=/etc/kubernetes/pki/etcd/server.crt</span><span class="w"> </span><span class="c1"># answer</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--peer-cert-file=/etc/kubernetes/pki/etcd/peer.crt</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--peer-trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt</span>
</code></pre></div>
</details>
<hr />
<details class="note">
<summary>Identify the ETCD Server CA Root Certificate used to serve ETCD Server</summary>
<p>ETCD can have its own CA. So this may be a different CA certificate than the one used by kube-api server.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># TIP: Look for CA Certificate (trusted-ca-file) in file /etc/kubernetes/manifests/etcd.yaml.</span>

controlplane<span class="w"> </span>/etc/kubernetes/manifests<span class="w"> </span>➜<span class="w">  </span>cat<span class="w"> </span>etcd.yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>.crt
<span class="w">    </span>-<span class="w"> </span>--cert-file<span class="o">=</span>/etc/kubernetes/pki/etcd/server.crt
<span class="w">    </span>-<span class="w"> </span>--peer-cert-file<span class="o">=</span>/etc/kubernetes/pki/etcd/peer.crt
<span class="w">    </span>-<span class="w"> </span>--peer-trusted-ca-file<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt
<span class="w">    </span>-<span class="w"> </span>--trusted-ca-file<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt<span class="w"> </span><span class="c1"># ans</span>
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>What is the Common Name (CN) configured on the Kube API Server Certificate?</summary>
<p>OpenSSL Syntax: openssl x509 -in file-path.crt -text -noout</p>
<div class="highlight"><pre><span></span><code><span class="c1"># TIP: Run the command openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text and look for Subject CN.</span>

controlplane<span class="w"> </span>/etc/kubernetes/pki<span class="w"> </span>✖<span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-in<span class="w"> </span>apiserver.crt<span class="w"> </span>-text<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>cn
<span class="w">        </span>Issuer:<span class="w"> </span><span class="nv">CN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>kubernetes<span class="w">             </span><span class="c1"># Name of CA who issued the cert</span>
<span class="w">        </span>Subject:<span class="w"> </span><span class="nv">CN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>kube-apiserver<span class="w">        </span><span class="c1"># What is the Common Name (CN) configured on the Kube API Server</span>
MIIDjDCCAnSgAwIBAgIIVPn/5jFVfAMwDQYJKoZIhvcNAQELBQAwFTETMBEGA1UE
nUyXcccNRLfQfrhu9NoD+4Nq7gM99y5QRpD8QimBnv1DBzXk+XWoC2Ka3EpmRzZZ
</code></pre></div>
</details>
<hr />
<details class="note">
<summary>Which of the below alternate names is not configured on the Kube API Server Certificate?</summary>
<div class="highlight"><pre><span></span><code><span class="c1">#TIP: Run the command openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text and look at Alternative Names as shown below</span>

X509v3<span class="w"> </span>Subject<span class="w"> </span>Alternative<span class="w"> </span>Name:<span class="w"> </span>
DNS:controlplane,<span class="w"> </span>DNS:kubernetes,<span class="w"> </span>DNS:kubernetes.default,<span class="w"> </span>DNS:kubernetes.default.svc,<span class="w"> </span>DNS:kubernetes.default.svc.cluster.local,<span class="w"> </span>IP<span class="w"> </span>Address:10.96.0.1,<span class="w"> </span>IP<span class="w"> </span>Address:192.2.128.9
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>How long, from the issued date, is the Kube-API Server Certificate valid for?</summary>
<div class="highlight"><pre><span></span><code><span class="c1">#TIP:  Run the command openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text and check on the Expiry date.</span>
<span class="w">        </span>Issuer:<span class="w"> </span><span class="nv">CN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>etcd-ca
<span class="w">        </span>Validity
<span class="w">            </span>Not<span class="w"> </span>Before:<span class="w"> </span>Nov<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">00</span>:50:29<span class="w"> </span><span class="m">2023</span><span class="w"> </span>GMT
<span class="w">            </span>Not<span class="w"> </span>After<span class="w"> </span>:<span class="w"> </span>Nov<span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">00</span>:50:29<span class="w"> </span><span class="m">2024</span><span class="w"> </span>GMT
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>How long, from the issued date, is the Root CA Certificate valid for?</summary>
<div class="highlight"><pre><span></span><code><span class="c1">#TIP: Run the command openssl x509 -in /etc/kubernetes/pki/ca.crt -text and look for the validity.</span>
<span class="w">    </span>Data:
<span class="w">        </span>Version:<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">(</span>0x2<span class="o">)</span>
<span class="w">        </span>Serial<span class="w"> </span>Number:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>0x0<span class="o">)</span>
<span class="w">        </span>Signature<span class="w"> </span>Algorithm:<span class="w"> </span>sha256WithRSAEncryption
<span class="w">        </span>Issuer:<span class="w"> </span><span class="nv">CN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>kubernetes
<span class="w">        </span>Validity
<span class="w">            </span>Not<span class="w"> </span>Before:<span class="w"> </span>Nov<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">00</span>:50:28<span class="w"> </span><span class="m">2023</span><span class="w"> </span>GMT
<span class="w">            </span>Not<span class="w"> </span>After<span class="w"> </span>:<span class="w"> </span>Nov<span class="w"> </span><span class="m">17</span><span class="w"> </span><span class="m">00</span>:50:28<span class="w"> </span><span class="m">2033</span><span class="w"> </span>GMT
<span class="w">        </span>Subject:<span class="w"> </span><span class="nv">CN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>kubernetes
</code></pre></div>
</details>
<hr />
<details class="error">
<summary>The kube-api server stopped again! Check it out. Inspect the kube-api server logs and identify the root cause and fix the issue</summary>
<p>Run crictl ps -a command to identify the kube-api server container. Run crictl logs container-id command to view the logs.</p>
<div class="highlight"><pre><span></span><code>crictl<span class="w"> </span>ps<span class="w"> </span>-a
CONTAINER<span class="w">           </span>IMAGE<span class="w">               </span>CREATED<span class="w">              </span>STATE<span class="w">               </span>NAME<span class="w">                      </span>ATTEMPT<span class="w">             </span>POD<span class="w"> </span>ID<span class="w">              </span>POD
3bac921cb4a5a<span class="w">       </span>6f707f569b572<span class="w">       </span><span class="m">16</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">       </span>Running<span class="w">             </span>kube-apiserver<span class="w">            </span><span class="m">0</span><span class="w">                   </span>fec26f7c6715a<span class="w">       </span>kube-apiserver-controlplane
33527b14bc1bf<span class="w">       </span>f73f1b39c3fe8<span class="w">       </span><span class="m">22</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">       </span>Running<span class="w">             </span>kube-scheduler<span class="w">            </span><span class="m">2</span><span class="w">                   </span>fb3dc26664afc<span class="w">       </span>kube-scheduler-controlplane
627a986414afe<span class="w">       </span>95fe52ed44570<span class="w">       </span><span class="m">25</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">       </span>Running<span class="w">             </span>kube-controller-manager<span class="w">   </span><span class="m">2</span><span class="w">                   </span>c674e558cf141<span class="w">       </span>kube-controller-manager-controlplane
5d7b588da6e90<span class="w">       </span>86b6af7dd652c<span class="w">       </span>About<span class="w"> </span>a<span class="w"> </span>minute<span class="w"> </span>ago<span class="w">   </span>Running<span class="w">             </span>etcd<span class="w">                      </span><span class="m">0</span><span class="w">                   </span>efd0a8d9c600e<span class="w">       </span>etcd-controlplane
762ccbdfde7a8<span class="w">       </span>f73f1b39c3fe8<span class="w">       </span><span class="m">4</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">        </span>Exited<span class="w">              </span>kube-scheduler<span class="w">            </span><span class="m">1</span><span class="w">                   </span>fb3dc26664afc<span class="w">       </span>kube-scheduler-controlplane
b3e4272eefb7b<span class="w">       </span>95fe52ed44570<span class="w">       </span><span class="m">4</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">        </span>Exited<span class="w">              </span>kube-controller-manager<span class="w">   </span><span class="m">1</span><span class="w">                   </span>c674e558cf141<span class="w">       </span>kube-controller-manager-controlplane
7fa9a78979c3e<span class="w">       </span>ead0a4a53df89<span class="w">       </span><span class="m">35</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">       </span>Running<span class="w">             </span>coredns<span class="w">                   </span><span class="m">0</span><span class="w">                   </span>c23b177006c7a<span class="w">       </span>coredns-5d78c9869d-p8tjq
bf84f7ebb5d43<span class="w">       </span>ead0a4a53df89<span class="w">       </span><span class="m">35</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">       </span>Running<span class="w">             </span>coredns<span class="w">                   </span><span class="m">0</span><span class="w">                   </span>274222b10e501<span class="w">       </span>coredns-5d78c9869d-84jrn
247e828f3e5e3<span class="w">       </span>8b675dda11bb1<span class="w">       </span><span class="m">35</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">       </span>Running<span class="w">             </span>kube-flannel<span class="w">              </span><span class="m">0</span><span class="w">                   </span>579d556b90be1<span class="w">       </span>kube-flannel-ds-6xdvn
b412cc3976452<span class="w">       </span>8b675dda11bb1<span class="w">       </span><span class="m">35</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">       </span>Exited<span class="w">              </span>install-cni<span class="w">               </span><span class="m">0</span><span class="w">                   </span>579d556b90be1<span class="w">       </span>kube-flannel-ds-6xdvn
63734700d5255<span class="w">       </span>fcecffc7ad4af<span class="w">       </span><span class="m">35</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">       </span>Exited<span class="w">              </span>install-cni-plugin<span class="w">        </span><span class="m">0</span><span class="w">                   </span>579d556b90be1<span class="w">       </span>kube-flannel-ds-6xdvn
7c4e662a2827d<span class="w">       </span>5f82fc39fa816<span class="w">       </span><span class="m">35</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">       </span>Running<span class="w">             </span>kube-proxy<span class="w">                </span><span class="m">0</span><span class="w">                   </span>60aabd71d5180<span class="w">       </span>kube-proxy-hs4c4
</code></pre></div>
<div class="highlight"><pre><span></span><code>crictl<span class="w"> </span>logs<span class="w"> </span>da40e86464c04
I1120<span class="w"> </span><span class="m">01</span>:29:05.406801<span class="w">       </span><span class="m">1</span><span class="w"> </span>server.go:551<span class="o">]</span><span class="w"> </span>external<span class="w"> </span>host<span class="w"> </span>was<span class="w"> </span>not<span class="w"> </span>specified,<span class="w"> </span>using<span class="w"> </span><span class="m">192</span>.2.128.9
I1120<span class="w"> </span><span class="m">01</span>:29:05.407768<span class="w">       </span><span class="m">1</span><span class="w"> </span>server.go:165<span class="o">]</span><span class="w"> </span>Version:<span class="w"> </span>v1.27.0
I1120<span class="w"> </span><span class="m">01</span>:29:05.407793<span class="w">       </span><span class="m">1</span><span class="w"> </span>server.go:167<span class="o">]</span><span class="w"> </span><span class="s2">&quot;Golang settings&quot;</span><span class="w"> </span><span class="nv">GOGC</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="nv">GOMAXPROCS</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="nv">GOTRACEBACK</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
I1120<span class="w"> </span><span class="m">01</span>:29:05.685211<span class="w">       </span><span class="m">1</span><span class="w"> </span>shared_informer.go:311<span class="o">]</span><span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>caches<span class="w"> </span>to<span class="w"> </span>sync<span class="w"> </span><span class="k">for</span><span class="w"> </span>node_authorizer
I1120<span class="w"> </span><span class="m">01</span>:29:05.694542<span class="w">       </span><span class="m">1</span><span class="w"> </span>plugins.go:158<span class="o">]</span><span class="w"> </span>Loaded<span class="w"> </span><span class="m">12</span><span class="w"> </span>mutating<span class="w"> </span>admission<span class="w"> </span>controller<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>successfully<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>order:<span class="w"> </span>NamespaceLifecycle,LimitRanger,ServiceAccount,NodeRestriction,TaintNodesByCondition,Priority,DefaultTolerationSeconds,DefaultStorageClass,StorageObjectInUseProtection,RuntimeClass,DefaultIngressClass,MutatingAdmissionWebhook.
I1120<span class="w"> </span><span class="m">01</span>:29:05.694560<span class="w">       </span><span class="m">1</span><span class="w"> </span>plugins.go:161<span class="o">]</span><span class="w"> </span>Loaded<span class="w"> </span><span class="m">13</span><span class="w"> </span>validating<span class="w"> </span>admission<span class="w"> </span>controller<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>successfully<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>order:<span class="w"> </span>LimitRanger,ServiceAccount,PodSecurity,Priority,PersistentVolumeClaimResize,RuntimeClass,CertificateApproval,CertificateSigning,ClusterTrustBundleAttest,CertificateSubjectRestriction,ValidatingAdmissionPolicy,ValidatingAdmissionWebhook,ResourceQuota.
W1120<span class="w"> </span><span class="m">01</span>:29:05.700731<span class="w">       </span><span class="m">1</span><span class="w"> </span>logging.go:59<span class="o">]</span><span class="w"> </span><span class="o">[</span>core<span class="o">]</span><span class="w"> </span><span class="o">[</span>Channel<span class="w"> </span><span class="c1">#1 SubChannel #2] grpc: addrConn.createTransport failed to connect to {</span>
<span class="s2">&quot;Addr&quot;</span>:<span class="w"> </span><span class="s2">&quot;127.0.0.1:2379&quot;</span>,
<span class="s2">&quot;ServerName&quot;</span>:<span class="w"> </span><span class="s2">&quot;127.0.0.1&quot;</span>,
<span class="s2">&quot;Attributes&quot;</span>:<span class="w"> </span>null,
<span class="s2">&quot;BalancerAttributes&quot;</span>:<span class="w"> </span>null,
<span class="s2">&quot;Type&quot;</span>:<span class="w"> </span><span class="m">0</span>,
<span class="s2">&quot;Metadata&quot;</span>:<span class="w"> </span>null
<span class="o">}</span>.<span class="w"> </span>Err:<span class="w"> </span>connection<span class="w"> </span>error:<span class="w"> </span><span class="nv">desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority&quot;</span>
W1120<span class="w"> </span><span class="m">01</span>:29:06.688471<span class="w">       </span><span class="m">1</span><span class="w"> </span>logging.go:59<span class="o">]</span><span class="w"> </span><span class="o">[</span>core<span class="o">]</span><span class="w"> </span><span class="o">[</span>Channel<span class="w"> </span><span class="c1">#4 SubChannel #6] grpc: addrConn.createTransport failed to connect to {</span>
<span class="s2">&quot;Addr&quot;</span>:<span class="w"> </span><span class="s2">&quot;127.0.0.1:2379&quot;</span>,
<span class="s2">&quot;ServerName&quot;</span>:<span class="w"> </span><span class="s2">&quot;127.0.0.1&quot;</span>,
<span class="s2">&quot;Attributes&quot;</span>:<span class="w"> </span>null,
<span class="s2">&quot;BalancerAttributes&quot;</span>:<span class="w"> </span>null,
<span class="s2">&quot;Type&quot;</span>:<span class="w"> </span><span class="m">0</span>,
<span class="s2">&quot;Metadata&quot;</span>:<span class="w"> </span>null
</code></pre></div>
<p>Here specify the right <code>ca cert</code> file  </p>
</details>
<hr />
<details class="question">
<summary>A new member akshay joined our team. He requires access to our cluster</summary>
<p>The Certificate Signing Request is at the /root location.</p>
<div class="highlight"><pre><span></span><code><span class="nt">Use this command to generate the base64 encoded format as following</span><span class="p">:</span><span class="w"> </span><span class="err">-</span>

<span class="l l-Scalar l-Scalar-Plain">cat akshay.csr | base64 -w 0</span>

<span class="l l-Scalar l-Scalar-Plain">Finally, save the below YAML in a file and create a CSR name akshay as follows</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="err">-</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">certificates.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CertificateSigningRequest</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">akshay</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system:authenticated</span>
<span class="nt">request</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;Paste the base64 encoded value of the CSR file&gt;</span>
<span class="nt">signerName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/kube-apiserver-client</span>
<span class="nt">usages</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">client auth</span>


<span class="l l-Scalar l-Scalar-Plain">kubectl apply -f akshay-csr.yaml</span>
</code></pre></div>
<p>Sample shown below</p>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  cat csr-mani.yaml</span><span class="w"> </span>
<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">certificates.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CertificateSigningRequest</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">akshay</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">request</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ1ZqQ0NBVDRDQVFBd0VURVBNQTBHQTFVRUF3d0dZV3R6YUdGNU1JSUJJakFOQmdrcWhraUc5dzBCQVFFRgpBQU9DQVE4QU1JSUJDZ0tDQVFFQTc2WjA5ZlgzLzhaanB1Rlc2aE9xeG1tYW1qb3VRVDZvSDJ0WHltd0xVOGx5Cmg4dTQwV1RtTVRxbzk4Kzk0a3lnOTdKUFRWbDdsWkNRbkZKdmlpTlAzVlRRa0tOU3FOakQzcGRESUxsUXErcHQKeDV2bXhhcUxmTlZocEt5QzdkZlk1L1VEZHNPT05CYit4dWNkNmx4YU5kdTJqMml4alF2aisyOXdRdExvaUYxNQpQNDZ5NkQ0c1dnb04zcWc4Y1RhNTRNcnRPc1FBem1CZHdQcnVXNXFlODBNaGMrQk9HWmx2YlZPcmIzREVINmFOCmNTMzA2SGlwUzl5TkpOMzArdThwd1FtcS9QM0JneHJuOS9DNkhPY1JiaHQ0WTE2Q2hjZUk3anFjcVRHbithcE4KemgxeDN2ZGg3dVNCam1Pb3JsNVpTYW1FcHhOdnBpVkdqNUZMaVBYYW93SURBUUFCb0FBd0RRWUpLb1pJaHZjTgpBUUVMQlFBRGdnRUJBRFpINmFtcXdEMjZDM1dwVjlKNzM1N3hibGhIQVkrK3FOSzR6Qk1jZE01dnUwV1VYK3dGCkFRd2czREFORW52UThMdWJnV3RLaEkwUGxPbjRWK1JSZzIxK01qUFhsUzNDWkZodEN6VE9oY0hwUGVBQnZZQnEKWkthTHBTTVlTdEVqYnNsWGg1dVhiZmxMRHBRSllZNEdTc2tXRStsZnVzTUNyNFhGNzNSVUNFWHdHZGFFNFdpcAp6WGFsb0x1ZFdneGFmVlRSR1JWK2RKMXNuV2pMaWRySVU3NDZxUVZiUW1Gc0pWU2VaTjZNSGRiU0xIZFZNZjJMCmR3dThNcUVpRUQzeUhJT2dCdlowaWJQT1VtMmFrZVFUT2F5cEhCQVJJanRSYVA5cnhuYUM4ckNZK0czb0MvdEQKY1hpajk3ak5pRzU0UWJMMEN5NUdqcEQ2YndTek5iM0dpN3c9Ci0tLS0tRU5EIENFUlRJRklDQVRFIFJFUVVFU1QtLS0tLQo=</span>
<span class="nt">signerName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/kube-apiserver-client</span>
<span class="nt">expirationSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">86400</span><span class="w">  </span><span class="c1"># one day</span>
<span class="nt">usages</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">client auth</span>
</code></pre></div>
<p>csr is created as shown below
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>csr-mani.yaml<span class="w"> </span>
certificatesigningrequest.certificates.k8s.io/akshay<span class="w"> </span>created
</code></pre></div></p>
<p>check the CSR's
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>get<span class="w"> </span>csr
NAME<span class="w">        </span>AGE<span class="w">   </span>SIGNERNAME<span class="w">                                    </span>REQUESTOR<span class="w">                  </span>REQUESTEDDURATION<span class="w">   </span>CONDITION
akshay<span class="w">      </span>73s<span class="w">   </span>kubernetes.io/kube-apiserver-client<span class="w">           </span>kubernetes-admin<span class="w">           </span>24h<span class="w">                 </span>Pending
csr-8wnnl<span class="w">   </span>17m<span class="w">   </span>kubernetes.io/kube-apiserver-client-kubelet<span class="w">   </span>system:node:controlplane<span class="w">   </span>&lt;none&gt;<span class="w">              </span>Approved,Issued
</code></pre></div></p>
</details>
<hr />
<details class="success">
<summary>Please approve the CSR</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>✖<span class="w"> </span>k<span class="w"> </span>certificate<span class="w"> </span>approve<span class="w"> </span>akshay
certificatesigningrequest.certificates.k8s.io/akshay<span class="w"> </span>approved
</code></pre></div>
</details>
<hr />
<details class="warning">
<summary>Describe the new CSR you got</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># TIP: use the get -o yaml instead of describe</span>
<span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  k get  csr agent-smith -o yaml</span><span class="w"> </span>

<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">certificates.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CertificateSigningRequest</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2023-11-20T02:04:44Z&quot;</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agent-smith</span>
<span class="nt">resourceVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2170&quot;</span>
<span class="nt">uid</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8eeaf351-96ac-488a-8d83-cab1edc14605</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system:masters</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system:authenticated</span>
<span class="nt">request</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">XXXX_OMITTED</span>
<span class="nt">signerName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/kube-apiserver-client</span>
<span class="nt">usages</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">digital signature</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key encipherment</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">server auth</span>
<span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agent-x</span>
<span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
</details>
<h3 id="kubeconfig">Kubeconfig<a class="headerlink" href="#kubeconfig" title="Permanent link">&para;</a></h3>
<p>Where is the default kubeconfig file located in the current environment?</p>
<div class="highlight"><pre><span></span><code>/root/.kube/config
</code></pre></div>
<details class="question">
<summary>How many clusters are defined in the default kubeconfig file?</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># Run the kubectl config view command and count the number of clusters.</span>
<span class="l l-Scalar l-Scalar-Plain">controlplane ~/.kube ➜  k config view</span>
<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">clusters</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">cluster</span><span class="p">:</span>
<span class="w">    </span><span class="nt">certificate-authority-data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATA+OMITTED</span>
<span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://controlplane:6443</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes</span>
<span class="nt">contexts</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">context</span><span class="p">:</span><span class="w">  </span>
<span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes</span>
<span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes-admin</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes-admin@kubernetes</span>
<span class="nt">current-context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes-admin@kubernetes</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Config</span>
<span class="nt">preferences</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">users</span><span class="p">:</span><span class="w">  </span><span class="c1"># numnber of users</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes-admin</span>
<span class="nt">user</span><span class="p">:</span>
<span class="w">    </span><span class="nt">client-certificate-data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATA+OMITTED</span>
<span class="w">    </span><span class="nt">client-key-data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATA+OMITTED</span>
</code></pre></div>
<p>Lets check the kube config file</p>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">~/.kube ➜  cat /root/my-kube-config</span><span class="w"> </span>
<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Config</span>

<span class="nt">clusters</span><span class="p">:</span><span class="w"> </span><span class="c1"># 4 clusters are configured</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">cluster</span><span class="p">:</span>
<span class="w">    </span><span class="nt">certificate-authority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki/ca.crt</span>
<span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://controlplane:6443</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">development</span>
<span class="nt">cluster</span><span class="p">:</span>
<span class="w">    </span><span class="nt">certificate-authority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki/ca.crt</span>
<span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://controlplane:6443</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes-on-aws</span>
<span class="nt">cluster</span><span class="p">:</span>
<span class="w">    </span><span class="nt">certificate-authority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki/ca.crt</span>
<span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://controlplane:6443</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-cluster-1</span>
<span class="nt">cluster</span><span class="p">:</span>
<span class="w">    </span><span class="nt">certificate-authority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki/ca.crt</span>
<span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://controlplane:6443</span>

<span class="nt">contexts</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-user@development</span>
<span class="nt">context</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">development</span>
<span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-user</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-user@kubernetes-on-aws</span>
<span class="nt">context</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes-on-aws</span>
<span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-user</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-user@production</span>
<span class="nt">context</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-user</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">research</span>
<span class="nt">context</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-cluster-1</span>
<span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev-user</span><span class="w">  </span><span class="c1"># user for research context</span>

<span class="nt">users</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-user</span>
<span class="nt">user</span><span class="p">:</span>
<span class="w">    </span><span class="nt">client-certificate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki/users/test-user/test-user.crt</span>
<span class="w">    </span><span class="nt">client-key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki/users/test-user/test-user.key</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev-user</span>
<span class="nt">user</span><span class="p">:</span>
<span class="w">    </span><span class="nt">client-certificate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki/users/dev-user/developer-user.crt</span>
<span class="w">    </span><span class="nt">client-key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki/users/dev-user/dev-user.key</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-user</span>
<span class="nt">user</span><span class="p">:</span>
<span class="w">    </span><span class="nt">client-certificate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki/users/aws-user/aws-user.crt</span>
<span class="w">    </span><span class="nt">client-key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki/users/aws-user/aws-user.key</span>

<span class="nt">current-context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-user@development</span><span class="w"> </span><span class="c1"># current context</span>
<span class="nt">preferences</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
</details>
<hr />
<details class="quesiton">
<summary>I would like to use the dev-user to access test-cluster-1. Set the current context to the right one so I can do that</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># TIP: use the right context file as well</span>
controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>config<span class="w"> </span>--kubeconfig<span class="w"> </span>/root/my-kube-config<span class="w"> </span>use-context<span class="w"> </span>research
Switched<span class="w"> </span>to<span class="w"> </span>context<span class="w"> </span><span class="s2">&quot;research&quot;</span>.

<span class="c1"># Test it</span>
controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>config<span class="w"> </span>--kubeconfig<span class="w"> </span>/root/my-kube-config<span class="w"> </span>current-context<span class="w"> </span>
research
</code></pre></div>
</details>
<h3 id="rbac">RBAC<a class="headerlink" href="#rbac" title="Permanent link">&para;</a></h3>
<p>Role-based access control (RBAC) is a method of regulating access to computer or network resources based on the roles of individual users within your organization.</p>
<p>The RBAC API declares four kinds of Kubernetes object: Role, ClusterRole, RoleBinding and ClusterRoleBinding. </p>
<p>An RBAC Role or ClusterRole contains rules that represent a set of permissions. Permissions are purely additive (there are no "deny" rules). A Role always sets permissions within a particular namespace; when you create a Role, you have to specify the namespace it belongs in. ClusterRole, by contrast, is a non-namespaced resource. The resources have different names (Role and ClusterRole) because a Kubernetes object always has to be either namespaced or not namespaced; it can't be both.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Read role</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Role</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pod-reader</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;&quot;</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># &quot;&quot; indicates the core API group</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pods&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;list&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>ClusterRole example shown below</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterRole</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># &quot;namespace&quot; omitted since ClusterRoles are not namespaced</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret-reader</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="c1">#</span>
<span class="w">  </span><span class="c1"># at the HTTP level, the name of the resource for accessing Secret</span>
<span class="w">  </span><span class="c1"># objects is &quot;secrets&quot;</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;secrets&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;list&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>A role binding grants the permissions defined in a role to a user or set of users. It holds a list of subjects (users, groups, or service accounts), and a reference to the role being granted. A RoleBinding grants permissions within a specific namespace whereas a ClusterRoleBinding grants that access cluster-wide.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="c1"># This role binding allows &quot;jane&quot; to read pods in the &quot;default&quot; namespace.</span>
<span class="c1"># You need to already have a Role named &quot;pod-reader&quot; in that namespace.</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RoleBinding</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">read-pods</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">subjects</span><span class="p">:</span>
<span class="c1"># You can specify more than one &quot;subject&quot;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">User</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jane</span><span class="w"> </span><span class="c1"># &quot;name&quot; is case sensitive</span>
<span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
<span class="nt">roleRef</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># &quot;roleRef&quot; specifies the binding to a Role / ClusterRole</span>
<span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Role</span><span class="w"> </span><span class="c1">#this must be Role or ClusterRole</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pod-reader</span><span class="w"> </span><span class="c1"># this must match the name of the Role or ClusterRole you wish to bind to</span>
<span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
</code></pre></div>
<div class="admonition remember">
<p class="admonition-title">Using ClusterRole in RoleBinding</p>
<p>A RoleBinding can also reference a ClusterRole to grant the permissions defined in that ClusterRole to resources inside the RoleBinding's namespace. This kind of reference lets you define a set of common roles across your cluster, then reuse them within multiple namespaces.</p>
</div>
<p>To grant permissions across a whole cluster, you can use a ClusterRoleBinding. The following ClusterRoleBinding allows any user in the group "manager" to read secrets in any namespace.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="c1"># This cluster role binding allows anyone in the &quot;manager&quot; group to read secrets in any namespace.</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterRoleBinding</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">read-secrets-global</span>
<span class="nt">subjects</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Group</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">manager</span><span class="w"> </span><span class="c1"># Name is case sensitive</span>
<span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
<span class="nt">roleRef</span><span class="p">:</span>
<span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterRole</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret-reader</span>
<span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
</code></pre></div>
<hr />
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Inspect the environment and identify the authorization modes configured on the cluster.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># Use the command kubectl describe pod kube-apiserver-controlplane -n kube-system and look for --authorization-mode.</span>

controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span>describe<span class="w"> </span>po<span class="w"> </span>kube-apiserver-controlplane<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>auth
<span class="w">      </span>--authorization-mode<span class="o">=</span>Node,RBAC
<span class="w">      </span>--enable-bootstrap-token-auth<span class="o">=</span><span class="nb">true</span>
</code></pre></div>
<hr />
<details class="question">
<summary>What are the resources the kube-proxy role in the kube-system namespace is given access to?</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>describe<span class="w"> </span>role<span class="w"> </span>kube-proxy<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span>
Name:<span class="w">         </span>kube-proxy
Labels:<span class="w">       </span>&lt;none&gt;
Annotations:<span class="w">  </span>&lt;none&gt;
PolicyRule:
Resources<span class="w">   </span>Non-Resource<span class="w"> </span>URLs<span class="w">  </span>Resource<span class="w"> </span>Names<span class="w">  </span>Verbs
---------<span class="w">   </span>-----------------<span class="w">  </span>--------------<span class="w">  </span>-----
configmaps<span class="w">  </span><span class="o">[]</span><span class="w">                 </span><span class="o">[</span>kube-proxy<span class="o">]</span><span class="w">    </span><span class="o">[</span>get<span class="o">]</span>
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Which account is the kube-proxy role assigned to?</summary>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  kubectl describe rolebinding kube-proxy -n kube-system</span>
<span class="l l-Scalar l-Scalar-Plain">Name</span><span class="p p-Indicator">:</span><span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">kube-proxy</span>
<span class="nt">Labels</span><span class="p">:</span><span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">&lt;none&gt;</span>
<span class="nt">Annotations</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">&lt;none&gt;</span>
<span class="nt">Role</span><span class="p">:</span>
<span class="nt">Kind</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">Role</span>
<span class="nt">Name</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">kube-proxy</span>
<span class="nt">Subjects</span><span class="p">:</span>
<span class="l l-Scalar l-Scalar-Plain">Kind   Name                                             Namespace</span>
<span class="l l-Scalar l-Scalar-Plain">----   ----                                             ---------</span>
<span class="l l-Scalar l-Scalar-Plain">Group  system:bootstrappers:kubeadm:default-node-token</span><span class="w"> </span>
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>A user dev-user is created. User's details have been added to the kubeconfig file. Inspect the permissions granted to the user. Check if the user can list pods in the default namespace.</summary>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>--as<span class="w"> </span>dev-user
</code></pre></div>
</details>
<hr />
<details class="warning">
<summary>Create the necessary roles and role bindings required for the dev-user to create, list and delete pods in the default namespace</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>✖<span class="w"> </span>kubectl<span class="w"> </span>create<span class="w"> </span>role<span class="w"> </span>developer<span class="w">  </span>--verb<span class="o">=</span>create<span class="w"> </span>--verb<span class="o">=</span>list<span class="w"> </span>--verb<span class="o">=</span>delete<span class="w"> </span>--resource<span class="o">=</span>pods

role.rbac.authorization.k8s.io/developer<span class="w"> </span>created
</code></pre></div>
<p>Create a binding for it as shown below
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>✖<span class="w"> </span>kubectl<span class="w"> </span>create<span class="w"> </span>rolebinding<span class="w"> </span>dev-user-binding<span class="w"> </span>--role<span class="o">=</span>developer<span class="w"> </span>--user<span class="o">=</span>dev-user<span class="w"> </span>--namespace<span class="o">=</span>default

rolebinding.rbac.authorization.k8s.io/dev-user-binding<span class="w"> </span>created


controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>--as<span class="w"> </span>dev-user
NAME<span class="w">                   </span>READY<span class="w">   </span>STATUS<span class="w">    </span>RESTARTS<span class="w">   </span>AGE
red-697496b845-2srbh<span class="w">   </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>18m
red-697496b845-n4zsd<span class="w">   </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>18m
</code></pre></div></p>
</details>
<hr />
<details class="quesiton">
<summary>What user/groups are the cluster-admin role bound to?</summary>
<p>The ClusterRoleBinding for the role is with the same name.</p>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  k get  clusterrolebindings.rbac.authorization.k8s.io cluster-admin -o yaml</span>

<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterRoleBinding</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">rbac.authorization.kubernetes.io/autoupdate</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2023-11-21T01:48:21Z&quot;</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kubernetes.io/bootstrapping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac-defaults</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster-admin</span>
<span class="nt">resourceVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;134&quot;</span>
<span class="nt">uid</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4330de0f-ef56-42ef-8ea9-c2bb3e26f4a2</span>
<span class="nt">roleRef</span><span class="p">:</span>
<span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterRole</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster-admin</span>
<span class="nt">subjects</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Group</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system:masters</span><span class="w"> </span><span class="c1"># answer</span>
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>What level of permission does the cluster-admin role grant?</summary>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  k get  clusterrole  cluster-admin -o yaml</span>

<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterRole</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">rbac.authorization.kubernetes.io/autoupdate</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2023-11-21T01:48:20Z&quot;</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kubernetes.io/bootstrapping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac-defaults</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster-admin</span>
<span class="nt">resourceVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;72&quot;</span>
<span class="nt">uid</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c5bab975-ad5f-48bb-837c-65aae7200b9e</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroups</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="nt">verbs</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">nonResourceURLs</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="nt">verbs</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
</code></pre></div>
<p><strong>Answer:</strong> Perform any role on any resource in the cluster</p>
</details>
<hr />
<details class="note">
<summary>A new user michelle joined the team. She will be focusing on the nodes in the cluster. Create the required ClusterRoles and ClusterRoleBindings so she gets access to the nodes</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>kubectl<span class="w"> </span>create<span class="w"> </span>clusterrole<span class="w"> </span>node-reader<span class="w"> </span>--verb<span class="o">=</span>get,list,watch<span class="w"> </span>--resource<span class="o">=</span>nodes

clusterrole.rbac.authorization.k8s.io/node-reader<span class="w"> </span>created


controlplane<span class="w"> </span>~<span class="w"> </span>✖<span class="w"> </span>kubectl<span class="w"> </span>create<span class="w"> </span>clusterrolebinding<span class="w"> </span>node-reader-cluster-binding<span class="w"> </span>--clusterrole<span class="o">=</span>node-reader<span class="w"> </span>--user<span class="o">=</span>michelle

clusterrolebinding.rbac.authorization.k8s.io/node-reader-cluster-binding<span class="w"> </span>created
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>Michelle's responsibilities are growing and now she will be responsible for storage as well. Create the required ClusterRoles and ClusterRoleBindings to allow her access to Storage</summary>
<p>Get the API groups and resource names from command kubectl api-resources. Use the given spec:</p>
<div class="highlight"><pre><span></span><code><span class="nt">ClusterRole</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">storage-admin</span>
<span class="nt">Resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">persistentvolumes</span>
<span class="nt">Resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">storageclasses</span>
<span class="nt">ClusterRoleBinding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">michelle-storage-admin</span>
<span class="nt">ClusterRoleBinding Subject</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">michelle</span>
<span class="nt">ClusterRoleBinding Role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">storage-admin</span>
</code></pre></div>
<p>Answer is shown below</p>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>kubectl<span class="w"> </span>create<span class="w"> </span>clusterrole<span class="w"> </span>storage-admin<span class="w">  </span>--verb<span class="o">=</span>get,list,watch<span class="w"> </span>--resource<span class="o">=</span>persistentvolumes<span class="w"> </span>--verb<span class="o">=</span>get,list<span class="w"> </span>--resource<span class="o">=</span>storageclasses
clusterrole.rbac.authorization.k8s.io/storage-admin<span class="w"> </span>created

controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>kubectl<span class="w"> </span>create<span class="w"> </span>clusterrolebinding<span class="w"> </span>michelle-storage-admin<span class="w">  </span>--clusterrole<span class="o">=</span>storage-admin<span class="w"> </span>--user<span class="o">=</span>michelle
clusterrolebinding.rbac.authorization.k8s.io/michelle-storage-admin<span class="w"> </span>created
</code></pre></div>
</details>
<hr />
<h3 id="service-accounts">Service Accounts<a class="headerlink" href="#service-accounts" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>A service account is a type of non-human account that, in Kubernetes, provides a distinct identity in a Kubernetes cluster.</p>
</li>
<li>
<p>Application Pods, system components, and entities inside and outside the cluster can use a specific ServiceAccount's credentials to identify as that ServiceAccount.</p>
</li>
<li>
<p>Each service account is bound to a Kubernetes namespace. Every namespace gets a default ServiceAccount upon creation.</p>
</li>
</ul>
<hr />
<div class="admonition question">
<p>Which sercive account is used by deployment?</p>
</div>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  k get po web-dashboard-97c9c59f6-x2zdd -o yaml | grep -i service</span>

<span class="l l-Scalar l-Scalar-Plain">- mountPath</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/secrets/kubernetes.io/serviceaccount</span>
<span class="nt">enableServiceLinks</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">serviceAccount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">serviceAccountName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">- serviceAccountToken</span><span class="p p-Indicator">:</span>
</code></pre></div>
<hr />
<p>The application needs a ServiceAccount with the Right permissions to be created to authenticate to Kubernetes. The default ServiceAccount has limited access. Create a new ServiceAccount named dashboard-sa.</p>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>create<span class="w"> </span>sa<span class="w"> </span>dashboard-sa

serviceaccount/dashboard-sa<span class="w"> </span>created
</code></pre></div>
<hr />
<p>create a new token for a SA
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>create<span class="w"> </span>token<span class="w"> </span>dashboard-sa<span class="w"> </span>
</code></pre></div></p>
<h3 id="image-security">Image Security<a class="headerlink" href="#image-security" title="Permanent link">&para;</a></h3>
<p>What secret type must we choose for docker registry?
<div class="highlight"><pre><span></span><code>root@controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>create<span class="w"> </span>secret<span class="w"> </span>--help<span class="w"> </span>
Create<span class="w"> </span>a<span class="w"> </span>secret<span class="w"> </span>using<span class="w"> </span>specified<span class="w"> </span>subcommand.

Available<span class="w"> </span>Commands:
<span class="w">  </span>docker-registry<span class="w">   </span>Create<span class="w"> </span>a<span class="w"> </span>secret<span class="w"> </span><span class="k">for</span><span class="w"> </span>use<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>Docker<span class="w"> </span>registry<span class="w"> </span><span class="c1"># answer</span>
<span class="w">  </span>generic<span class="w">           </span>Create<span class="w"> </span>a<span class="w"> </span>secret<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span><span class="nb">local</span><span class="w"> </span>file,<span class="w"> </span>directory,<span class="w"> </span>or<span class="w"> </span>literal<span class="w"> </span>value
<span class="w">  </span>tls<span class="w">               </span>Create<span class="w"> </span>a<span class="w"> </span>TLS<span class="w"> </span>secret

Usage:
<span class="w">  </span>kubectl<span class="w"> </span>create<span class="w"> </span>secret<span class="w"> </span><span class="o">[</span>flags<span class="o">]</span><span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
</code></pre></div></p>
<hr />
<p>We decided to use a modified version of the application from an internal private registry. Update the image of the deployment to use a new image from myprivateregistry.com:5000</p>
<div class="highlight"><pre><span></span><code><span class="c1"># update the image as shown below</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myprivateregistry.com:5000/nginx:alpine</span>
<span class="w">        </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
</code></pre></div>
<p>Create a secret object with the credentials required to access the registry.</p>
<div class="highlight"><pre><span></span><code><span class="err">Name</span><span class="p">:</span><span class="w"> </span><span class="err">priva</span><span class="kc">te</span><span class="mi">-</span><span class="err">reg</span><span class="mi">-</span><span class="err">cred</span>
<span class="err">User</span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="err">dock_user</span>
<span class="err">Password</span><span class="p">:</span><span class="w"> </span><span class="err">dock_password</span>
<span class="err">Server</span><span class="p">:</span><span class="w"> </span><span class="err">mypriva</span><span class="kc">tere</span><span class="err">gis</span><span class="kc">tr</span><span class="err">y.com</span><span class="p">:</span><span class="mi">5000</span>
<span class="err">Email</span><span class="p">:</span><span class="w"> </span><span class="err">dock_user@mypriva</span><span class="kc">tere</span><span class="err">gis</span><span class="kc">tr</span><span class="err">y.com</span>
</code></pre></div>
<p>Create using below
<div class="highlight"><pre><span></span><code>root@controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>kubectl<span class="w"> </span>create<span class="w"> </span>secret<span class="w"> </span>docker-registry<span class="w"> </span>private-reg-cred<span class="w">   </span>--docker-email<span class="o">=</span>dock_user@myprivateregistry.com<span class="w">    </span>--docker-username<span class="o">=</span>dock_user<span class="w">   </span>--docker-password<span class="o">=</span>dock_password<span class="w">   </span>--docker-server<span class="o">=</span>myprivateregistry.com:5000

secret/private-reg-cred<span class="w"> </span>created
</code></pre></div></p>
<hr />
<p>Configure the deployment to use credentials from the new secret to pull images from the private registry</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Add the imagepull secret as shown below</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myprivateregistry.com:5000/nginx:alpine</span>
<span class="w">        </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">        </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">        </span><span class="nt">terminationMessagePath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/termination-log</span>
<span class="w">        </span><span class="nt">terminationMessagePolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">      </span><span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterFirst</span>
<span class="w">      </span><span class="nt">imagePullSecrets</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">private-reg-cred</span>
</code></pre></div>
<h3 id="security-contexts">Security Contexts<a class="headerlink" href="#security-contexts" title="Permanent link">&para;</a></h3>
<p>A security context defines privilege and access control settings for a Pod or Container. Security context settings include, but are not limited to:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Discretionary</span><span class="w"> </span><span class="n">Access</span><span class="w"> </span><span class="nl">Control:</span><span class="w"> </span><span class="n">Permission</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span><span class="p">,</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="p">(</span><span class="n">UID</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="p">(</span><span class="n">GID</span><span class="p">).</span>

<span class="n">Security</span><span class="w"> </span><span class="n">Enhanced</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="p">(</span><span class="n">SELinux</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">Objects</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">assigned</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">labels</span><span class="p">.</span>

<span class="n">Running</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">privileged</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">unprivileged</span><span class="p">.</span>

<span class="n">Linux</span><span class="w"> </span><span class="nl">Capabilities:</span><span class="w"> </span><span class="n">Give</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">privileges</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">user</span><span class="p">.</span>
</code></pre></div>

<hr />
<div class="highlight"><pre><span></span><code><span class="c1"># Sample Security Context </span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-context-demo</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">securityContext</span><span class="p">:</span><span class="w">  </span><span class="c1"># For container</span>
<span class="w">    </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">    </span><span class="nt">runAsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3000</span>
<span class="w">    </span><span class="nt">fsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sec-ctx-vol</span>
<span class="w">    </span><span class="nt">emptyDir</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sec-ctx-demo</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox:1.28</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;sh&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;-c&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;sleep</span><span class="nv"> </span><span class="s">1h&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sec-ctx-vol</span>
<span class="w">      </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/demo</span>
<span class="w">    </span><span class="nt">securityContext</span><span class="p">:</span><span class="w">   </span><span class="c1"># for Pod</span>
<span class="w">      </span><span class="nt">allowPrivilegeEscalation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>
<details class="question">
<summary>What is the user used to execute the sleep process within the ubuntu-sleeper pod?</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># Check the user by checking the security context or doing the exec -it</span>

controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>get<span class="w">  </span>po<span class="w"> </span>ubuntu-sleeper<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>securi
securityContext:<span class="w"> </span><span class="o">{}</span>



controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>ubuntu-sleeper<span class="w"> </span>--<span class="w"> </span>/bin/bash
root@ubuntu-sleeper:/#<span class="w"> </span>whoami
root
</code></pre></div>
</details>
<hr />
<details class="warning">
<summary>Edit the pod ubuntu-sleeper to run the sleep process with user ID 1010</summary>
<div class="highlight"><pre><span></span><code>spec:
containers:
-<span class="w"> </span>command:
<span class="w">    </span>-<span class="w"> </span>sleep
<span class="w">    </span>-<span class="w"> </span><span class="s2">&quot;4800&quot;</span>
<span class="w">    </span>image:<span class="w"> </span>ubuntu
<span class="w">    </span>imagePullPolicy:<span class="w"> </span>Always
<span class="w">    </span>name:<span class="w"> </span>ubuntu
<span class="w">    </span>resources:<span class="w"> </span><span class="o">{}</span>
<span class="w">    </span>terminationMessagePath:<span class="w"> </span>/dev/termination-log
<span class="w">    </span>terminationMessagePolicy:<span class="w"> </span>File
<span class="w">    </span>volumeMounts:
<span class="w">    </span>-<span class="w"> </span>mountPath:<span class="w"> </span>/var/run/secrets/kubernetes.io/serviceaccount
<span class="w">    </span>name:<span class="w"> </span>kube-api-access-grl6f
<span class="w">    </span>readOnly:<span class="w"> </span><span class="nb">true</span>
dnsPolicy:<span class="w"> </span>ClusterFirst
enableServiceLinks:<span class="w"> </span><span class="nb">true</span>
nodeName:<span class="w"> </span>controlplane
preemptionPolicy:<span class="w"> </span>PreemptLowerPriority
priority:<span class="w"> </span><span class="m">0</span>
restartPolicy:<span class="w"> </span>Always
schedulerName:<span class="w"> </span>default-scheduler
securityContext:
<span class="w">    </span>runAsUser:<span class="w"> </span><span class="m">1010</span><span class="w">  </span><span class="c1">## add this</span>
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>A Pod definition file named multi-pod.yaml is given. With what user are the processes in the web container started?</summary>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  cat multi-pod.yaml</span><span class="w"> </span>
<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multi-pod</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">securityContext</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1001</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sleep&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;5000&quot;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1002</span><span class="w">   </span><span class="c1"># ans is this as local will override the global user</span>

<span class="p p-Indicator">-</span><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sidecar</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sleep&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;5000&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>Update pod ubuntu-sleeper to run as Root user and with the SYS_TIME capability</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>cat<span class="w"> </span>multi-pod.yaml<span class="w"> </span>

apiVersion:<span class="w"> </span>v1
kind:<span class="w"> </span>Pod
metadata:
name:<span class="w"> </span>ubuntu-sleeper
spec:
containers:
-<span class="w">  </span>image:<span class="w"> </span>ubuntu
<span class="w">    </span>name:<span class="w"> </span>web
<span class="w">    </span>command:<span class="w"> </span><span class="o">[</span><span class="s2">&quot;sleep&quot;</span>,<span class="w"> </span><span class="s2">&quot;5000&quot;</span><span class="o">]</span>
<span class="w">    </span>securityContext:<span class="w">  </span><span class="c1"># added to the container, not the pod</span>
<span class="w">    </span>capabilities:
<span class="w">        </span>add:<span class="w">  </span><span class="o">[</span><span class="s2">&quot;SYS_TIME&quot;</span><span class="o">]</span><span class="w"> </span>
</code></pre></div>
</details>
<hr />
<h3 id="network-policies">Network Policies<a class="headerlink" href="#network-policies" title="Permanent link">&para;</a></h3>
<p>If you want to control traffic flow at the IP address or port level for TCP, UDP, and SCTP protocols, then you might consider using Kubernetes NetworkPolicies for particular applications in your cluster.</p>
<p>NetworkPolicies are an application-centric construct which allow you to specify how a pod is allowed to communicate with various network "entities" (we use the word "entity" here to avoid overloading the more common terms such as "endpoints" and "services", which have specific Kubernetes connotations) over the network</p>
<ul>
<li>By default, a pod is non-isolated for egress; all outbound connections are allowed.</li>
<li>By default, a pod is non-isolated for ingress; all inbound connections are allowed. </li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Network Plugin</p>
<p>`Network policies`` are implemented by the network plugin. To use network policies, you must be using a networking solution which supports NetworkPolicy. Creating a NetworkPolicy resource without a controller that implements it will have no effect.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># Network Policy Example</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-network-policy</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db</span>
<span class="w">  </span><span class="nt">policyTypes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Egress</span>
<span class="w">  </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">from</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ipBlock</span><span class="p">:</span>
<span class="w">            </span><span class="nt">cidr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.17.0.0/16</span>
<span class="w">            </span><span class="nt">except</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.17.1.0/24</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">namespaceSelector</span><span class="p">:</span>
<span class="w">            </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">              </span><span class="nt">project</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myproject</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">            </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">              </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">frontend</span>
<span class="w">      </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">          </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6379</span>
<span class="w">  </span><span class="nt">egress</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ipBlock</span><span class="p">:</span>
<span class="w">            </span><span class="nt">cidr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.0/24</span>
<span class="w">      </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">          </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5978</span>
</code></pre></div>
<details class="warning">
<summary>Default deny egress</summary>
<div class="highlight"><pre><span></span><code><span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-deny-egress</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">podSelector</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">policyTypes</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Egress</span>
</code></pre></div>
</details>
<hr />
<details class="success">
<summary>Default allow egress</summary>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">allow-all-egress</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">podSelector</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">egress</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w">   </span><span class="c1"># egress is defined here</span>
<span class="nt">policyTypes</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Egress</span>
</code></pre></div>
</details>
<hr />
<details class="error">
<summary>Default deny all ingress and all egress traffic</summary>
<div class="highlight"><pre><span></span><code><span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-deny-all</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">podSelector</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">policyTypes</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Egress</span>
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>What is meaning of this policy?</summary>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  k describe networkpolicies.networking.k8s.io payroll-policy</span>
<span class="l l-Scalar l-Scalar-Plain">Name</span><span class="p p-Indicator">:</span><span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">payroll-policy</span>
<span class="nt">Namespace</span><span class="p">:</span><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">Created on</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">2023-11-20 22:47:02 -0500 EST</span>
<span class="nt">Labels</span><span class="p">:</span><span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">&lt;none&gt;</span>
<span class="nt">Annotations</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">&lt;none&gt;</span>
<span class="nt">Spec</span><span class="p">:</span>
<span class="nt">PodSelector</span><span class="p">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">name=payroll</span>
<span class="nt">Allowing ingress traffic</span><span class="p">:</span>
<span class="w">    </span><span class="nt">To Port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080/TCP</span>
<span class="w">    </span><span class="nt">From</span><span class="p">:</span>
<span class="w">    </span><span class="nt">PodSelector</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name=internal</span><span class="w">  </span><span class="c1"># traffic from internal pod to payroll pod is allowed</span>
<span class="l l-Scalar l-Scalar-Plain">Not affecting egress traffic</span>
<span class="nt">Policy Types</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
</code></pre></div>
</details>
<hr />
<details class="note">
<summary>Use the spec given below. You might want to enable ingress traffic to the pod to test your rules in the UI</summary>
<p>Policy Name: internal-policy</p>
<p>Policy Type: Egress</p>
<p>Egress Allow: payroll</p>
<p>Payroll Port: 8080</p>
<p>Egress Allow: mysql</p>
<p>MySQL Port: 3306</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal-policy</span>
<span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">policyTypes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Egress</span>
<span class="nt">ingress</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w">  </span><span class="p p-Indicator">{}</span>
<span class="nt">egress</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">            </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">payroll</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">        </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">            </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">        </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3306</span>
</code></pre></div>
</details>
<hr />
<h2 id="storage">Storage<a class="headerlink" href="#storage" title="Permanent link">&para;</a></h2>
<h3 id="pv-and-pvc">PV and PVC<a class="headerlink" href="#pv-and-pvc" title="Permanent link">&para;</a></h3>
<p>A PersistentVolume (PV) is a piece of storage in the cluster that has been provisioned by an administrator or dynamically provisioned using Storage Classes. It is a resource in the cluster just like a node is a cluster resource. PVs are volume plugins like Volumes, but have a lifecycle independent of any individual Pod that uses the PV.</p>
<p>A PersistentVolumeClaim (PVC) is a request for storage by a user. It is similar to a Pod. Pods consume node resources and PVCs consume PV resources. Pods can request specific levels of resources (CPU and Memory). Claims can request specific size and access modes (e.g., they can be mounted ReadWriteOnce, ReadOnlyMany or ReadWriteMany</p>
<div class="admonition important">
<p class="admonition-title">Reclaim Policy</p>
<p>When a user is done with their volume, they can delete the PVC objects from the API that allows reclamation of the resource. The reclaim policy for a PersistentVolume tells the cluster what to do with the volume after it has been released of its claim. Currently, volumes can either be Retained, Recycled, or Deleted.</p>
<ul>
<li>Retain reclaim policy allows for manual reclamation of the resource. When the PersistentVolumeClaim is deleted, the PersistentVolume still exists and the volume is considered "released". But it is not yet available for another claim because the previous claimant's data remains on the volume. </li>
<li>For volume plugins that support the Delete reclaim policy, deletion removes both the PersistentVolume object from Kubernetes, as well as the associated storage asset in the external infrastructure, such as an AWS EBS or GCE PD volume.</li>
<li>If supported by the underlying volume plugin, the Recycle reclaim policy performs a basic scrub (rm -rf /thevolume/*) on the volume and makes it available again for a new claim.</li>
</ul>
</div>
<hr />
<details class="question">
<summary>Configure a volume to store these logs at /var/log/webapp on the host using</summary>
<p>Name: webapp
Image Name: kodekloud/event-simulator
Volume HostPath: /var/log/webapp
Volume Mount: /log</p>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ✖ cat po.yaml</span>

<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webapp</span>
<span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kodekloud/event-simulator</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">imagePullPolicy</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event-simulator</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/log</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-vol</span>
<span class="w">    </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-vol</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">hostPath</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="c1"># directory location on host</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/webapp</span>
<span class="w">    </span><span class="c1"># this field is optional</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Directory</span>
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Create a Persistent Volume with the given specification</summary>
<div class="codehilite"><pre><span></span><code>Volume Name: pv-log
Storage: 100Mi
Access Modes: ReadWriteMany
Host Path: /pv/log
Reclaim Policy: Retain
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  cat pv1.yaml</span><span class="w"> </span>

<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PersistentVolume</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pv-log</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">capacity</span><span class="p">:</span>
<span class="w">    </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100Mi</span>
<span class="nt">hostPath</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/pv/log</span>
<span class="nt">accessModes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteMany</span>
<span class="nt">persistentVolumeReclaimPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Retain</span>
</code></pre></div>
</details>
<hr />
<details class="warning">
<summary>Let us claim some of that storage for our application. Create a Persistent Volume Claim with the given specification</summary>
<p>Volume Name: claim-log-1
Storage Request: 50Mi
Access Modes: ReadWriteOnce</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">claim-log-1</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">accessModes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="w">    </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">    </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50Mi</span>
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>Check if the claim is bound or not?</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>✖<span class="w"> </span>k<span class="w"> </span>get<span class="w"> </span>pv,pvc
NAME<span class="w">                      </span>CAPACITY<span class="w">   </span>ACCESS<span class="w"> </span>MODES<span class="w">   </span>RECLAIM<span class="w"> </span>POLICY<span class="w">   </span>STATUS<span class="w">   </span>CLAIM<span class="w">                 </span>STORAGECLASS<span class="w">   </span>REASON<span class="w">   </span>AGE
persistentvolume/pv-log<span class="w">   </span>100Mi<span class="w">      </span>RWX<span class="w">            </span>Retain<span class="w">           </span>Bound<span class="w">    </span>default/claim-log-1<span class="w">                           </span>5m56s

NAME<span class="w">                                </span>STATUS<span class="w">   </span>VOLUME<span class="w">   </span>CAPACITY<span class="w">   </span>ACCESS<span class="w"> </span>MODES<span class="w">   </span>STORAGECLASS<span class="w">   </span>AGE
persistentvolumeclaim/claim-log-1<span class="w">   </span>Bound<span class="w">    </span>pv-log<span class="w">   </span>100Mi<span class="w">      </span>RWX<span class="w">                           </span>13s
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Update the webapp pod to use the persistent volume claim as its storage</summary>
<p>Replace hostPath configured earlier with the newly created PersistentVolumeClaim.</p>
<div class="codehilite"><pre><span></span><code><span class="n">Name</span><span class="o">:</span><span class="w"> </span><span class="n">webapp</span>

<span class="n">Image</span><span class="w"> </span><span class="n">Name</span><span class="o">:</span><span class="w"> </span><span class="n">kodekloud</span><span class="o">/</span><span class="n">event</span><span class="o">-</span><span class="n">simulator</span>

<span class="n">Volume</span><span class="o">:</span><span class="w"> </span><span class="n">PersistentVolumeClaim</span><span class="o">=</span><span class="n">claim</span><span class="o">-</span><span class="n">log</span><span class="o">-</span><span class="mi">1</span>

<span class="n">Volume</span><span class="w"> </span><span class="n">Mount</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">log</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webapp</span>
<span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kodekloud/event-simulator</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">imagePullPolicy</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event-simulator</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/log</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pv-claim</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pv-claim</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">persistentVolumeClaim</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="nt">claimName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">claim-log-1</span>
</code></pre></div>
</details>
<hr />
<h3 id="storage-class">Storage Class<a class="headerlink" href="#storage-class" title="Permanent link">&para;</a></h3>
<p>A StorageClass provides a way for administrators to describe the "classes" of storage they offer. Different classes might map to quality-of-service levels, or to backup policies, or to arbitrary policies determined by the cluster administrators.</p>
<p>When a PVC does not specify a storageClassName, the default StorageClass is used. The cluster can only have one default StorageClass</p>
<div class="highlight"><pre><span></span><code><span class="c1"># SC example</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">storage.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StorageClass</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">standard</span>
<span class="nt">provisioner</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/aws-ebs</span>
<span class="nt">parameters</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gp2</span>
<span class="nt">reclaimPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Retain</span>
<span class="nt">allowVolumeExpansion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">mountOptions</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">debug</span>
<span class="nt">volumeBindingMode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Immediate</span>
</code></pre></div>
<hr />
<details class="warning">
<summary>Create a new PersistentVolumeClaim by the name of local-pvc that should bind to the volume local-pv</summary>
<p>Inspect the pv local-pv for the specs.</p>
<div class="codehilite"><pre><span></span><code><span class="n">PVC</span><span class="o">:</span><span class="w"> </span><span class="n">local</span><span class="o">-</span><span class="n">pvc</span>

<span class="n">Correct</span><span class="w"> </span><span class="n">Access</span><span class="w"> </span><span class="n">Mode</span><span class="o">?</span>

<span class="n">Correct</span><span class="w"> </span><span class="n">StorageClass</span><span class="w"> </span><span class="n">Used</span><span class="o">?</span>

<span class="n">PVC</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">volume</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span><span class="n">Mi</span><span class="o">?</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  cat pvc.yaml</span><span class="w"> </span>

<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local-pvc</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">accessModes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<span class="nt">volumeMode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Filesystem</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="w">    </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">    </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500Mi</span>
<span class="nt">storageClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local-storage</span>
</code></pre></div>
</details>
<hr />
<details>
<summary>Why is the PVC in a pending state despite making a valid request to claim the volume called local-pv?</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># The StorageClass used by the PVC uses WaitForFirstConsumer volume binding mode. This means that the persistent volume will not bind to the claim until a pod makes use of the PVC to request storage.</span>
controlplane<span class="w"> </span>~<span class="w"> </span>✖<span class="w">  </span>k<span class="w"> </span>describe<span class="w"> </span>pvc<span class="w"> </span>local-pvc<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-A4<span class="w"> </span>Events
Events:
Type<span class="w">    </span>Reason<span class="w">                </span>Age<span class="w">                   </span>From<span class="w">                         </span>Message
----<span class="w">    </span>------<span class="w">                </span>----<span class="w">                  </span>----<span class="w">                         </span>-------
Normal<span class="w">  </span>WaitForFirstConsumer<span class="w">  </span>11s<span class="w"> </span><span class="o">(</span>x16<span class="w"> </span>over<span class="w"> </span>3m47s<span class="o">)</span><span class="w">  </span>persistentvolume-controller<span class="w">  </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>first<span class="w"> </span>consumer<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>created<span class="w"> </span>before<span class="w"> </span>binding
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Create a new pod called nginx with the image nginx:alpine. The Pod should make use of the PVC local-pvc and mount the volume at the path /var/www/html</summary>
<p>The PV local-pv should be in a bound state.</p>
<div class="codehilite"><pre><span></span><code>Pod created with the correct Image?

Pod uses PVC called local-pvc?

local-pv bound?

nginx pod running?

Volume mounted at the correct path?
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx:alpine</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">volumeMounts</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/html&quot;</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mypd</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mypd</span>
<span class="w">    </span><span class="nt">persistentVolumeClaim</span><span class="p">:</span>
<span class="w">        </span><span class="nt">claimName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local-pvc</span>
<span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterFirst</span>
<span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
</details>
<hr />
<details class="note">
<summary>Create a new Storage Class called delayed-volume-sc that makes use of the below specs:</summary>
<p>provisioner: kubernetes.io/no-provisioner</p>
<p>volumeBindingMode: WaitForFirstConsumer</p>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  cat sc.yaml</span><span class="w"> </span>

<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">storage.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StorageClass</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delayed-volume-sc</span>
<span class="nt">provisioner</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/no-provisioner</span>
<span class="nt">volumeBindingMode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WaitForFirstConsumer</span>
</code></pre></div>
</details>
<h2 id="networking">Networking<a class="headerlink" href="#networking" title="Permanent link">&para;</a></h2>
<details class="warning">
<summary>What is the network interface configured for cluster connectivity on the controlplane node?</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>✖<span class="w"> </span>k<span class="w"> </span>get<span class="w"> </span>no<span class="w"> </span>-o<span class="w"> </span>wide
NAME<span class="w">           </span>STATUS<span class="w">   </span>ROLES<span class="w">           </span>AGE<span class="w">     </span>VERSION<span class="w">   </span>INTERNAL-IP<span class="w">   </span>EXTERNAL-IP<span class="w">   </span>OS-IMAGE<span class="w">             </span>KERNEL-VERSION<span class="w">   </span>CONTAINER-RUNTIME
controlplane<span class="w">   </span>Ready<span class="w">    </span>control-plane<span class="w">   </span>9m2s<span class="w">    </span>v1.27.0<span class="w">   </span><span class="m">192</span>.9.180.3<span class="w">   </span>&lt;none&gt;<span class="w">        </span>Ubuntu<span class="w"> </span><span class="m">20</span>.04.5<span class="w"> </span>LTS<span class="w">   </span><span class="m">5</span>.4.0-1106-gcp<span class="w">   </span>containerd://1.6.6<span class="w">  </span><span class="c1"># get the IP for controlPlane</span>
node01<span class="w">         </span>Ready<span class="w">    </span>&lt;none&gt;<span class="w">          </span>8m37s<span class="w">   </span>v1.27.0<span class="w">   </span><span class="m">192</span>.9.180.6<span class="w">   </span>&lt;none&gt;<span class="w">        </span>Ubuntu<span class="w"> </span><span class="m">20</span>.04.5<span class="w"> </span>LTS<span class="w">   </span><span class="m">5</span>.4.0-1106-gcp<span class="w">   </span>containerd://1.6.6


controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>ip<span class="w"> </span>a<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-B3<span class="w"> </span><span class="m">192</span>.9.180.3<span class="w"> </span><span class="c1"># get the interface from the IP</span>
<span class="m">366</span>:<span class="w"> </span>eth0@if367:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1450</span><span class="w"> </span>qdisc<span class="w"> </span>noqueue<span class="w"> </span>state<span class="w"> </span>UP<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>
<span class="w">    </span>link/ether<span class="w"> </span><span class="m">02</span>:42:c0:09:b4:03<span class="w"> </span>brd<span class="w"> </span>ff:ff:ff:ff:ff:ff<span class="w"> </span>link-netnsid<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>inet<span class="w"> </span><span class="m">192</span>.9.180.3/24<span class="w"> </span>brd<span class="w"> </span><span class="m">192</span>.9.180.255<span class="w"> </span>scope<span class="w"> </span>global<span class="w"> </span>eth0
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Get the IP of default gateway</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>ip<span class="w"> </span>route<span class="w"> </span>show<span class="w"> </span>default

default<span class="w"> </span>via<span class="w"> </span><span class="m">172</span>.25.0.1<span class="w"> </span>dev<span class="w"> </span>eth1<span class="w"> </span>
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>What is the port the kube-scheduler is listening on in the controlplane node?</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>netstat<span class="w"> </span>-lntp<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>scheduler

tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.1:10259<span class="w">         </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">3586</span>/kube-scheduler<span class="w"> </span>
</code></pre></div>
</details>
<hr />
<details class="note">
<summary>Notice that ETCD is listening on two ports. Which of these have more client connections established?</summary>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>netstat<span class="w"> </span>-lntp<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>etcd
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">192</span>.9.180.3:2379<span class="w">        </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">3600</span>/etcd<span class="w">           </span>
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.1:2379<span class="w">          </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">3600</span>/etcd<span class="w">           </span>
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">192</span>.9.180.3:2380<span class="w">        </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">3600</span>/etcd<span class="w">           </span>
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.1:2381<span class="w">          </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">3600</span>/etcd<span class="w">  </span>
</code></pre></div>
</details>
<h3 id="cni">CNI<a class="headerlink" href="#cni" title="Permanent link">&para;</a></h3>
<p>Networking is a central part of Kubernetes, but it can be challenging to understand exactly how it is expected to work. There are 4 distinct networking problems to address:</p>
<div class="codehilite"><pre><span></span><code>Highly-coupled container-to-container communications: this is solved by Pods and localhost communications.
Pod-to-Pod communications: this is the primary focus of this document.
Pod-to-Service communications: this is covered by Services.
External-to-Service communications: this is also covered by Services.
</code></pre></div>

<p>CNI (Container Network Interface), a Cloud Native Computing Foundation project, consists of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. CNI concerns itself only with network connectivity of containers and removing allocated resources when the container is deleted. Because of this focus, CNI has a wide range of support and the specification is simple to implement.</p>
<hr />
<p>Inspect the kubelet service and identify the container runtime endpoint value is set for Kubernetes.</p>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>ps<span class="w"> </span>aux<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>kubelet<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>endpoint

root<span class="w">        </span><span class="m">4567</span><span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">3848468</span><span class="w"> </span><span class="m">99736</span><span class="w"> </span>?<span class="w">       </span>Ssl<span class="w">  </span><span class="m">01</span>:06<span class="w">   </span><span class="m">0</span>:06<span class="w"> </span>/usr/bin/kubelet<span class="w"> </span>--bootstrap-kubeconfig<span class="o">=</span>/etc/kubernetes/bootstrap-kubelet.conf<span class="w"> </span>--kubeconfig<span class="o">=</span>/etc/kubernetes/kubelet.conf<span class="w"> </span>--config<span class="o">=</span>/var/lib/kubelet/config.yaml<span class="w"> </span>--container-runtime-endpoint<span class="o">=</span>unix:///var/run/containerd/containerd.sock<span class="w"> </span>--pod-infra-container-image<span class="o">=</span>registry.k8s.io/pause:3.9
</code></pre></div>
<hr />
<details class="question">
<summary>Identify which of the below plugins is not available in the list of available CNI plugins on this host?</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># check the below path</span>

controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>ls<span class="w"> </span>/opt/cni/bin/
bandwidth<span class="w">  </span>dhcp<span class="w">   </span>firewall<span class="w">  </span>host-device<span class="w">  </span>ipvlan<span class="w">    </span>macvlan<span class="w">  </span>ptp<span class="w">  </span>static<span class="w">  </span>vlan
bridge<span class="w">     </span>dummy<span class="w">  </span>flannel<span class="w">   </span>host-local<span class="w">   </span>loopback<span class="w">  </span>portmap<span class="w">  </span>sbr<span class="w">  </span>tuning<span class="w">  </span>vrf
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>What is the CNI plugin configured to be used on this kubernetes cluster?</summary>
<div class="highlight"><pre><span></span><code>Run<span class="w"> </span>the<span class="w"> </span>command:<span class="w"> </span><span class="sb">`</span>ls<span class="w"> </span>/etc/cni/net.d/<span class="sb">``</span><span class="w"> </span>and<span class="w"> </span>identify<span class="w"> </span>the<span class="w"> </span>name<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>plugin.
</code></pre></div>
</details>
<h2 id="kubeadm">Kubeadm<a class="headerlink" href="#kubeadm" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>kubeadm<span class="w"> </span>upgrade<span class="w"> </span>plan<span class="w"> </span><span class="o">[</span>version<span class="o">]</span>
</code></pre></div>
<h2 id="lightning-lab">Lightning Lab<a class="headerlink" href="#lightning-lab" title="Permanent link">&para;</a></h2>
<details>
<summary> Upgrade the current version of kubernetes from `1.26.0` to `1.27.0` exactly using the kubeadm utility.</summary>

There is currently an issue with this lab which requires an extra step. This may be addressed in the near future. 

On controlplane node

1. Drain node

    <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>drain<span class="w"> </span>controlplane<span class="w"> </span>--ignore-daemonsets
</code></pre></div>

2. Upgrade kubeadm

    <div class="highlight"><pre><span></span><code>apt-get<span class="w"> </span>update
apt-mark<span class="w"> </span>unhold<span class="w"> </span>kubeadm
apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="nv">kubeadm</span><span class="o">=</span><span class="m">1</span>.27.0-00
</code></pre></div>

3. Plan and apply upgrade

    <div class="highlight"><pre><span></span><code>kubeadm<span class="w"> </span>upgrade<span class="w"> </span>plan
kubeadm<span class="w"> </span>upgrade<span class="w"> </span>apply<span class="w"> </span>v1.27.0
</code></pre></div>

4. Remove taint on controlplane node. This is the issue described above. As part of the upgrade specifically to 1.26, some taints are added to all controlplane nodes. This will prevent the `gold-nginx` pod from being rescheduled to the controlplane node later on.

    <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>describe<span class="w"> </span>node<span class="w"> </span>controlplane<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">3</span><span class="w"> </span>taint
</code></pre></div>

    Output:

    <div class="highlight"><pre><span></span><code>Taints:<span class="w">   </span>node-role.kubernetes.io/control-plane:NoSchedule
<span class="w">            </span>node.kubernetes.io/unschedulable:NoSchedule
</code></pre></div>

    Let's remove them

    <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>taint<span class="w"> </span>node<span class="w"> </span>controlplane<span class="w"> </span>node-role.kubernetes.io/control-plane:NoSchedule-
kubectl<span class="w"> </span>taint<span class="w"> </span>node<span class="w"> </span>controlplane<span class="w"> </span>node.kubernetes.io/unschedulable:NoSchedule-
</code></pre></div>

5. Upgrade the kubelet

    <div class="highlight"><pre><span></span><code>apt-mark<span class="w"> </span>unhold<span class="w"> </span>kubelet
apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="nv">kubelet</span><span class="o">=</span><span class="m">1</span>.27.0-00
systemctl<span class="w"> </span>daemon-reload
systemctl<span class="w"> </span>restart<span class="w"> </span>kubelet
</code></pre></div>

6. Reinstate controlplane node

    <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>uncordon<span class="w"> </span>controlplane
</code></pre></div>

7. Upgrade kubectl

    <div class="highlight"><pre><span></span><code>apt-mark<span class="w"> </span>unhold<span class="w"> </span>kubectl
apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="nv">kubectl</span><span class="o">=</span><span class="m">1</span>.27.0-00
</code></pre></div>

8. Re-hold packages

    <div class="highlight"><pre><span></span><code>apt-mark<span class="w"> </span>hold<span class="w"> </span>kubeadm<span class="w"> </span>kubelet<span class="w"> </span>kubectl
</code></pre></div>

9. Drain the worker node

    <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>drain<span class="w"> </span>node01<span class="w"> </span>--ignore-daemonsets
</code></pre></div>

10. Go to worker node

    <div class="highlight"><pre><span></span><code>ssh<span class="w"> </span>node01
</code></pre></div>

11. Upgrade kubeadm

    <div class="highlight"><pre><span></span><code>apt-get<span class="w"> </span>update
apt-mark<span class="w"> </span>unhold<span class="w"> </span>kubeadm
apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="nv">kubeadm</span><span class="o">=</span><span class="m">1</span>.27.0-00
</code></pre></div>

12. Upgrade node

    <div class="highlight"><pre><span></span><code>kubeadm<span class="w"> </span>upgrade<span class="w"> </span>node
</code></pre></div>

13. Upgrade the kubelet

    <div class="highlight"><pre><span></span><code>apt-mark<span class="w"> </span>unhold<span class="w"> </span>kubelet
apt-get<span class="w"> </span>install<span class="w"> </span><span class="nv">kubelet</span><span class="o">=</span><span class="m">1</span>.27.0-00
systemctl<span class="w"> </span>daemon-reload
systemctl<span class="w"> </span>restart<span class="w"> </span>kubelet
</code></pre></div>

14. Re-hold packages

    <div class="highlight"><pre><span></span><code>apt-mark<span class="w"> </span>hold<span class="w"> </span>kubeadm<span class="w"> </span>kubelet
</code></pre></div>

15. Return to controlplane

    <div class="highlight"><pre><span></span><code><span class="nb">exit</span>
</code></pre></div>

16. Reinstate worker node

    <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>uncordon<span class="w"> </span>node01
</code></pre></div>

17. Verify `gold-nginx` is scheduled on controlplane node

    <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-o<span class="w"> </span>wide<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>gold-nginx
</code></pre></div>
</details>

<hr />
<details class="warning">
<summary>Print the names of all deployments in the admin2406 namespace in the following format</summary>
<p>This is a job for <code>custom-columns</code> output of kubectl</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>-n<span class="w"> </span>admin2406<span class="w"> </span>get<span class="w"> </span>deployment<span class="w"> </span>-o<span class="w"> </span>custom-columns<span class="o">=</span>DEPLOYMENT:.metadata.name,CONTAINER_IMAGE:.spec.template.spec.containers<span class="o">[]</span>.image,READY_REPLICAS:.status.readyReplicas,NAMESPACE:.metadata.namespace<span class="w"> </span>--sort-by<span class="o">=</span>.metadata.name<span class="w"> </span>&gt;<span class="w"> </span>/opt/admin2406_data
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>A kubeconfig file called admin.kubeconfig has been created in /root/CKA. There is something wrong with the configuration. Troubleshoot and fix it</summary>
<p>First, let's test this kubeconfig</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>--kubeconfig<span class="w"> </span>/root/CKA/admin.kubeconfig
</code></pre></div>
<p>Notice the error message.</p>
<p>Now look at the default kubeconfig for the correct setting.</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>~/.kube/config
</code></pre></div>
<p>Make the correction</p>
<div class="highlight"><pre><span></span><code>vi<span class="w"> </span>/root/CKA/admin.kubeconfig
</code></pre></div>
<p>Test</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>--kubeconfig<span class="w"> </span>/root/CKA/admin.kubeconfig
</code></pre></div>
</details>
<hr />
<details class="note">
<summary>Create a new deployment called nginx-deploy, with image nginx:1.16 and 1 replica. Next upgrade the deployment to version 1.17 using rolling update.</summary>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>create<span class="w"> </span>deployment<span class="w"> </span>nginx-deploy<span class="w"> </span>--image<span class="o">=</span>nginx:1.16
kubectl<span class="w"> </span><span class="nb">set</span><span class="w"> </span>image<span class="w"> </span>deployment/nginx-deploy<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span>nginx:1.17<span class="w"> </span>--record
</code></pre></div>
<p>You may ignore the deprecation warning.</p>
</details>
<hr />
<details class="info">
<summary>A new deployment called alpha-mysql has been deployed in the alpha namespace. However, the pods are not running. Troubleshoot and fix the issue</summary>
<p>The deployment should make use of the persistent volume alpha-pv to be mounted at /var/lib/mysql and should use the environment variable MYSQL_ALLOW_EMPTY_PASSWORD=1 to make use of an empty root password.</p>
<p>Important: Do not alter the persistent volume.</p>
<p>Inspect the deployment to check the environment variable is set. Here I'm using <code>yq</code> which is like <code>jq</code> but for YAML to not have to view the <em>entire</em> deployment YAML, just the section beneath <code>containers</code> in the deployment spec.</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>deployment<span class="w"> </span>-n<span class="w"> </span>alpha<span class="w"> </span>alpha-mysql<span class="w">  </span>-o<span class="w"> </span>yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>yq<span class="w"> </span>e<span class="w"> </span>.spec.template.spec.containers<span class="w"> </span>-
</code></pre></div>
<p>Find out why the deployment does not have minimum availability. We'll have to find out the name of the deployment's pod first, then describe the pod to see the error.</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>alpha
kubectl<span class="w"> </span>describe<span class="w"> </span>pod<span class="w"> </span>-n<span class="w"> </span>alpha<span class="w"> </span>alpha-mysql-xxxxxxxx-xxxxx
</code></pre></div>
<p>We find that the requested PVC isn't present, so create it. First, examine the Persistent Volume to find the values for access modes, capacity (storage), and storage class name</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pv<span class="w"> </span>alpha-pv
</code></pre></div>
<p>Now use <code>vi</code> to create a PVC manifest</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-alpha-pvc</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alpha</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">accessModes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">    </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1Gi</span>
<span class="w">  </span><span class="nt">storageClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slow</span>
</code></pre></div>
</details>
<hr />
<details class="remember">
<summary>Take the backup of ETCD at the location <code>/opt/etcd-backup.db</code> on the controlplane node</summary>
<p>This question is a bit poorly worded. It requires us to make a backup of etcd and store the backup at the given location.
Know that the certificates we need for authentication of <code>etcdctl</code> are located in <code>/etc/kubernetes/pki/etcd</code></p>
<p>Get the certificates as shown below</p>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span>get<span class="w"> </span>pod<span class="w"> </span>etcd-controlplane<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>crt
-<span class="w"> </span>--cert-file<span class="o">=</span>/etc/kubernetes/pki/etcd/server.crt
-<span class="w"> </span>--peer-cert-file<span class="o">=</span>/etc/kubernetes/pki/etcd/peer.crt
-<span class="w"> </span>--peer-trusted-ca-file<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt
-<span class="w"> </span>--trusted-ca-file<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt
</code></pre></div>
<p>Get the command to take backup from docs</p>
<div class="highlight"><pre><span></span><code><span class="nv">ETCDCTL_API</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="w"> </span>etcdctl<span class="w"> </span>snapshot<span class="w"> </span>save<span class="w"> </span>/opt/etcd-backup.db<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--cacert<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--cert<span class="o">=</span>/etc/kubernetes/pki/etcd/server.crt<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--key<span class="o">=</span>/etc/kubernetes/pki/etcd/server.key<span class="w"> </span>
</code></pre></div>
<p>check if backup is taken using
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~<span class="w"> </span>➜<span class="w">  </span><span class="nv">ETCDCTL_API</span><span class="o">=</span><span class="m">3</span><span class="w"> </span>etcdctl<span class="w"> </span>--write-out<span class="o">=</span>table<span class="w"> </span>snapshot<span class="w"> </span>status<span class="w"> </span>/opt/etcd-backup.db<span class="w"> </span>
+----------+----------+------------+------------+
<span class="p">|</span><span class="w">   </span>HASH<span class="w">   </span><span class="p">|</span><span class="w"> </span>REVISION<span class="w"> </span><span class="p">|</span><span class="w"> </span>TOTAL<span class="w"> </span>KEYS<span class="w"> </span><span class="p">|</span><span class="w"> </span>TOTAL<span class="w"> </span>SIZE<span class="w"> </span><span class="p">|</span>
+----------+----------+------------+------------+
<span class="p">|</span><span class="w"> </span>bc0cb4cf<span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">5914</span><span class="w"> </span><span class="p">|</span><span class="w">        </span><span class="m">973</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">2</span>.2<span class="w"> </span>MB<span class="w"> </span><span class="p">|</span>
+----------+----------+------------+------------+
</code></pre></div></p>
<p>Whilst we <em>could</em> also use the argument <code>--endpoints=127.0.0.1:2379</code>, it is not necessary here as we are on the controlplane node, same as <code>etcd</code> itself. The default endpoint is the local host.</p>
</details>
<hr />
<details class="example">
<summary>Create a pod called secret-1401 in the admin1401 namespace using the busybox image</summary>
<p>The container within the pod should be called <code>secret-admin</code> and should sleep for 4800 seconds. The container should mount a read-only secret volume called secret-volume at the path <code>/etc/secret-volume</code>. The secret being mounted has already been created for you and is called <code>dotfile-secret</code>.</p>
<ol>
<li>
<p>Use imperative command to get a starter manifest</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>run<span class="w"> </span>secret-1401<span class="w"> </span>-n<span class="w"> </span>admin1401<span class="w"> </span>--image<span class="w"> </span>busybox<span class="w"> </span>--dry-run<span class="o">=</span>client<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>--command<span class="w"> </span>--<span class="w"> </span>sleep<span class="w"> </span><span class="m">4800</span><span class="w"> </span>&gt;<span class="w"> </span>admin.yaml
</code></pre></div>
</li>
<li>
<p>Edit this manifest to add in the details for mounting the secret</p>
<div class="highlight"><pre><span></span><code>vi<span class="w"> </span>admin.yaml
</code></pre></div>
<p>Add in the volume and volume mount sections seen below</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret-1401</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret-1401</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin1401</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret-volume</span>
<span class="w">    </span><span class="nt">secret</span><span class="p">:</span>
<span class="w">      </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dotfile-secret</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">command</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sleep</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;4800&quot;</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret-admin</span>
<span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret-volume</span>
<span class="w">      </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/secret-volume</span>
</code></pre></div>
</li>
<li>
<p>And create the pod</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>admin.yaml
</code></pre></div>
</li>
</ol>
</details>
<h2 id="mock-exam">Mock Exam<a class="headerlink" href="#mock-exam" title="Permanent link">&para;</a></h2>
<details class="note">
<summary>Deploy a pod named nginx-pod using the nginx:alpine image.</summary>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-pod</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-pod</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx:alpine</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-pod</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterFirst</span>
<span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
</details>
<hr />
<details class="important">
<summary>Deploy a messaging pod using the redis:alpine image with the labels set to tier=msg.</summary>
<p>Run below command which create a pod with labels:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>run<span class="w"> </span>messaging<span class="w"> </span>--image<span class="o">=</span>redis:alpine<span class="w"> </span>--labels<span class="o">=</span><span class="nv">tier</span><span class="o">=</span>msg
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Create a namespace named apx-x9984574</summary>
<p>Run below command to create a namespace:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span>kubectl<span class="w"> </span>create<span class="w"> </span>namespace<span class="w"> </span>apx-x9984574
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Get the list of nodes in JSON format and store it in a file at /opt/outputs/nodes-z3444kd9.json.</summary>
<p>Use the below command which will redirect the o/p:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span>&gt;<span class="w"> </span>/opt/outputs/nodes-z3444kd9.json
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>Create a service messaging-service to expose the messaging application within the cluster on port 6379.</summary>
<p>Execute below command which will expose the pod on port 6379:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>expose<span class="w"> </span>pod<span class="w"> </span>messaging<span class="w"> </span>--port<span class="o">=</span><span class="m">6379</span><span class="w"> </span>--name<span class="w"> </span>messaging-service
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Create a deployment named hr-web-app using the image kodekloud/webapp-color with 2 replicas.</summary>
<p>In v1.19, we can add <code>--replicas</code> flag with <code>kubectl create deployment</code> command:</p>
<p><div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>create<span class="w"> </span>deployment<span class="w"> </span>hr-web-app<span class="w"> </span>--image<span class="o">=</span>kodekloud/webapp-color<span class="w"> </span>--replicas<span class="o">=</span><span class="m">2</span>
</code></pre></div>
 </details></p>
</details>
<hr />
<details class="question">
<summary>Create a static pod named static-busybox on the controlplane node that uses the busybox image and the command sleep 1000.</summary>
<p>To Create a static pod, copy it to the static pods directory. In this case, it is <code>/etc/kubernetes/manifests</code>. Apply below manifests:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>k<span class="w"> </span>run<span class="w"> </span>static-busybox<span class="w"> </span>--image<span class="o">=</span>busybox<span class="w"> </span>--command<span class="w"> </span>sleep<span class="w"> </span><span class="m">1000</span><span class="w"> </span>--dry-run<span class="o">=</span>client<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span>static-busybox.yaml
</code></pre></div>
<p>This will create the below manifest</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">static-busybox</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">static-busybox</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">command</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sleep</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">static-busybox</span>
<span class="w">    </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">  </span><span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterFirst</span>
<span class="w">  </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
</details>
<hr />
<details class="note">
<summary>Create a POD in the finance namespace named temp-bus with the image redis:alpine.</summary>
<p>Run below command to create a pod in namespace <code>finance</code>:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>run<span class="w"> </span>temp-bus<span class="w"> </span>--image<span class="o">=</span>redis:alpine<span class="w"> </span>-n<span class="w"> </span>finance
</code></pre></div>
</details>
<hr />
<details class="warning">
<summary>A new application orange is deployed. There is something wrong with it. Identify and fix the issue.</summary>
<p>Run below command and troubleshoot step by step:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>describe<span class="w"> </span>pod<span class="w"> </span>orange
</code></pre></div>
<p>Export the running pod using below command and correct the spelling of the command <strong><code>sleeeep</code></strong> to <strong><code>sleep</code></strong> </p>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">kubectl edit pod orange</span><span class="w"> </span><span class="c1"># make changes and save</span>
<span class="l l-Scalar l-Scalar-Plain">k replace --force -f temp_file.yaml</span><span class="w"> </span>
</code></pre></div>
</details>
<hr />
<details class="info">
<summary>Expose the hr-web-app as service hr-web-app-service application on port 30082 on the nodes on the cluster.</summary>
<p>Apply below manifests:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hr-web-app-service</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NodePort</span>
<span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hr-web-app</span>
<span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">    </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">    </span><span class="nt">nodePort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30082</span>
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>Use JSON PATH query to retrieve the osImages of all the nodes and store it in a file /opt/outputs/nodes_os_x43kj56.txt.</summary>
<p>Run the below command to redirect the o/p:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>-o<span class="o">=</span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.items[0].status.nodeInfo.osImage}&#39;</span><span class="w">  </span>&gt;<span class="w"> </span>/opt/outputs/nodes_os_x43kj56.txt
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>Create a Persistent Volume with the given specification</summary>
<p>Volume name: pv-analytics</p>
<p>Storage: 100Mi</p>
<p>Access mode: ReadWriteMany</p>
<p>Host path: /pv/data-analytics</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PersistentVolume</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pv-analytics</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">    </span><span class="nt">capacity</span><span class="p">:</span>
<span class="w">    </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100Mi</span>
<span class="w">    </span><span class="nt">volumeMode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Filesystem</span>
<span class="w">    </span><span class="nt">accessModes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteMany</span>
<span class="w">    </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/pv/data-analytics</span>
</code></pre></div>
</details>
<details class="info">
<summary>Create a Pod called redis-storage with image: redis:alpine with a Volume of type emptyDir that lasts for the life of the Pod.</summary>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-storage</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-storage</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:alpine</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-storage</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">volumeMounts</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/redis</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cache-volume</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cache-volume</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">emptyDir</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="nt">sizeLimit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500Mi</span>
<span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterFirst</span>
<span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
</details>
<hr />
<details class="question">
<summary>Create a new pod called super-user-pod with image busybox:1.28. Allow the pod to be able to set system_time.</summary>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">super-user-pod</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">super-user-pod</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox:1.28</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">super-user-pod</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sleep</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;4800&quot;</span>
<span class="w">    </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">    </span><span class="nt">capabilities</span><span class="p">:</span>
<span class="w">        </span><span class="nt">add</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;SYS_TIME&quot;</span><span class="p p-Indicator">]</span>
<span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterFirst</span>
<span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
</details>
<hr />
<details class="note">
<summary>Create a new user called john. Grant him access to the cluster. John should have permission to create, list, get, update and delete pods in the development namespace . The private key exists in the location: /root/CKA/john.key and csr at /root/CKA/john.csr.</summary>
<p>Important Note: As of kubernetes 1.19, the CertificateSigningRequest object expects a signerName.</p>
<p>Please refer the documentation to see an example. The documentation tab is available at the top right of terminal.</p>
<div class="codehilite"><pre><span></span><code><span class="n">CSR</span><span class="o">:</span><span class="w"> </span><span class="n">john</span><span class="o">-</span><span class="n">developer</span><span class="w"> </span><span class="n">Status</span><span class="o">:</span><span class="n">Approved</span>

<span class="n">Role</span><span class="w"> </span><span class="n">Name</span><span class="o">:</span><span class="w"> </span><span class="n">developer</span><span class="o">,</span><span class="w"> </span><span class="kd">namespace</span><span class="o">:</span><span class="w"> </span><span class="n">development</span><span class="o">,</span><span class="w"> </span><span class="n">Resource</span><span class="o">:</span><span class="w"> </span><span class="n">Pods</span>

<span class="n">Access</span><span class="o">:</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="s1">&#39;john&#39;</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">appropriate</span><span class="w"> </span><span class="n">permissions</span>
</code></pre></div>

<p>Form the CSR request</p>
<p><div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">certificates.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CertificateSigningRequest</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myuser</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">request</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ1ZEQ0NBVHdDQVFBd0R6RU5NQXNHQTFVRUF3d0VhbTlvYmpDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRApnZ0VQQURDQ0FRb0NnZ0VCQUxqR2J3T1NDUFZycHB5QnhDL0ZDSURoTE90TXJyN21nWUlDbFYvcDlkaHZjSXdqCno0ZmpJdTlITDdrZlpTT2kxT21NSDNtTUlMaDRLa3J2bnFaeENXUGFrVEVDN005T1lsNHoyWXlWWDZ5R3p0WEYKYXZqSUcrVUJ5Zmo0V2M5c0l6cEdJS0dqN3JaQmVZamV3STlpUU5yQzc2RFJpcStKZU1oRFhIT2ZtSm9oU0J3YgpsQm9rSEp5aVNITzM1OGx6WEs1UElZaTVqKy9waUFhSHRKbjg3Vzl1K2tpNzJsc3IxN0JoV0FMTzQrOHFDOUgvCjMzZ2VQNUxhMXJTanVjYVk1eE9IL2s2dVdabGVVUUVyeVBqUDg0TW1sUnhrZEVHdTJ6dmY5c2pmZUFWNE1QTkoKYXYxcTMrc0ZNbHB2VndGb2RIbFgzL2ZzK25abHFhYWp2eW5yc1hFQ0F3RUFBYUFBTUEwR0NTcUdTSWIzRFFFQgpDd1VBQTRJQkFRQWhrMVVrTklqSzhDZmx2QTB0bEpOWi83TlgvZUlMQzF6d2h1T0NpQm14R2dUaGZReDdqYWtICnNyMmdUSXlpU0RsdVdVKzVZeW1CeElhL0xHVmRackhpSlBLRzgyVlNmck9DUHgrME1Bbk5PNTZpWWNUZ2RXZ3IKanByaUJYbDdrVkV0UUZjVTVwSGt0aW92Nk5mb0htRzZqT2w5dzVNYzRNMDJGbUN1Yi9sSngrNThIQnI1ekZLQQp4bGRNaXZ5V05CTlY3S3p0a1FkWElsLzR0emllME11ekdxRkxZNWh6R3pDSnVwekd5bmZXc0hmd2JaeWVKTVlrCnlmWldTV0FRSHhEZk5HRWxvNXhja1FTOVBWU29NK0YyNFoveXA3ZEI1Mlc0bE1yYVRsa2VNTy9pU25hRU5tdGwKazhPTDNielhXYS82K0hkdnNremtGK2hpVHFoRW9XTEIKLS0tLS1FTkQgQ0VSVElGSUNBVEUgUkVRVUVTVC0tLS0tCg==</span><span class="w"> </span>
<span class="nt">signerName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/kube-apiserver-client</span>
<span class="nt">expirationSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">86400</span><span class="w">  </span><span class="c1"># one day</span>
<span class="nt">usages</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">client auth</span>
</code></pre></div>
Create it as shown below</p>
<div class="highlight"><pre><span></span><code><span class="c1"># create the CSR</span>
controlplane<span class="w"> </span>~/CKA<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>csr-john.yaml<span class="w"> </span>

certificatesigningrequest.certificates.k8s.io/john<span class="w"> </span>created
</code></pre></div>
<p>View and approve it</p>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~/CKA<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>get<span class="w"> </span>csr
NAME<span class="w">        </span>AGE<span class="w">     </span>SIGNERNAME<span class="w">                                    </span>REQUESTOR<span class="w">                  </span>REQUESTEDDURATION<span class="w">   </span>CONDITION
csr-q6l5t<span class="w">   </span>45m<span class="w">     </span>kubernetes.io/kube-apiserver-client-kubelet<span class="w">   </span>system:bootstrap:rsxu7y<span class="w">    </span>&lt;none&gt;<span class="w">              </span>Approved,Issued
csr-tnnwr<span class="w">   </span>45m<span class="w">     </span>kubernetes.io/kube-apiserver-client-kubelet<span class="w">   </span>system:node:controlplane<span class="w">   </span>&lt;none&gt;<span class="w">              </span>Approved,Issued
john<span class="w">        </span>3m47s<span class="w">   </span>kubernetes.io/kube-apiserver-client<span class="w">           </span>kubernetes-admin<span class="w">           </span>24h<span class="w">                 </span>Pending

controlplane<span class="w"> </span>~/CKA<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>certificate<span class="w"> </span>approve<span class="w"> </span>john
certificatesigningrequest.certificates.k8s.io/john<span class="w"> </span>approved
</code></pre></div>
<p>Create the role</p>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~/CKA<span class="w"> </span>➜<span class="w">  </span>kubectl<span class="w"> </span>create<span class="w"> </span>role<span class="w"> </span>developer<span class="w">  </span>--verb<span class="o">=</span>get,list,create,update,delete<span class="w">  </span>--resource<span class="o">=</span>pods<span class="w"> </span>-n<span class="w"> </span>development
role.rbac.authorization.k8s.io/developer<span class="w"> </span>created
</code></pre></div>
<p>Create a role binding
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~/CKA<span class="w"> </span>➜<span class="w">  </span>kubectl<span class="w"> </span>create<span class="w"> </span>rolebinding<span class="w"> </span>developer-rb<span class="w"> </span>--role<span class="o">=</span>developer<span class="w"> </span>--user<span class="o">=</span>john<span class="w"> </span>-n<span class="w"> </span>development<span class="w"> </span>
rolebinding.rbac.authorization.k8s.io/developer-rb<span class="w"> </span>created
</code></pre></div></p>
<p>Check if it worked
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~/CKA<span class="w"> </span>✖<span class="w"> </span>k<span class="w"> </span>auth<span class="w"> </span>can-i<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>development<span class="w"> </span>--as<span class="w"> </span>john

yes
</code></pre></div></p>
</details>
<hr />
<details class="info">
<summary>Create a nginx pod called nginx-resolver using image nginx, expose it internally with a service called nginx-resolver-service. Test that you are able to look up the service and pod names from within the cluster. Use the image: busybox:1.28 for dns lookup. Record results in /root/CKA/nginx.svc and /root/CKA/nginx.pod </summary>
<p>Expose the pod after creating it
<div class="highlight"><pre><span></span><code>/CKA<span class="w"> </span>✖<span class="w"> </span>kubectl<span class="w"> </span>expose<span class="w"> </span>pod<span class="w"> </span>nginx-resolver<span class="w">  </span>--name<span class="o">=</span>nginx-resolver-service<span class="w"> </span>--port<span class="o">=</span><span class="m">8080</span>
service/nginx-resolver-service<span class="w"> </span>exposed
</code></pre></div></p>
<p>Create a test pod with sleep time
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~/CKA<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span>run<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--image<span class="o">=</span>busybox:1.28<span class="w"> </span>--<span class="w"> </span>sleep<span class="w"> </span><span class="m">5000</span>
pod/test<span class="w"> </span>created
</code></pre></div></p>
<p>run it to show the nslookup</p>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~/CKA<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>--<span class="w"> </span>nslookup<span class="w"> </span>nginx-resolver-service
Server:<span class="w">    </span><span class="m">10</span>.96.0.10
Address<span class="w"> </span><span class="m">1</span>:<span class="w"> </span><span class="m">10</span>.96.0.10<span class="w"> </span>kube-dns.kube-system.svc.cluster.local

Name:<span class="w">      </span>nginx-resolver-service
Address<span class="w"> </span><span class="m">1</span>:<span class="w"> </span><span class="m">10</span>.104.187.189<span class="w"> </span>nginx-resolver-service.default.svc.cluster.local
</code></pre></div>
<p>Get the pod records</p>
<div class="highlight"><pre><span></span><code>controlplane<span class="w"> </span>~/CKA<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>--<span class="w"> </span>nslookup<span class="w"> </span><span class="m">10</span>-244-192-4.default.pod.cluster.local
Server:<span class="w">    </span><span class="m">10</span>.96.0.10
Address<span class="w"> </span><span class="m">1</span>:<span class="w"> </span><span class="m">10</span>.96.0.10<span class="w"> </span>kube-dns.kube-system.svc.cluster.local

Name:<span class="w">      </span><span class="m">10</span>-244-192-4.default.pod.cluster.local
Address<span class="w"> </span><span class="m">1</span>:<span class="w"> </span><span class="m">10</span>.244.192.4<span class="w"> </span><span class="m">10</span>-244-192-4.nginx-resolver-service.default.svc.cluster.local

controlplane<span class="w"> </span>~/CKA<span class="w"> </span>➜<span class="w">  </span>k<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>--<span class="w"> </span>nslookup<span class="w"> </span><span class="m">10</span>-244-192-4.default.pod.cluster.local<span class="w"> </span>&gt;<span class="w"> </span>/root/CKA/nginx.pod
</code></pre></div>
</details>
<hr />
<details class="warning">
<summary>Create a static pod on node01 called nginx-critical with image nginx and make sure that it is recreated/restarted automatically in case of a failure.</summary>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">controlplane ~ ➜  cat static-pod.yaml</span><span class="w"> </span>
<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-critical</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-critical</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-critical</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterFirst</span>
<span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
</details>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../commands/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Commands" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Commands
            </div>
          </div>
        </a>
      
      
        
        <a href="../arch/docker/" class="md-footer__link md-footer__link--next" aria-label="Next: Docker 🐳" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Docker 🐳
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://instagram.com/amar_dhillon_studio" target="_blank" rel="noopener" title="instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.youtube.com/channel/UCbxj-orGrUOhihmOBJzE_Fg" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://medium.com/@smartsplash" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262zm288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/amarjitdhillon/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/_adhillon_" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "content.code.copy"], "search": "../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>