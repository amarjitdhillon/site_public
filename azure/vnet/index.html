
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A personal blog by Amarjit Singh Dhillon">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.2.7">
    
    
      
        <title>VNet 🕸 - Amar Dhillon's Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#virtual-network" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Amar Dhillon&#39;s Blog" class="md-header__button md-logo" aria-label="Amar Dhillon's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amar Dhillon's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              VNet 🕸
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../sys_design/concepts/consistentHashing/" class="md-tabs__link">
        System design
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../technical_stuff/linux/linuxCommands/" class="md-tabs__link">
        Linux
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../aws/concepts/" class="md-tabs__link">
        AWS
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../concepts/" class="md-tabs__link md-tabs__link--active">
        Azure
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../k8s/commands/" class="md-tabs__link">
        Kubernetes
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../technical_stuff/databricks/databricks_basics/" class="md-tabs__link">
        Technical Stuff
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../AI/intro_to_stat/" class="md-tabs__link">
        AI/ML
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        About me
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Amar Dhillon&#39;s Blog" class="md-nav__button md-logo" aria-label="Amar Dhillon's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Amar Dhillon's Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          System design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="System design" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          System design
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Concepts" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/consistentHashing/" class="md-nav__link">
        Consistent Hashing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/dataPartitioning/" class="md-nav__link">
        Data Partitioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/graphql/" class="md-nav__link">
        GraphQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/microservices/" class="md-nav__link">
        Micro Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/jwt/" class="md-nav__link">
        JWT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/websockets/" class="md-nav__link">
        Web Sockets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/webhook/" class="md-nav__link">
        WebHook
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/concepts/protobuf/" class="md-nav__link">
        Protobuf
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Design Patterns
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Design Patterns" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Design Patterns
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/bff/" class="md-nav__link">
        BFF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/cdn/" class="md-nav__link">
        CDN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/choreography/" class="md-nav__link">
        Choreography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/cqrs/" class="md-nav__link">
        CQRS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/materializedView/" class="md-nav__link">
        Materialized View
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/priority_queue/" class="md-nav__link">
        Priority Queue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/saga/" class="md-nav__link">
        Saga
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/serviceRegistry/" class="md-nav__link">
        Service Registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/durableFunctions/" class="md-nav__link">
        Durable functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sys_design/designPatterns/sidecar/" class="md-nav__link">
        Sidecar
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/linux/linuxCommands/" class="md-nav__link">
        Commands 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/grepContent/" class="md-nav__link">
        Grep content
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/updatePaths/" class="md-nav__link">
        Update Paths
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          AWS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="AWS" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          AWS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/concepts/" class="md-nav__link">
        Basic Concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Auth
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Auth" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Auth
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/api_gw/" class="md-nav__link">
        API Gateway 🌉
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Compute
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compute" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Compute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/athnea/" class="md-nav__link">
        Athnea
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/appsync/" class="md-nav__link">
        App Sync ♻️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/ec2/" class="md-nav__link">
        EC2 🖥
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/eks/" class="md-nav__link">
        EKS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/lambda/" class="md-nav__link">
        Lambda ⨐
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Infrastructure
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Infrastructure" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Infrastructure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/iam/" class="md-nav__link">
        IAM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_5">
          Caching
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Caching" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Caching
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/cloudfront/" class="md-nav__link">
        CloudFront 🌧
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/elasticache/" class="md-nav__link">
        Elasti Cache
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_6" type="checkbox" id="__nav_4_6" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_6">
          Database
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Database" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Database
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/dynamo/" class="md-nav__link">
        Dynamo DB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/rds/" class="md-nav__link">
        RDS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_7" type="checkbox" id="__nav_4_7" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_7">
          ETL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ETL" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_7">
          <span class="md-nav__icon md-icon"></span>
          ETL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/glue/" class="md-nav__link">
        Glue
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_8" type="checkbox" id="__nav_4_8" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_8">
          Storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Storage" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_8">
          <span class="md-nav__icon md-icon"></span>
          Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/glacier/" class="md-nav__link">
        Glacier 🗻
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/ebs/" class="md-nav__link">
        EBS ▣
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/efs/" class="md-nav__link">
        EFS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/s3/" class="md-nav__link">
        S3 🪣
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/snowball/" class="md-nav__link">
        Snow Ball ❄️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/storagegw/" class="md-nav__link">
        Storage Gateway ⻔
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9" type="checkbox" id="__nav_4_9" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_9">
          Network
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Network" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_9">
          <span class="md-nav__icon md-icon"></span>
          Network
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/subnet/" class="md-nav__link">
        101 Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/acl/" class="md-nav__link">
        ACL ⛔️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/elasticip/" class="md-nav__link">
        Elastic IP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/eni/" class="md-nav__link">
        ENI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/lb/" class="md-nav__link">
        Load Balancers ⚖️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/natgw/" class="md-nav__link">
        NAT GW
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/natinstance/" class="md-nav__link">
        NAT Instance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/route53/" class="md-nav__link">
        Route 53 🛣
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/sg/" class="md-nav__link">
        Security Group 🔐
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/vpc/" class="md-nav__link">
        VPC
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_10">
          Monitoring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Monitoring" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          Monitoring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/cloudwatch/" class="md-nav__link">
        Cloud Watch ⏱
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/cloudwatch/" class="md-nav__link">
        Cloud Trail
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_11">
          Misc Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Misc Services" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          Misc Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/macie/" class="md-nav__link">
        Macie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/orgs/" class="md-nav__link">
        Orgs 🏛
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_12">
          Supporting Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Supporting Services" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Supporting Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/autoScaling/" class="md-nav__link">
        Auto Scaling 📏
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/sqs/" class="md-nav__link">
        SQS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_13">
          NFRs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="NFRs" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          NFRs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/failover/" class="md-nav__link">
        Failover
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/readReplica/" class="md-nav__link">
        Read Replics
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          Azure
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Azure" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Azure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        Az Concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../az_commands/" class="md-nav__link">
        Az Commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_3">
          Compute
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compute" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Compute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../appservice/" class="md-nav__link">
        App Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../serviceFabric/" class="md-nav__link">
        Service Fabric
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../azvm/" class="md-nav__link">
        VM 🖥
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aci/" class="md-nav__link">
        ACI 🗳
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aks/" class="md-nav__link">
        AKS ⎈
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4" type="checkbox" id="__nav_5_4" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_4">
          ETL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ETL" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          ETL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../adf/" class="md-nav__link">
        Data Factory 🏭
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5" type="checkbox" id="__nav_5_5" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_5">
          Event based
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Event based" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_5">
          <span class="md-nav__icon md-icon"></span>
          Event based
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../event_hub/" class="md-nav__link">
        Event Hub ☄️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../event_grid/" class="md-nav__link">
        Event Grid ⛭
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../service_bus/" class="md-nav__link">
        Service Bus 🚌️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../grid-hub-bus/" class="md-nav__link">
        Service Bus vs Event Grid/Hub️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../azure_function/" class="md-nav__link">
        Function ⚡️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../logicApp/" class="md-nav__link">
        Logic App 🪄
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_6" type="checkbox" id="__nav_5_6" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_6">
          Misc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Misc" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_6">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../devopsatt.md" class="md-nav__link">
        Devops
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../az-monitor/" class="md-nav__link">
        Monitor 🔭
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../office365/" class="md-nav__link">
        Office 365 📝
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arm/" class="md-nav__link">
        ARM 🦾
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_7" type="checkbox" id="__nav_5_7" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_7">
          Load Balancer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Load Balancer" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_7">
          <span class="md-nav__icon md-icon"></span>
          Load Balancer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../app-gw/" class="md-nav__link">
        App Gateway (L7)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../azlb/" class="md-nav__link">
        Load Balancer (L4) ⚖️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../front-door/" class="md-nav__link">
        Front Door 🚪
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../atm/" class="md-nav__link">
        Traffic Manager 🚦
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_8" type="checkbox" id="__nav_5_8" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_8">
          Network
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Network" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_8">
          <span class="md-nav__icon md-icon"></span>
          Network
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_gateway/" class="md-nav__link">
        APIM Gateway ⾨
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dns/" class="md-nav__link">
        DNS ☎️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../networkingInfra/" class="md-nav__link">
        Networking Infrastructure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vpn_gw/" class="md-nav__link">
        VPN Gateway
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          VNet 🕸
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        VNet 🕸
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vnet-components" class="md-nav__link">
    VNet components
  </a>
  
    <nav class="md-nav" aria-label="VNet components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#address-space" class="md-nav__link">
    Address space
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subnets" class="md-nav__link">
    Subnets:
  </a>
  
    <nav class="md-nav" aria-label="Subnets:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#some-tips-for-vnets" class="md-nav__link">
    Some tips for VNets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-dmz-subnet-use-case" class="md-nav__link">
    A DMZ subnet use case
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regions" class="md-nav__link">
    Regions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscription" class="md-nav__link">
    Subscription
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vnet-peering" class="md-nav__link">
    VNET peering
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#express-route" class="md-nav__link">
    Express Route
  </a>
  
    <nav class="md-nav" aria-label="Express Route">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#circuits-and-peering" class="md-nav__link">
    Circuits and Peering
  </a>
  
    <nav class="md-nav" aria-label="Circuits and Peering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#circuit" class="md-nav__link">
    Circuit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#peering" class="md-nav__link">
    Peering
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
    <nav class="md-nav" aria-label="Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nic" class="md-nav__link">
    NIC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#public-ips" class="md-nav__link">
    Public IPs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-endpoint" class="md-nav__link">
    Private Endpoint
  </a>
  
    <nav class="md-nav" aria-label="Private Endpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#private-link-service" class="md-nav__link">
    Private Link Service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-endpoint" class="md-nav__link">
    Service Endpoint
  </a>
  
    <nav class="md-nav" aria-label="Service Endpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-endpoint-policies" class="md-nav__link">
    Service Endpoint Policies
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-vs-service-endpoints" class="md-nav__link">
    Private Vs Service Endpoints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-routing-types" class="md-nav__link">
    Network Routing types
  </a>
  
    <nav class="md-nav" aria-label="Network Routing types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-routes" class="md-nav__link">
    System routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-user-defined-routes-udr" class="md-nav__link">
    Custom/ User defined routes (UDR)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nsg-l3-and-l4" class="md-nav__link">
    NSG (L3 and L4)
  </a>
  
    <nav class="md-nav" aria-label="NSG (L3 and L4)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nsg-effective-rules" class="md-nav__link">
    NSG Effective rules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nva" class="md-nav__link">
    NVA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#azure-firewall-l7-and-l4" class="md-nav__link">
    Azure Firewall (L7 and L4)
  </a>
  
    <nav class="md-nav" aria-label="Azure Firewall (L7 and L4)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fqdn-tags" class="md-nav__link">
    FQDN Tags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-tags" class="md-nav__link">
    Service tags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewall-policyrules" class="md-nav__link">
    Firewall Policy/Rules
  </a>
  
    <nav class="md-nav" aria-label="Firewall Policy/Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nat-rules" class="md-nav__link">
    NAT rules
  </a>
  
    <nav class="md-nav" aria-label="NAT rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inbound-dnat" class="md-nav__link">
    Inbound DNAT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outbound-snat" class="md-nav__link">
    Outbound SNAT
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-rules" class="md-nav__link">
    Network rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-rules" class="md-nav__link">
    Application rules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asg" class="md-nav__link">
    ASG
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_9" type="checkbox" id="__nav_5_9" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_9">
          Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Security" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_9">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aad/" class="md-nav__link">
        Active Directory 🔐
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../keyVault/" class="md-nav__link">
        Key Vault 🔑
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../waf/" class="md-nav__link">
        WAF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../entra/" class="md-nav__link">
        Entra
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_10" type="checkbox" id="__nav_5_10" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_10">
          Storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Storage" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_10">
          <span class="md-nav__icon md-icon"></span>
          Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../storage/" class="md-nav__link">
        Storage Account 🗄
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../acr/" class="md-nav__link">
        Container Registry 📖
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../snowflake/" class="md-nav__link">
        Snowflake ❄️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../blob/" class="md-nav__link">
        Blob
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../adsl/" class="md-nav__link">
        ADLS-Gen2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6">
          Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kubernetes" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/commands/" class="md-nav__link">
        Commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/arch/docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Architecture
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Architecture" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Architecture
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/arch/apiserver/" class="md-nav__link">
        API Server 💻
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/arch/arch/" class="md-nav__link">
        Cluster Architecutre
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/arch/kubelet/" class="md-nav__link">
        Kubelet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/arch/kubeproxy/" class="md-nav__link">
        Kube Proxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/arch/scheduler/" class="md-nav__link">
        Scheduler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_4" type="checkbox" id="__nav_6_4" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_4">
          Admin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Admin" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          Admin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/admin/scheduler/" class="md-nav__link">
        Scheduler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/admin/monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/admin/security/" class="md-nav__link">
        Security
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_5" type="checkbox" id="__nav_6_5" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_5">
          Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Resources" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_5">
          <span class="md-nav__icon md-icon"></span>
          Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/arch/controllermgr/" class="md-nav__link">
        Controller Manager 👮‍♀️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/deployment_python/" class="md-nav__link">
        Deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/ds/" class="md-nav__link">
        DeamonSet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/arch/etcd/" class="md-nav__link">
        ETCD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/ingress/" class="md-nav__link">
        Ingress
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/rc/" class="md-nav__link">
        Replication Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/ns/" class="md-nav__link">
        Namespace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/node-affinity/" class="md-nav__link">
        Node Affinity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/pod/" class="md-nav__link">
        Pod
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/svc/" class="md-nav__link">
        Service
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_6" type="checkbox" id="__nav_6_6" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_6">
          Demo's
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Demo's" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_6">
          <span class="md-nav__icon md-icon"></span>
          Demo's
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../k8s/poc_minikube/" class="md-nav__link">
        Demo app in Minikube
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7">
          Technical Stuff
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Technical Stuff" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Technical Stuff
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Databricks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Databricks" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Databricks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/databricks/databricks_basics/" class="md-nav__link">
        Databricks 101 🧱
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/databricks/hive/" class="md-nav__link">
        Hive 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/databricks/ManipulatingTableswithDeltaLakeLab/" class="md-nav__link">
        Table Manipulation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2" type="checkbox" id="__nav_7_2" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_2">
          Data/Analytics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data/Analytics" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Data/Analytics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/sql_and_nosql/" class="md-nav__link">
        DB, DW and Data Lake 💾
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/snowflake/" class="md-nav__link">
        Snowflake ❄️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/powerbi/" class="md-nav__link">
        Power BI 📈
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" >
      
      
      
        
          
        
          
        
          
        
          
            
          
        
          
        
          
        
          
            
          
        
          
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../technical_stuff/maven/downgrade_maven/">Misc</a>
          
            <label for="__nav_7_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Misc" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/linux/android_device/" class="md-nav__link">
        Attach Android device 🤖
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/blogs/cpanel/gitAndCpanel/" class="md-nav__link">
        Cpanel settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/databricks/ManipulatingTableswithDeltaLakeLab/" class="md-nav__link">
        Delta Lake 🐟
      </a>
    </li>
  

            
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/installing_flink/flink/" class="md-nav__link">
        Flink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/wso2/h2/wso2/" class="md-nav__link">
        H2 Db in WSO2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/linux/java_home/" class="md-nav__link">
        Java home ☕️
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/mysql/JdbcStatements/" class="md-nav__link">
        JDBC Statements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/wso2/jms/" class="md-nav__link">
        JMS Queue in WSO2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/mysql/mysql_basics/" class="md-nav__link">
        Mysql 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../technical_stuff/wget/wget/" class="md-nav__link">
        Wget
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8">
          AI/ML
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="AI/ML" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          AI/ML
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/intro_to_stat/" class="md-nav__link">
        STAT 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/azureml/" class="md-nav__link">
        Azure ML
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9">
          About me
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About me" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          About me
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        About me
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vnet-components" class="md-nav__link">
    VNet components
  </a>
  
    <nav class="md-nav" aria-label="VNet components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#address-space" class="md-nav__link">
    Address space
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subnets" class="md-nav__link">
    Subnets:
  </a>
  
    <nav class="md-nav" aria-label="Subnets:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#some-tips-for-vnets" class="md-nav__link">
    Some tips for VNets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-dmz-subnet-use-case" class="md-nav__link">
    A DMZ subnet use case
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regions" class="md-nav__link">
    Regions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscription" class="md-nav__link">
    Subscription
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vnet-peering" class="md-nav__link">
    VNET peering
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#express-route" class="md-nav__link">
    Express Route
  </a>
  
    <nav class="md-nav" aria-label="Express Route">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#circuits-and-peering" class="md-nav__link">
    Circuits and Peering
  </a>
  
    <nav class="md-nav" aria-label="Circuits and Peering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#circuit" class="md-nav__link">
    Circuit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#peering" class="md-nav__link">
    Peering
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
    <nav class="md-nav" aria-label="Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nic" class="md-nav__link">
    NIC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#public-ips" class="md-nav__link">
    Public IPs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-endpoint" class="md-nav__link">
    Private Endpoint
  </a>
  
    <nav class="md-nav" aria-label="Private Endpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#private-link-service" class="md-nav__link">
    Private Link Service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-endpoint" class="md-nav__link">
    Service Endpoint
  </a>
  
    <nav class="md-nav" aria-label="Service Endpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-endpoint-policies" class="md-nav__link">
    Service Endpoint Policies
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-vs-service-endpoints" class="md-nav__link">
    Private Vs Service Endpoints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-routing-types" class="md-nav__link">
    Network Routing types
  </a>
  
    <nav class="md-nav" aria-label="Network Routing types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-routes" class="md-nav__link">
    System routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-user-defined-routes-udr" class="md-nav__link">
    Custom/ User defined routes (UDR)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nsg-l3-and-l4" class="md-nav__link">
    NSG (L3 and L4)
  </a>
  
    <nav class="md-nav" aria-label="NSG (L3 and L4)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nsg-effective-rules" class="md-nav__link">
    NSG Effective rules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nva" class="md-nav__link">
    NVA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#azure-firewall-l7-and-l4" class="md-nav__link">
    Azure Firewall (L7 and L4)
  </a>
  
    <nav class="md-nav" aria-label="Azure Firewall (L7 and L4)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fqdn-tags" class="md-nav__link">
    FQDN Tags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-tags" class="md-nav__link">
    Service tags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewall-policyrules" class="md-nav__link">
    Firewall Policy/Rules
  </a>
  
    <nav class="md-nav" aria-label="Firewall Policy/Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nat-rules" class="md-nav__link">
    NAT rules
  </a>
  
    <nav class="md-nav" aria-label="NAT rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inbound-dnat" class="md-nav__link">
    Inbound DNAT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outbound-snat" class="md-nav__link">
    Outbound SNAT
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-rules" class="md-nav__link">
    Network rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-rules" class="md-nav__link">
    Application rules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asg" class="md-nav__link">
    ASG
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="virtual-network">Virtual Network 🕸<a class="headerlink" href="#virtual-network" title="Permanent link">&para;</a></h1>
<ul>
<li>
<p>VNet enables many types of Azure resources, such as Azure Virtual Machines (VM), to securely communicate with each other.</p>
</li>
<li>
<p>Virtual networks and subnets span all availability zones in a region. You don't need to divide them by availability zones to accommodate zonal resources</p>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Default communication to Internet</p>
<p>All resources in a VNet can communicate outbound to the internet, by default. You can communicate inbound to a resource by assigning a public IP address or a public Load Balancer.</p>
</div>
<h2 id="vnet-components">VNet components<a class="headerlink" href="#vnet-components" title="Permanent link">&para;</a></h2>
<p><center> <img src="../images/vnet_basic.jpg" width="100%"> </center></p>
<h3 id="address-space">Address space<a class="headerlink" href="#address-space" title="Permanent link">&para;</a></h3>
<p>When creating a VNet, you must specify a <code>custom private IP address</code> space using public and private addresses. Azure assigns resources in a virtual network a private IP address from the address space that you assign. For example, if you deploy a VM in a VNet with address space, <code>10.0.0.0/16</code>, the VM will be assigned a private IP like <code>10.0.0.4</code>.</p>
<div class="admonition remember">
<p class="admonition-title">Address range</p>
<p>Largest is <code>x.x.x.x/8</code> and smallest is <code>x.x.x.x/29</code></p>
</div>
<h3 id="subnets">Subnets:<a class="headerlink" href="#subnets" title="Permanent link">&para;</a></h3>
<p>Subnets enable you to segment the virtual network into one or more subnetworks and allocate a portion of the virtual network’s address space to each subnet. Reserved IP addresses are <code>x.x.x.0-3</code> and <code>x.x.x.255</code>. </p>
<h4 id="some-tips-for-vnets">Some tips for VNets<a class="headerlink" href="#some-tips-for-vnets" title="Permanent link">&para;</a></h4>
<ul>
<li>Private IP addresses are supported using in-built <code>DHCP server</code>. </li>
<li>Vnet supportes <code>IPv4 and IPV6 public IPs</code></li>
<li>VNET Subnet: They are used as <code>Gateway subnets</code></li>
<li>We can have a <code>default subnet</code></li>
<li>Vnet has <code>Azure provided DNS</code>, we can also use the <code>custom DNS</code> too.</li>
<li>At the subnet level, you can configure <code>Network Security Groups (NSGs)</code> to secure your workloads</li>
</ul>
<h4 id="a-dmz-subnet-use-case">A DMZ subnet use case<a class="headerlink" href="#a-dmz-subnet-use-case" title="Permanent link">&para;</a></h4>
<p><mark>In this typical use case, our goal is to make sure that all traffic coming from the public subnet should be routed to the DMZ before it gets routed to the private subnet.</mark></p>
<p><center> <img src="../images/use-case-subnet.jpg" width="100%"> </center></p>
<p>The reason for this is that a public subnet contains workloads that are Internet facing, and a <code>private subnet</code> contains workloads that are not exposed to the Internet, such as <code>databases, application logic, backend servers, etc</code>. By default, the communication from the public subnet is allowed to the private subnet; however, we need to make sure that the traffic is filtered before it reaches the private subnet. This will help us to protect the private workloads, as all traffic is matched against the rules that you have set up in the <code>NVA (WAF in this case)</code>. If there is any attack or malicious traffic, <code>NVA</code> will take care of it. </p>
<p>Now, the question is, how can we implement this? As you can see in above diagram, we have used the routing table with User Defined Route (UDR) to accomplish this task. By default, the traffic from the public subnet to the private subnet is allowed, but using UDR, you are forcing the packets to go through the <code>DMZ subnet</code>.</p>
<h3 id="regions">Regions<a class="headerlink" href="#regions" title="Permanent link">&para;</a></h3>
<p><mark>VNet is scoped to a single region/location</mark>; however, multiple virtual networks from different regions can be connected together using peering.</p>
<div class="admonition warning">
<p class="admonition-title">Choose region with care</p>
<p>When you create a virtual network in Azure, you will get an option to choose the region. Depending on the region you choose, the virtual network will be deployed to the respective region, and the virtual machines deployed to the virtual network will also fall under the same region. </p>
</div>
<h3 id="subscription">Subscription<a class="headerlink" href="#subscription" title="Permanent link">&para;</a></h3>
<p>VNet is scoped to a subscription. You can implement multiple virtual networks within each Azure subscription and Azure region.</p>
<h2 id="vnet-peering">VNET peering<a class="headerlink" href="#vnet-peering" title="Permanent link">&para;</a></h2>
<p><code>Virtual network peering</code> enables you to seamlessly connect two or more <code>Virtual Networks</code> in Azure. The virtual networks appear as one for connectivity purposes. The traffic between virtual machines in peered virtual networks uses the Microsoft backbone infrastructure. <mark>Like traffic between virtual machines in the same network, traffic is routed through Microsoft's private network only.</mark></p>
<div class="admonition danger">
<p class="admonition-title">VNET non-reciprocal and non-trasitive connection</p>
<p>If we setup a connection between 2 VNets, that connection is non-reciprocal as shown in the diagram below. That is why we have to setup 2 connections in this case.
<center> <img src="../images/vnet-peering-non-reciprical.jpg" width="90%"> </center></p>
<p>The connction between different VNETS is non-trasitive as shown below.
<center> <img src="../images/vnet-peering-non-transitive.jpg" width="90%"> </center></p>
</div>
<p><code>Active-passive</code> and <code>active-active</code> peering are possible. Lets take an example of on-site and cloud peering with <code>active-passive</code> mode as shown below</p>
<p><center> <img src="../images/active-passive-tunnelling.jpg" width="90%"> </center></p>
<p>Azure supports the following types of peering:</p>
<ol>
<li><code>Virtual network peering</code>: Connecting virtual networks within the same Azure region.</li>
<li><code>Global virtual network peering</code>: Connecting virtual networks across Azure regions.</li>
</ol>
<h2 id="express-route">Express Route<a class="headerlink" href="#express-route" title="Permanent link">&para;</a></h2>
<p><code>ExpressRoute</code> lets you extend your on-premises networks into the Microsoft cloud over a private connection with the help of a connectivity provider. With <code>ExpressRoute</code>, you can establish connections to Microsoft cloud services, such as <code>Microsoft Azure</code> and <code>Microsoft 365</code>.</p>
<div class="admonition remember">
<p class="admonition-title">Remember</p>
<p><code>ExpressRoute</code> connections don't go over the public Internet. This allows <code>ExpressRoute</code> connections to offer more reliability, faster speeds</p>
</div>
<p>We have 2 options in Express routes</p>
<ol>
<li><strong>ExpressRoute Direct</strong>: It does not require connectivity provider (service provider), it directly connects to Microsoft Edge Routers</li>
</ol>
<div class="admonition question">
<p class="admonition-title">What is FastPath?</p>
<p>FastPath is an additional feature that can be used with <code>ExpressRoute</code> Direc. When enabled, FastPath sends network traffic directly to virtual machines in the virtual network, bypassing the gateway (<code>ExpressRoute</code> gateway is still needed though)</p>
</div>
<ol>
<li><strong>ExpresRoute Circuit</strong>: It uses a <code>service provider</code>.   </li>
</ol>
<p><center> <img src="../images/express-route.jpg" width="100%"> </center></p>
<div class="admonition example">
<p class="admonition-title">Points to remember</p>
<ul>
<li>
<p>Allocate two /30 subnets that are not used anywhere else in your network topology. One subnet will be used for the <code>primary connction</code>; the other will be used for the <code>secondary connction</code> as shown in the diagram above. From each of these subnets, you will assign the first usable IP address to your router because Microsoft uses the second usable IP for its router.</p>
</li>
<li>
<p>A valid <code>VLAN ID</code> is required to establish this peering on. Ensure that no other peering in the circuit uses the same VLAN ID. For both primary and secondary links you must use the same VLAN ID. This information is provided from your provider.</p>
</li>
</ul>
</div>
<h3 id="circuits-and-peering">Circuits and Peering<a class="headerlink" href="#circuits-and-peering" title="Permanent link">&para;</a></h3>
<h4 id="circuit">Circuit<a class="headerlink" href="#circuit" title="Permanent link">&para;</a></h4>
<ul>
<li><code>ExpressRoute</code> circuit is a logical connection between on-premises infrastructure and Microsoft cloud services through a connectivity provider</li>
<li><code>ExpressRoute</code> circuits do not map to any physical entities</li>
<li>A circuit is uniquely identified by a standard GUID called as a service key (s-key)</li>
<li>There is a 1:1 mapping between an <code>ExpressRoute</code> circuit and the s-key</li>
<li>The service key is the only piece of information exchanged between Microsoft, the connectivity provider, and you (s-key is not a secret for security purposes)</li>
<li>A circuit consists of 2 connections:<ul>
<li><code>Primary connection</code>: main</li>
<li><code>Secondary connection</code>: redundent for HA</li>
</ul>
</li>
</ul>
<h4 id="peering">Peering<a class="headerlink" href="#peering" title="Permanent link">&para;</a></h4>
<p>A peering is the interconnection between on-premise network and Microsoft cloud services (Azure, Microsoft 365). <code>ExpressRoute</code> circuits can include two independent peerings:
- <code>Private peering</code>: Azure VNet
- <code>Microsoft peering</code>: Microsoft 365, Dynamics 365 etc.</p>
<h2 id="basics">Basics<a class="headerlink" href="#basics" title="Permanent link">&para;</a></h2>
<h3 id="nic">NIC<a class="headerlink" href="#nic" title="Permanent link">&para;</a></h3>
<p><code>Virtual machines</code> have one or more <code>network interface cards (NICs)</code> that exist in the same region as the virtual network. You assign an IP address (either statically or dynamically) from a subnet in the virtual network. This action allows the virtual machine to communicate with other resources in the virtual network (and any peered network).</p>
<p><center> <img src="../images/nic.jpg" width="80%"> </center></p>
<h3 id="public-ips">Public IPs<a class="headerlink" href="#public-ips" title="Permanent link">&para;</a></h3>
<p>Public IP addresses are associated with a virtual machine NIC, public load balancer, VPN gateways, application gateways, and any other resource that can be accessed from the Internet. </p>
<p>Here also we can choose the allocation method to be <code>static or dynamic</code>. However, the availability of allocation methods depends on which SKU of public IP address we are using. <mark>The SKU is more like a pricing tier, where you will find different prices based on which SKU you are selecting</mark></p>
<ul>
<li><strong>Basic SKU</strong>: Static or Dynamic IP that is <code>accessible by default</code> and needs NSG to configure</li>
<li><strong>Standard SKU</strong>: Static PIP, that is <code>not accessible by defult</code> and needs NSG to allow traffic</li>
</ul>
<p><center> <img src="../images/ip_standard_basic.jpg" width="60%"> </center></p>
<h3 id="private-endpoint">Private Endpoint<a class="headerlink" href="#private-endpoint" title="Permanent link">&para;</a></h3>
<p>Before defining private endpoint, lets clear some basics terms:</p>
<div class="admonition info">
<p class="admonition-title"> Some basics: revised</p>
<ol>
<li><code>Azure Private Link</code> enables you to access Azure PaaS Services (for example, Azure Storage and SQL Database) and Azure hosted customer-owned/partner services over a Private Endpoint in your virtual network. Traffic between your virtual network and the service traverses over the Microsoft backbone network, eliminating exposure from the public Internet.</li>
<li><code>Azure Private Link service</code> is the reference to your own service that is powered by Azure Private Link.</li>
<li>A <code>private-link resource</code> is the destination target of a specified private endpoint.</li>
<li>A <code>private endpoint</code> is a <code>network interface</code> that uses a private IP address from your virtual network. This network interface connects you privately and securely to a service that's powered by Azure Private Link. By enabling a private endpoint, you're bringing the service into your virtual network. <mark>Private endpoint has NIC attached to it.</mark></li>
</ol>
<p><center> <img src="../images/priv-endpoint-config-general.jpg" width="100%"> </center></p>
</div>
<ul>
<li>The value of the <code>private IP address</code> remains unchanged for the entire lifecycle of the private endpoint.</li>
<li>The <code>private endpoint</code> must be deployed in the same region and subscription as the virtual network.</li>
<li>The <code>private-link resource</code> can be deployed in a different region than the one for the virtual network and private endpoint.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Private Endpoint Example</p>
<p>Imgine that there is a virtual network using the address range 10.10.0.0/16. Inside this virtual network are two subnets, SubnetA (<code>10.10.5.0/24</code>) and SubnetB (<code>10.10.6.0/24</code>).</p>
<p>One or more virtual machines reside in <code>SubnetA</code>. A storage account has a private endpoint with an IP address of <code>10.10.6.5</code> inside <code>SubnetB</code>. The virtual machines inside <code>SubnetA</code> access the storage account through the storage account’s private endpoint IP address located in <code>SubnetB</code>.</p>
<p>Resources in other networks can access the <code>storage account</code> through the private endpoint IP address.</p>
<p><center> <img src="../images/private_endpoint_diagram.webp" width="80%"> </center></p>
</div>
<p>Using private endpoints we can drill down to a sub-resource as shown below. This can't be done using <code>Service Endpoint</code> as it will allow access to the resource level instead of sub-resource level.
<center> <img src="../images/priv-endpoint-resource-drilldown.jpg" width="100%"> </center></p>
<div class="admonition question">
<p class="admonition-title">When to use Private endpoint?</p>
<p>Private endpoints enable connectivity between the customers from the same:</p>
<ul>
<li>Virtual network</li>
<li>Regionally peered virtual networks</li>
<li>Globally peered virtual networks</li>
<li>On-premises environments that use VPN or Express Route</li>
<li>Services that are powered by Private Link</li>
</ul>
</div>
<h4 id="private-link-service">Private Link Service<a class="headerlink" href="#private-link-service" title="Permanent link">&para;</a></h4>
<p>Azure <code>Private Link service</code> is the reference to your own service that is powered by <code>Azure Private Link</code>. Your service that is running behind Azure Standard Load Balancer can be enabled for Private Link access so that consumers to your service can access it privately from their own VNets. Your customers can create a <code>private endpoint</code> inside their virtual network and map it to this service. </p>
<p><center> <img src="../images/private-link-service-workflow.png" width="100%"> </center></p>
<h3 id="service-endpoint">Service Endpoint<a class="headerlink" href="#service-endpoint" title="Permanent link">&para;</a></h3>
<ul>
<li>Service endpoints direct VNet traffic <code>off the public Internet</code> and to the <code>Azure backbone network</code>. </li>
<li>They are enabled per subnet using policies.</li>
<li>This service does not provide private IPs to the services.</li>
<li>Service Endpoints enables private IP addresses in the their VNet to reach the endpoint of an Azure service without needing a public IP address on the their VNet. These VM's will connect to public IP of the service though.</li>
<li><code>Service endpoints</code> apply to all instances of the Azure resource, not just the ones you create. If you want to limit virtual network traffic to specific instances or regions of a resource, you need a service endpoint policy.</li>
</ul>
<div class="admonition success">
<p class="admonition-title">Example of service endpoint</p>
<p>Review the image below representing service endpoints in action. In this example, you have enabled a service endpoint for the <code>Microsoft.SQL service</code> on <code>SubnetA</code>. A virtual machine in <code>SubnetA</code> uses its private IP address to access a SQL server hosting several databases. The virtual machine connects using the public IP addresses associated with the <code>Microsoft.SQL service</code></p>
<p>Notice that Subnet B does not have service endpoints enabled for its subnet for the <code>Microsoft.SQL service</code>. Compute resources in this subnet use the public IP address for the virtual network to connect to the public IP address of the Azure service.</p>
<p><center> <img src="../images/service_endpoint_diagram.jpg" width="100%"> </center></p>
</div>
<h4 id="service-endpoint-policies">Service Endpoint Policies<a class="headerlink" href="#service-endpoint-policies" title="Permanent link">&para;</a></h4>
<p>Virtual Network (VNet) <code>service endpoint policies</code> allow you to filter egress virtual network traffic to Azure <code>Storage accounts</code> over <code>service endpoint</code>, and allow data exfiltration to only specific Azure Storage accounts. Endpoint policies provide granular access control for virtual network traffic to Azure Storage when connecting over service endpoint.</p>
<p><center> <img src="../images/service-endpoint-policy.jpg" width="95%"> </center></p>
<h3 id="private-vs-service-endpoints">Private Vs Service Endpoints<a class="headerlink" href="#private-vs-service-endpoints" title="Permanent link">&para;</a></h3>
<div class="admonition warning">
<p class="admonition-title">Public and Private IPs in service/private endpoints</p>
<p>With <code>service endpoints</code>, you're still connecting to the target resource's public endpoint. This effectively extends the identity of the VNet to the target resource. With <code>private endpoints</code>, you're assigning the target resource a private IP address from the VNet, essentially bringing it into the network. <mark>The target resource's public IP address doesn't go away, but you can lock it down so all traffic from the internet is denied.</mark></p>
</div>
<p>Here are some tips on when to use which endpint</p>
<div class="admonition note">
<p class="admonition-title">When to use which endpoint?</p>
<ol>
<li>If you want to be able to block all internet traffic to a target resource, use a private endpoint.</li>
<li>If you're dealing with traffic from on-premises, use a private endpoint.</li>
<li>If you want to secure a specific sub-resource to your VNet resources, use a private endpoint.</li>
<li>If you want to secure a <code>specific storage account</code> to your VNet resources, you can use a private endpoint, or a service endpoint with a <code>service endpoint policy</code>.</li>
<li>If you don't need a private IP address at the destination, service endpoints are considerably easier to create and maintain, and they don't require special DNS configuration.</li>
<li>if cost is a concern, <mark>note that service endpoints are free.</mark></li>
</ol>
</div>
<h3 id="network-routing-types">Network Routing types<a class="headerlink" href="#network-routing-types" title="Permanent link">&para;</a></h3>
<p><code>Network routes</code> or <code>route tables</code> have existed in traditional networks for an exceptionally long time. The routes that are part of the route table decide how to direct a packet to the destination.</p>
<h4 id="system-routes">System routes<a class="headerlink" href="#system-routes" title="Permanent link">&para;</a></h4>
<p>They are built in routes which <code>cannot be modified</code></p>
<div class="admonition success">
<p class="admonition-title">VM's default communicaiton to internet</p>
<p><mark>Whenever we create a VM in Azure, the VM will be able to communicate with the Internet without setting up any routes</mark>. In AWS, we need to create different gateways like NAT Gateway or Internet Gateway to facilitate the connection from a VM to the Internet. However, in Azure this is enabled by default with the help of <code>system routes</code></p>
</div>
<h4 id="custom-user-defined-routes-udr">Custom/ User defined routes (UDR)<a class="headerlink" href="#custom-user-defined-routes-udr" title="Permanent link">&para;</a></h4>
<p>User defined routes (UDR) or BGP routes which can <code>override the system routes</code>.</p>
<div class="highlight"><span class="filename">Precenence order of the routes</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="l l-Scalar l-Scalar-Plain">Custom routes &gt; BGP routes &gt; System routes</span><span class="w"></span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Block access to public internet</p>
<p>We can block access to public internet by adding a custom route from <code>0.0.0.0/0</code> to <code>None</code> as shown below</p>
<p><center> <img src="../images/user-route.jpg" width="60%"> </center></p>
</div>
<h3 id="nsg-l3-and-l4">NSG (L3 and L4)<a class="headerlink" href="#nsg-l3-and-l4" title="Permanent link">&para;</a></h3>
<div class="admonition tldr">
<p class="admonition-title">Tldr</p>
<p>They are used to control the flow of traffic inside the VNET and are similar to Firewalls</p>
</div>
<p>An NSG is a collection of security rules that can be used to allow or deny inbound or outbound traffic.</p>
<div class="admonition question">
<p class="admonition-title">Is NSG associted with subnet?</p>
<p>As shown in the diagram, NSG can be associated with a <code>subnet</code>, or a <code>NIC</code> based on your requirement. NSGs are reusable, which means you can have multiple NICs or subnet associations to a single NSG. </p>
<p>NSG as no effect unless its associated with either NIC or a Subnet.</p>
<p><center> <img src="../images/nsg-levels.jpg" width="90%"> </center></p>
</div>
<p>Priorities are used in NSG to evaluate; lower the number, higher the priority.</p>
<h4 id="nsg-effective-rules">NSG Effective rules<a class="headerlink" href="#nsg-effective-rules" title="Permanent link">&para;</a></h4>
<p><mark>When you apply NSG to both subnet and NIC, then effective rules come into the picture</mark>. If you are using NSGs at both the subnet and NIC level, the rules will be evaluated at both levels. </p>
<div class="admonition success">
<p class="admonition-title">Rules evaluation order</p>
<p><code>Inbound Traffic</code>: Each security rule will be evaluated independently when the NSG is applied to both the subnet and NIC levels. Incoming traffic will be first evaluated against the rules applied on the subnet level; if there is an allow rule, then the packet will be sent to the NIC. The rules set at the NIC level will be evaluated now, and only if there is an allow rule then the packet is allowed; otherwise, it will be dropped. In short, first at Subnet then NIC</p>
<p><code>Outbound Traffic</code>: all outgoing traffic will be first evaluated against the NIC rules; if there is an allow rule, then the traffic is evaluated at the subnet level. In short, first at NIC then Subnet</p>
</div>
<h3 id="nva">NVA<a class="headerlink" href="#nva" title="Permanent link">&para;</a></h3>
<p>Network Virtual Appliance  <code>NVA</code>s are VMs that can optimize our networks with routing and firewall capabilities.</p>
<h3 id="azure-firewall-l7-and-l4">Azure Firewall (L7 and L4)<a class="headerlink" href="#azure-firewall-l7-and-l4" title="Permanent link">&para;</a></h3>
<p>Using Azure Firewall, we can create, enforce, and manage <code>network policies</code> across virtual networks and subscriptions. Azure Firewall provides more features then NSG. Also, Azure firewall is different than WAF</p>
<p>Setting for Azure firewall is shown below</p>
<p><center> <img src="../images/azure-firewall-setting.jpg" width="95%"> </center></p>
<div class="admonition question">
<p class="admonition-title">Do we need WAF in addition to NSG?</p>
<p>Yes, we need both. The main difference is that <code>NSG</code> operates at layers 3 and 4 of the OSI layer; on the other hand, Azure Firewall works at layers 7 and 4.</p>
</div>
<p>It comes in 3 flavours</p>
<ul>
<li>Standard</li>
<li>Premium</li>
<li>Basic</li>
</ul>
<h4 id="fqdn-tags">FQDN Tags<a class="headerlink" href="#fqdn-tags" title="Permanent link">&para;</a></h4>
<p>We can use FQDN tag in the Azure firewall rules. An FQDN tag represents a group of fully qualified domain names (FQDNs) associated with well known Microsoft services. </p>
<h4 id="service-tags">Service tags<a class="headerlink" href="#service-tags" title="Permanent link">&para;</a></h4>
<p>A <code>service tag</code> represents a <code>group of IP address prefixes</code> to help minimize complexity for security rule creation. <mark>You can’t create your own service tag, nor specify which IP addresses are included within a tag.</mark> Microsoft manages the address prefixes encompassed by the service tag, and automatically updates the service tag as addresses change.</p>
<div class="admonition question">
<p class="admonition-title">How to use service tags?</p>
<p>You can use service tags to define network access controls on <code>network security groups</code>, <code>Azure Firewall</code>, and <code>user-defined routes</code>. Use <code>service tags</code> in place of specific IP addresses when you create security rules and routes. </p>
<p>By specifying the service tag name, such as <code>Storage</code>, in the appropriate source or destination field of a security rule, you can allow or deny the traffic for the corresponding service. 2 tags are used in the below diagram in the destination fields </p>
<p><center> <img src="../images/service-tag.jpg" width="90%"> </center></p>
</div>
<h4 id="firewall-policyrules">Firewall Policy/Rules<a class="headerlink" href="#firewall-policyrules" title="Permanent link">&para;</a></h4>
<p><center> <img src="../images/firewall-policy.jpg" width="80%"> </center></p>
<ul>
<li><code>Rule collection group</code>: It is used to group rule collections. They're the first unit to be processed by the Azure Firewall and they follow a priority order based on values</li>
<li><code>Rule collection</code>: it belongs to a rule collection group, and it contains one or multiple rules. They're the second unit processed by the firewall and they follow a priority order based on values. Rule collections must have a defined action (allow or deny) and a priority value</li>
</ul>
<p>Rules used in Firewall are of 3 types</p>
<ol>
<li>NAT </li>
<li>Network (L4)</li>
<li>Application (L7)</li>
</ol>
<div class="highlight"><span class="filename">Priority of Firewall rules</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nx">NAT</span><span class="w"> </span><span class="nx">rule</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">Network</span><span class="w"> </span><span class="nx">rule</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">Application</span><span class="w"> </span><span class="nx">rule</span><span class="w"></span>
</code></pre></div>
<h5 id="nat-rules">NAT rules<a class="headerlink" href="#nat-rules" title="Permanent link">&para;</a></h5>
<p>Using a NAT rule collection, you will be able to translate a public IP and port to a private IP and port</p>
<div class="admonition abstract">
<p class="admonition-title">NAT example using VM</p>
<p>Assume you have a <code>Ubuntu server</code> with private IP address, say, <code>10.0.0.2</code>, and the SSH server is available on port 22. Instead of exposing this port and IP to the Internet, you can create a NAT rule on the firewall. Using the public IP of the firewall and a random port, you can set up a NAT rule. Let’s assume that the public IP address of the firewall is <code>66.142.43.02</code>; using NAT rule you can redirect all traffic hitting port 5000 of the firewall to be translated to <code>10.0.0.2</code> and port 22. In short, translate <code>66.142.43.02:5000</code> to <code>10.0.0.2:22</code>. In this way, you can translate the public IP address and port to a private IP address and port.</p>
<p><center> <img src="../images/nat-translation.jpg" width="90%"> </center></p>
</div>
<h6 id="inbound-dnat">Inbound DNAT<a class="headerlink" href="#inbound-dnat" title="Permanent link">&para;</a></h6>
<p>Inbound Internet network traffic to your firewall public IP address is translated (<em>Destination Network Address Translation</em>) and filtered to the private IP addresses on your virtual networks.</p>
<h6 id="outbound-snat">Outbound SNAT<a class="headerlink" href="#outbound-snat" title="Permanent link">&para;</a></h6>
<p>All outbound virtual network traffic IP addresses are translated to the <code>Azure Firewall public IP</code> (<em>Source Network Address Translation</em>). You can identify and allow traffic originating from your virtual network to remote Internet destinations.</p>
<h5 id="network-rules">Network rules<a class="headerlink" href="#network-rules" title="Permanent link">&para;</a></h5>
<p>A network rule should be in place for any <code>non-HTTP/S</code> traffic to be allowed through the firewall. For a source to communicate with a destination deployed behind a firewall, you need to have a network rule configured from the source to the destination. If there is no rule that specifically calls out this incoming traffic, then it will be dropped.</p>
<div class="admonition tldr">
<p class="admonition-title">Tldr</p>
<p>You can use a network rule when you want to filter traffic based on IP addresses, any ports, and any protocols.</p>
</div>
<h5 id="application-rules">Application rules<a class="headerlink" href="#application-rules" title="Permanent link">&para;</a></h5>
<p>Application rules allow or deny outbound and east-west traffic based on the application layer (L7). You can use an application rule when you want to filter traffic based on fully qualified domain names (FQDNs), URLs, and HTTP/HTTPS protocols.</p>
<div class="admonition error">
<p>if you configure network rules and application rules, then network rules are applied in priority order before application rules. The rules are terminating. So, if a match is found in a network rule, no other rules are processed.</p>
</div>
<h3 id="asg">ASG<a class="headerlink" href="#asg" title="Permanent link">&para;</a></h3>
<p><code>Application security groups</code> enable you to configure network security as a natural extension of an application's structure, allowing you to group virtual machines and define network security policies based on those groups. You can reuse your security policy at scale without manual maintenance of explicit IP addresses. </p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../vpn_gw/" class="md-footer__link md-footer__link--prev" aria-label="Previous: VPN Gateway" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              VPN Gateway
            </div>
          </div>
        </a>
      
      
        
        <a href="../aad/" class="md-footer__link md-footer__link--next" aria-label="Next: Active Directory 🔐" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Active Directory 🔐
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://instagram.com/amar_dhillon_studio" target="_blank" rel="noopener" title="instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.youtube.com/channel/UCbxj-orGrUOhihmOBJzE_Fg" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://medium.com/@smartsplash" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262zm288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/amarjitdhillon/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/_adhillon_" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>